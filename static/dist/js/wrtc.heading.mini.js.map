{"version":3,"sources":["adapter.js","getUserMediaPolyfill.js","jquery.tmpl.min.js","getStats.min.js","helpers.js","codecsHandler.js","videoChat.js","webrtcRoom.js","webrtc.js"],"names":["f","exports","module","define","amd","window","global","self","this","adapter","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","1","adapterFactory","undefined","./adapter_factory.js","2","Object","defineProperty","value","_ref","arguments","options","shimChrome","shimFirefox","shimSafari","logging","utils","log","browserDetails","detectBrowser","commonShim","extractVersion","disableLog","disableWarnings","sdp","browser","chromeShim","shimPeerConnection","version","browserShim","shimAddIceCandidateNullOrEmpty","shimParameterlessSetLocalDescription","shimGetUserMedia","shimMediaStream","shimOnTrack","shimAddTrackRemoveTrack","shimGetSendersWithDtmf","shimGetStats","shimSenderReceiverGetStats","fixNegotiationNeeded","shimRTCIceCandidate","shimConnectionState","shimMaxMessageSize","shimSendThrowTypeError","removeExtmapAllowMixed","firefoxShim","shimRemoveStream","shimSenderGetStats","shimReceiverGetStats","shimRTCDataChannel","shimAddTransceiver","shimGetParameters","shimCreateOffer","shimCreateAnswer","safariShim","shimRTCIceServerUrls","shimCreateOfferLegacy","shimCallbacksAPI","shimLocalStreamsAPI","shimRemoteStreamsAPI","shimTrackEventTransceiver","shimAudioContext","_interopRequireWildcard","obj","__esModule","newObj","key","prototype","hasOwnProperty","default","./chrome/chrome_shim","./common_shim","./firefox/firefox_shim","./safari/safari_shim","./utils","3","shimGetDisplayMedia","_typeof","Symbol","iterator","constructor","_getusermedia","enumerable","get","_getdisplaymedia","MediaStream","webkitMediaStream","RTCPeerConnection","_ontrack","set","removeEventListener","addEventListener","configurable","origSetRemoteDescription","setRemoteDescription","_this","_ontrackpoly","stream","te","receiver","getReceivers","find","track","id","event","Event","transceiver","streams","dispatchEvent","getTracks","forEach","apply","wrapPeerConnectionEvent","shimSenderWithDtmf","pc","dtmf","_dtmf","kind","createDTMFSender","_pc","getSenders","_senders","slice","origAddTrack","addTrack","sender","push","origRemoveTrack","removeTrack","idx","indexOf","splice","origAddStream","addStream","_this2","origRemoveStream","removeStream","_this3","s","RTCRtpSender","origGetSenders","_this4","senders","origGetStats","getStats","_this5","_arguments","Array","selector","onSucc","onErr","fixChromeStats_","response","standardReport","result","report","standardStats","timestamp","type","localcandidate","remotecandidate","names","name","stat","makeMapStats","stats","Map","keys","map","successCallbackWrapper_","Promise","resolve","reject","then","RTCRtpReceiver","_this6","filterStats","origGetReceivers","_this7","receivers","srcElement","MediaStreamTrack","err","DOMException","shimAddTrackRemoveTrackWithNative","origGetLocalStreams","getLocalStreams","_this11","nativeStreams","_reverseStreams","_this12","_streams","newStream","replaceInternalStreamId","description","internalId","externalStream","internalStream","replace","RegExp","RTCSessionDescription","replaceExternalStreamId","_this13","signalingState","alreadyExists","oldStream","method","nativeMethod","methodObj","_defineProperty","_this14","args","isLegacyCall","desc","origSetLocalDescription","setLocalDescription","origLocalDescription","getOwnPropertyDescriptor","_this15","streamid","webkitRTCPeerConnection","RTCIceCandidate","target","getConfiguration","sdpSemantics","writable","_this8","_shimmedLocalStreams","streamId","_this9","existingSenders","newSenders","filter","newSender","concat","_this10","../utils.js","./getdisplaymedia","./getusermedia","4","getSourceId","navigator","mediaDevices","console","error","getDisplayMedia","constraints","sourceId","widthSpecified","video","width","heightSpecified","height","frameRateSpecified","frameRate","mandatory","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","getUserMedia","5","constraintsToChrome_","optional","cc","ideal","exact","min","max","oldname_","prefix","charAt","toUpperCase","oc","mix","advanced","shimConstraints_","func","JSON","parse","stringify","audio","remap","b","face","facingMode","getSupportedFacingModeLies","getSupportedConstraints","matches","enumerateDevices","devices","dev","d","some","match","label","toLowerCase","includes","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","message","constraint","constraintName","toString","onSuccess","onError","webkitGetUserMedia","bind","origGetUserMedia","cs","getAudioTracks","getVideoTracks","stop","6","NativeRTCIceCandidate","candidate","substr","nativeCandidate","parsedCandidate","_sdp2","parseCandidate","augmentedCandidate","assign","toJSON","sdpMid","sdpMLineIndex","usernameFragment","_sctp","sctpInDescription","sections","splitSections","shift","mediaSection","mLine","parseMLine","protocol","getRemoteFirefoxVersion","parseInt","getCanSendMaxMessageSize","remoteIsFirefox","canSendMaxMessageSize","getMaxMessageSize","maxMessageSize","matchPrefix","_getConfiguration","isFirefox","canSendMMS","remoteMMS","Number","POSITIVE_INFINITY","Math","sctp","wrapDcSend","dc","origDataChannelSend","send","data","size","byteLength","readyState","TypeError","origCreateDataChannel","createDataChannel","dataChannel","channel","proto","completed","checking","iceConnectionState","_onconnectionstatechange","cb","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","nativeSRD","split","line","trim","join","nativeAddIceCandidate","addIceCandidate","nativeSetLocalDescription","createOffer","createAnswer","_sdp","7","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","deprecated","DataChannel","RTCDataChannel","origAddTransceiver","addTransceiver","setParametersPromises","initParameters","shouldPerformCheck","sendEncodings","encodingParam","test","rid","parseFloat","scaleResolutionDownBy","RangeError","maxFramerate","params","getParameters","encodings","setParameters","catch","origGetParameters","origCreateOffer","_arguments2","all","finally","origCreateAnswer","_arguments3","../utils","8","preferredMediaSource","mediaSource","9","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","10","_localStreams","_addTrack","_len","_key","index","tracks","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","successCallback","failureCallback","promise","withCallback","_getUserMedia","shimConstraints","errcb","OrigPeerConnection","pcConfig","pcConstraints","iceServers","newIceServers","server","urls","url","generateCertificate","offerOptions","offerToReceiveAudio","audioTransceiver","getTransceivers","direction","setDirection","offerToReceiveVideo","videoTransceiver","AudioContext","webkitAudioContext","compactObject","11","eventNameToWrap","wrapper","nativeAddEventListener","nativeEventName","wrappedCallback","modifiedEvent","handleEvent","_eventMap","nativeRemoveEventListener","has","unwrappedCb","delete","bool","logDisabled_","deprecationWarnings_","oldMethod","newMethod","warn","mozGetUserMedia","userAgent","isSecureContext","RTCIceGatherer","supportsUnifiedPlan","RTCRtpTransceiver","isObject","reduce","accumulator","isObj","isEmptyObject","walkStats","outbound","streamStatsType","filteredResult","trackStats","trackIdentifier","trackStat","trackId","uastring","expr","pos","val","base","resultSet","endsWith","12","SDPUtils","generateIdentifier","random","localCName","splitLines","blob","part","getDescription","getMediaSections","parts","foundation","substring","component","priority","ip","address","port","relatedAddress","relatedPort","tcpType","ufrag","writeCandidate","parseIceOptions","parseRtpMap","parsed","payloadType","clockRate","channels","numChannels","writeRtpMap","codec","pt","preferredPayloadType","parseExtmap","uri","writeExtmap","headerExtension","preferredId","parseFmtp","kv","j","writeFmtp","parameters","param","parseRtcpFb","parameter","writeRtcpFb","lines","rtcpFeedback","fb","parseSsrcMedia","sp","ssrc","colon","attribute","parseSsrcGroup","semantics","ssrcs","getMid","mid","parseFingerprint","algorithm","getDtlsParameters","sessionpart","role","fingerprints","writeDtlsParameters","setupType","fp","parseCryptoLine","tag","cryptoSuite","keyParams","sessionParams","writeCryptoLine","writeCryptoKeyParams","parseCryptoKeyParams","keyMethod","keySalt","lifeTime","mkiValue","mkiLength","getCryptoParameters","getIceParameters","pwd","password","writeIceParameters","iceLite","parseRtpParameters","codecs","headerExtensions","fecMechanisms","rtcp","mline","rtpmapline","fmtps","writeRtpDescription","caps","maxptime","extension","parseRtpEncodingParameters","encodingParameters","hasRed","hasUlpfec","primarySsrc","secondarySsrc","flows","apt","encParam","codecPayloadType","rtx","fec","mechanism","bandwidth","maxBitrate","parseRtcpParameters","rtcpParameters","remoteSsrc","cname","rsize","reducedSize","compound","mux","writeRtcpParameters","parseMsid","spec","planB","msidParts","parseSctpDescription","maxSizeLine","isNaN","sctpPort","fmt","sctpMapLines","writeSctpDescription","media","output","generateSessionId","writeSessionBoilerplate","sessId","sessVer","sessUser","getDirection","getKind","isRejected","parseOLine","username","sessionId","sessionVersion","netType","addressType","isValidSDP","msGetUserMedia","fn","domManip","q","h","l","g","_wrap","tmpl","parent","nodes","calls","nest","w","wrap","x","html","v","update","extend","_ctnt","m","document","createElement","innerHTML","makeArray","childNodes","Function","_default","k","$1","$2","isArray","nodeType","getElementsByTagName","getAttribute","parentNode","removeAttribute","pop","_","item","template","wrapped","innerText","textContent","outerHTML","appendChild","cloneNode","insertBefore","remove","each","appendTo","prependTo","insertAfter","replaceAll","clone","pushStack","complete","tmplItem","afterManip","encode","open","close","if","else","=","!","jQuery","mediaStreamTrack","callback","interval","getStatsLooper","getStatsWrapper","results","getStatsParser","stack","peer","search","nomore","getStatsResult","datachannel","state","ended","speed","bytesSent","helper","audioBytesSent","videoBytesSent","setTimeout","InstallTrigger","isSafari","res","items","that","browserFakeUserAgent","documentElement","captureStream","mozCaptureStream","getContext","play","pause","drawImage","toDataURL","HTMLVideoElement","location","href","hash","screen","URL","createObjectURL","revokeObjectURL","systemNetworkType","connection","encryption","availableBandwidth","framerateMean","bitrateMean","recv","bytesReceived","latency","packetsLost","systemBandwidth","sentPerSecond","encodedPerSecond","videoBytestSent","connectionType","systemIpAddress","local","candidateType","transport","ipAddress","networkType","remote","resolutions","internal","candidates","checkIfOfferer","isOfferer","googInitiator","googCertificate","googFingerprintAlgorithm","fingerprintAlgorithm","checkAudioTracks","mediaType","sendrecvType","isRemote","googCodecName","kilobytes","prevBytesSent","bytes","toFixed","prevBytesReceived","googTrackId","googCurrentDelayMs","prevGoogCurrentDelayMs","prevPacketsLost","checkVideoTracks","googFrameHeightReceived","googFrameWidthReceived","googFrameHeightSent","googFrameWidthSent","prevFramerateMean","prevBitrateMean","bweforvideo","availableSendBandwidth","googAvailableSendBandwidth","googActualEncBitrate","googAvailableReceiveBandwidth","googRetransmitBitrate","googTargetEncBitrate","googBucketDelay","googTransmitBitrate","candidatePair","googActiveConnection","cid","googLocalAddress","googRemoteAddress","googTransportType","localCandidate","localCandidateId","remoteCandidate","remoteCandidateId","selected","nominated","mozLocalTransport","mozRemoteTransport","availableOutgoingBitrate","prevAvailableOutgoingBitrate","availableIncomingBitrate","prevAvailableIncomingBitrate","LOCAL_candidateType","LOCAL_transport","LOCAL_ipAddress","LOCAL_networkType","portNumber","REMOTE_candidateType","REMOTE_transport","REMOTE_ipAddress","REMOTE_networkType","dataSentReceived","remoteSource","frameWidth","frameHeight","SSRC","Helper","ace","getAvatarUrl","userId","pad","getPadId","Date","getTime","getUserFromId","anonymousUser","colorId","collabClient","getConnectedUsers","user","slugify","text","$bodyAceOuter","$","contents","wrtcStore","enable","userInRoom","currentOpenRoom","socketState","localstream","components","init","room","wrtc","rooms","wrtcPubsub","events","on","eventName","off","emit","inlineAvatar","ROOM","headerId","clientVars","webrtc","displayInlineAvatar","inlineAvatarLimit","$element","offsetTop","findAceHeaderElement","offset","top","avatarBox","append","$videoInlineAvatarIcons","userInList","userName","avatarURL","hide","show","VIDEO","_append","list","el","avatarUrl","$roomBox","$videoBox","attr","src","imageUrl","title","shadowRoot","querySelector","style","display","videoChat","userLeave","info","WRTC","attemptToReconnect","flow","status","requestUser","action","roomInfo","TEXT","USERS","headerCount","users","actions","btn","classList","add","setAttribute","newAction","headerTile","getHeaderRoomY","outerHeight","paddingTop","css","aceOuterPadding","ceil","$el","exist","left","outerWidth","paddingLeft","getHeaderRoomX","$inlineIcon","context","hElements","scrollDownToLastChatText","animate","scrollTop","scrollHeight","duration","queue","createShareLink","headerText","origin","pathname","appendUserList","empty","getUserId","stopStreaming","getValidUrl","newUrl","decodeURIComponent","CodecsHandler","preferCodec","codecName","videoCodecNumbers","vp8LineNumber","vp9LineNumber","h264LineNumber","preferCodecHelper","ignore","preferCodecNumber","newLine","videoCodecNumbersOriginal","newOrder","codecNumber","findLine","sdpLines","startLine","endLine","realEndLine","findLineInRange","getCodecPayloadType","sdpLine","pattern","removeVPX","disableNACK","prioritize","codecMimeType","mimeType","unshift","removeNonG722","setApplicationSpecificBandwidth","isScreen","setBAS","setVideoBitrates","xgoogle_min_bitrate","xgoogle_max_bitrate","videoCodec","vp8Index","vp8Payload","rtxIndex","rtxPayload","rtxFmtpLineIndex","appendrtxNext","_setVideoBitrates","setOpusAttributes","opusIndex","opusPayload","opusFmtpLineIndex","appendOpusNext","stereo","maxaveragebitrate","maxplaybackrate","cbr","useinbandfec","usedtx","_setOpusAttributes","preferVP9","forceStereoAudio","fmtpLineIndex","extractSdp","socket","padId","currentRoom","VIDEOCHATLIMIT","$joinBtn","networkInterval","pingos","startTime","LMin","LMax","avg","LineAvg","colors","normal","warning","danger","interavCheck","removeUserFromRoom","headerTitle","userCount","present","removeClass","deactivate","clearInterval","videoBtn","transform","opacity","data-active","removeListener","addUserToRoom","addClass","setInterval","now","activate","createSession","userInfo","$joinButton","participators","gateway_userJoin","_userData","gateway_userLeave","showUserMediaError","reachedVideoRoomSize","showAlert","isBulkUpdate","gritter","sticky","class_name","time","bulkUpdate","postAceInit","hookName","webSocket","docId","videoId","color","userJoin","reloadSession","reloadCurrentSession","deviceInputs","videoSettings","localStorage","getItem","microphone","speaker","camera","audioInputSection","audioOutputSection","videoSection","audioInputElement","audioOutputElement","videoElement","deviceInfo","option","WrtcRoom","tryToJoinByQueryString","scroll2Header","header","scrollIntoView","behavior","roomBtnHandler","preventDefault","handleObj","hasHref","joinChatRoom","leaveChatRoom","shareRoomsLink","ep_profile_list","staticImageURL","about","homepage","background-position","background-image","background-repeat","background-size","background-color","showUserProfileModal","joinByQueryString","urlParams","URLSearchParams","inComePadName","currentPadName","headId","link","$temp","select","execCommand","detail","activeEventListener","$AceOuter","data-action","data-id","trigger","userPresent","toggleClass","position","$box","videoChatLimit","adoptHeaderYRoom","$padOuter","$headerId","$headingEl","appendVideoIcon","createAgain","roomExist","$elRoomExist","children","aceInnerOffset","newY","newX","lineNumber","prevAll","headingTagId","positionTop","positionLeft","headTitle","box","syncVideoAvatars","reconnected","videoSizes","large","small","audioInputSelect","videoSelect","audioOutputSelect","DtlsSrtpKeyAgreement","sdpConstraints","OfferToReceiveAudio","OfferToReceiveVideo","remoteStream","enlargedVideos","Set","localVideoElement","sizes","_pad","audioVideoInputChange","changeAudioDestination","hangupAll","payload","to","receiveMessage","appendVideoModalToBody","$wrtcVideoModal","prepend","$parent","videoBox","innerHeight","toggle","removeAttr","active","userID","$this","isActive","$modal","$btnInfo","gState","hangup","handleClientMessage_RTC_MESSAGE","hook","reason","sendErrorStat","hostname","toggleMuted","audioTrack","enabled","toggleVideo","videoTrack","setStream","isLocal","videoContainer","max-height","border-color","loadedmetadata","addInterface","autoplay","muted","attachMediaStream","$video","$mute","click","$disableVideo","videoEnabled","videoEnlarged","$largeVideo","videoSize","hasClass","$networkLatency","statName","msg","sendMessage","socketIdTo","from","createPeerConnection","localStreams","offer","cleanupSdp","answer","logError","_headerId","[object Object]","notify","webrtcDetectedBrowser","prop","mergeConstraints","onicecandidate","oniceconnectionstatechange","ontrack","onremovestream","attachSinkId","element","sinkId","setSinkId","errorMessage","selectedIndex","audioDestination","audioSource","videoSource","audioOutput","mediaConstraints","newSettings","setItem","randomIntFromInterval","srcObject","mozSrcObject","minVideo","maxVideo","cons1","cons2","merged","floor"],"mappings":"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","file":"wrtc.heading.mini.js","sourcesContent":["(function(f){if(typeof exports===\"object\"&&typeof module!==\"undefined\"){module.exports=f()}else if(typeof define===\"function\"&&define.amd){define([],f)}else{var g;if(typeof window!==\"undefined\"){g=window}else if(typeof global!==\"undefined\"){g=global}else if(typeof self!==\"undefined\"){g=self}else{g=this}g.adapter = f()}})(function(){var define,module,exports;return (function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n  /* eslint-env node */\n\n  'use strict';\n\n  var _adapter_factory = require('./adapter_factory.js');\n\n  var adapter = (0, _adapter_factory.adapterFactory)({ window: typeof window === 'undefined' ? undefined : window });\n  module.exports = adapter; // this is the difference from adapter_core.\n\n  },{\"./adapter_factory.js\":2}],2:[function(require,module,exports){\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.adapterFactory = adapterFactory;\n\n  var _utils = require('./utils');\n\n  var utils = _interopRequireWildcard(_utils);\n\n  var _chrome_shim = require('./chrome/chrome_shim');\n\n  var chromeShim = _interopRequireWildcard(_chrome_shim);\n\n  var _firefox_shim = require('./firefox/firefox_shim');\n\n  var firefoxShim = _interopRequireWildcard(_firefox_shim);\n\n  var _safari_shim = require('./safari/safari_shim');\n\n  var safariShim = _interopRequireWildcard(_safari_shim);\n\n  var _common_shim = require('./common_shim');\n\n  var commonShim = _interopRequireWildcard(_common_shim);\n\n  var _sdp = require('sdp');\n\n  var sdp = _interopRequireWildcard(_sdp);\n\n  function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n  // Shimming starts here.\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n  function adapterFactory() {\n    var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n        window = _ref.window;\n\n    var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      shimChrome: true,\n      shimFirefox: true,\n      shimSafari: true\n    };\n\n    // Utils.\n    var logging = utils.log;\n    var browserDetails = utils.detectBrowser(window);\n\n    var adapter = {\n      browserDetails: browserDetails,\n      commonShim: commonShim,\n      extractVersion: utils.extractVersion,\n      disableLog: utils.disableLog,\n      disableWarnings: utils.disableWarnings,\n      // Expose sdp as a convenience. For production apps include directly.\n      sdp: sdp\n    };\n\n    // Shim browser if found.\n    switch (browserDetails.browser) {\n      case 'chrome':\n        if (!chromeShim || !chromeShim.shimPeerConnection || !options.shimChrome) {\n          logging('Chrome shim is not included in this adapter release.');\n          return adapter;\n        }\n        if (browserDetails.version === null) {\n          logging('Chrome shim can not determine version, not shimming.');\n          return adapter;\n        }\n        logging('adapter.js shimming chrome.');\n        // Export to the adapter global object visible in the browser.\n        adapter.browserShim = chromeShim;\n\n        // Must be called before shimPeerConnection.\n        commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n        commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n        chromeShim.shimGetUserMedia(window, browserDetails);\n        chromeShim.shimMediaStream(window, browserDetails);\n        chromeShim.shimPeerConnection(window, browserDetails);\n        chromeShim.shimOnTrack(window, browserDetails);\n        chromeShim.shimAddTrackRemoveTrack(window, browserDetails);\n        chromeShim.shimGetSendersWithDtmf(window, browserDetails);\n        chromeShim.shimGetStats(window, browserDetails);\n        chromeShim.shimSenderReceiverGetStats(window, browserDetails);\n        chromeShim.fixNegotiationNeeded(window, browserDetails);\n\n        commonShim.shimRTCIceCandidate(window, browserDetails);\n        commonShim.shimConnectionState(window, browserDetails);\n        commonShim.shimMaxMessageSize(window, browserDetails);\n        commonShim.shimSendThrowTypeError(window, browserDetails);\n        commonShim.removeExtmapAllowMixed(window, browserDetails);\n        break;\n      case 'firefox':\n        if (!firefoxShim || !firefoxShim.shimPeerConnection || !options.shimFirefox) {\n          logging('Firefox shim is not included in this adapter release.');\n          return adapter;\n        }\n        logging('adapter.js shimming firefox.');\n        // Export to the adapter global object visible in the browser.\n        adapter.browserShim = firefoxShim;\n\n        // Must be called before shimPeerConnection.\n        commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n        commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n        firefoxShim.shimGetUserMedia(window, browserDetails);\n        firefoxShim.shimPeerConnection(window, browserDetails);\n        firefoxShim.shimOnTrack(window, browserDetails);\n        firefoxShim.shimRemoveStream(window, browserDetails);\n        firefoxShim.shimSenderGetStats(window, browserDetails);\n        firefoxShim.shimReceiverGetStats(window, browserDetails);\n        firefoxShim.shimRTCDataChannel(window, browserDetails);\n        firefoxShim.shimAddTransceiver(window, browserDetails);\n        firefoxShim.shimGetParameters(window, browserDetails);\n        firefoxShim.shimCreateOffer(window, browserDetails);\n        firefoxShim.shimCreateAnswer(window, browserDetails);\n\n        commonShim.shimRTCIceCandidate(window, browserDetails);\n        commonShim.shimConnectionState(window, browserDetails);\n        commonShim.shimMaxMessageSize(window, browserDetails);\n        commonShim.shimSendThrowTypeError(window, browserDetails);\n        break;\n      case 'safari':\n        if (!safariShim || !options.shimSafari) {\n          logging('Safari shim is not included in this adapter release.');\n          return adapter;\n        }\n        logging('adapter.js shimming safari.');\n        // Export to the adapter global object visible in the browser.\n        adapter.browserShim = safariShim;\n\n        // Must be called before shimCallbackAPI.\n        commonShim.shimAddIceCandidateNullOrEmpty(window, browserDetails);\n        commonShim.shimParameterlessSetLocalDescription(window, browserDetails);\n\n        safariShim.shimRTCIceServerUrls(window, browserDetails);\n        safariShim.shimCreateOfferLegacy(window, browserDetails);\n        safariShim.shimCallbacksAPI(window, browserDetails);\n        safariShim.shimLocalStreamsAPI(window, browserDetails);\n        safariShim.shimRemoteStreamsAPI(window, browserDetails);\n        safariShim.shimTrackEventTransceiver(window, browserDetails);\n        safariShim.shimGetUserMedia(window, browserDetails);\n        safariShim.shimAudioContext(window, browserDetails);\n\n        commonShim.shimRTCIceCandidate(window, browserDetails);\n        commonShim.shimMaxMessageSize(window, browserDetails);\n        commonShim.shimSendThrowTypeError(window, browserDetails);\n        commonShim.removeExtmapAllowMixed(window, browserDetails);\n        break;\n      default:\n        logging('Unsupported browser!');\n        break;\n    }\n\n    return adapter;\n  }\n\n  // Browser shims.\n\n  },{\"./chrome/chrome_shim\":3,\"./common_shim\":6,\"./firefox/firefox_shim\":7,\"./safari/safari_shim\":10,\"./utils\":11,\"sdp\":12}],3:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n  /* eslint-env node */\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\n  var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n  var _getusermedia = require('./getusermedia');\n\n  Object.defineProperty(exports, 'shimGetUserMedia', {\n    enumerable: true,\n    get: function get() {\n      return _getusermedia.shimGetUserMedia;\n    }\n  });\n\n  var _getdisplaymedia = require('./getdisplaymedia');\n\n  Object.defineProperty(exports, 'shimGetDisplayMedia', {\n    enumerable: true,\n    get: function get() {\n      return _getdisplaymedia.shimGetDisplayMedia;\n    }\n  });\n  exports.shimMediaStream = shimMediaStream;\n  exports.shimOnTrack = shimOnTrack;\n  exports.shimGetSendersWithDtmf = shimGetSendersWithDtmf;\n  exports.shimGetStats = shimGetStats;\n  exports.shimSenderReceiverGetStats = shimSenderReceiverGetStats;\n  exports.shimAddTrackRemoveTrackWithNative = shimAddTrackRemoveTrackWithNative;\n  exports.shimAddTrackRemoveTrack = shimAddTrackRemoveTrack;\n  exports.shimPeerConnection = shimPeerConnection;\n  exports.fixNegotiationNeeded = fixNegotiationNeeded;\n\n  var _utils = require('../utils.js');\n\n  var utils = _interopRequireWildcard(_utils);\n\n  function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  function shimMediaStream(window) {\n    window.MediaStream = window.MediaStream || window.webkitMediaStream;\n  }\n\n  function shimOnTrack(window) {\n    if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && !('ontrack' in window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n        get: function get() {\n          return this._ontrack;\n        },\n        set: function set(f) {\n          if (this._ontrack) {\n            this.removeEventListener('track', this._ontrack);\n          }\n          this.addEventListener('track', this._ontrack = f);\n        },\n\n        enumerable: true,\n        configurable: true\n      });\n      var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n      window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\n        var _this = this;\n\n        if (!this._ontrackpoly) {\n          this._ontrackpoly = function (e) {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n            e.stream.addEventListener('addtrack', function (te) {\n              var receiver = void 0;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = _this.getReceivers().find(function (r) {\n                  return r.track && r.track.id === te.track.id;\n                });\n              } else {\n                receiver = { track: te.track };\n              }\n\n              var event = new Event('track');\n              event.track = te.track;\n              event.receiver = receiver;\n              event.transceiver = { receiver: receiver };\n              event.streams = [e.stream];\n              _this.dispatchEvent(event);\n            });\n            e.stream.getTracks().forEach(function (track) {\n              var receiver = void 0;\n              if (window.RTCPeerConnection.prototype.getReceivers) {\n                receiver = _this.getReceivers().find(function (r) {\n                  return r.track && r.track.id === track.id;\n                });\n              } else {\n                receiver = { track: track };\n              }\n              var event = new Event('track');\n              event.track = track;\n              event.receiver = receiver;\n              event.transceiver = { receiver: receiver };\n              event.streams = [e.stream];\n              _this.dispatchEvent(event);\n            });\n          };\n          this.addEventListener('addstream', this._ontrackpoly);\n        }\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n    } else {\n      // even if RTCRtpTransceiver is in window, it is only used and\n      // emitted in unified-plan. Unfortunately this means we need\n      // to unconditionally wrap the event.\n      utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n        if (!e.transceiver) {\n          Object.defineProperty(e, 'transceiver', { value: { receiver: e.receiver } });\n        }\n        return e;\n      });\n    }\n  }\n\n  function shimGetSendersWithDtmf(window) {\n    // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n    if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && !('getSenders' in window.RTCPeerConnection.prototype) && 'createDTMFSender' in window.RTCPeerConnection.prototype) {\n      var shimSenderWithDtmf = function shimSenderWithDtmf(pc, track) {\n        return {\n          track: track,\n          get dtmf() {\n            if (this._dtmf === undefined) {\n              if (track.kind === 'audio') {\n                this._dtmf = pc.createDTMFSender(track);\n              } else {\n                this._dtmf = null;\n              }\n            }\n            return this._dtmf;\n          },\n          _pc: pc\n        };\n      };\n\n      // augment addTrack when getSenders is not available.\n      if (!window.RTCPeerConnection.prototype.getSenders) {\n        window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n          this._senders = this._senders || [];\n          return this._senders.slice(); // return a copy of the internal state.\n        };\n        var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n        window.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\n          var sender = origAddTrack.apply(this, arguments);\n          if (!sender) {\n            sender = shimSenderWithDtmf(this, track);\n            this._senders.push(sender);\n          }\n          return sender;\n        };\n\n        var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n        window.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\n          origRemoveTrack.apply(this, arguments);\n          var idx = this._senders.indexOf(sender);\n          if (idx !== -1) {\n            this._senders.splice(idx, 1);\n          }\n        };\n      }\n      var origAddStream = window.RTCPeerConnection.prototype.addStream;\n      window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n        var _this2 = this;\n\n        this._senders = this._senders || [];\n        origAddStream.apply(this, [stream]);\n        stream.getTracks().forEach(function (track) {\n          _this2._senders.push(shimSenderWithDtmf(_this2, track));\n        });\n      };\n\n      var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n      window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n        var _this3 = this;\n\n        this._senders = this._senders || [];\n        origRemoveStream.apply(this, [stream]);\n\n        stream.getTracks().forEach(function (track) {\n          var sender = _this3._senders.find(function (s) {\n            return s.track === track;\n          });\n          if (sender) {\n            // remove sender\n            _this3._senders.splice(_this3._senders.indexOf(sender), 1);\n          }\n        });\n      };\n    } else if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && 'getSenders' in window.RTCPeerConnection.prototype && 'createDTMFSender' in window.RTCPeerConnection.prototype && window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n      var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        var _this4 = this;\n\n        var senders = origGetSenders.apply(this, []);\n        senders.forEach(function (sender) {\n          return sender._pc = _this4;\n        });\n        return senders;\n      };\n\n      Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n        get: function get() {\n          if (this._dtmf === undefined) {\n            if (this.track.kind === 'audio') {\n              this._dtmf = this._pc.createDTMFSender(this.track);\n            } else {\n              this._dtmf = null;\n            }\n          }\n          return this._dtmf;\n        }\n      });\n    }\n  }\n\n  function shimGetStats(window) {\n    if (!window.RTCPeerConnection) {\n      return;\n    }\n\n    var origGetStats = window.RTCPeerConnection.prototype.getStats;\n    window.RTCPeerConnection.prototype.getStats = function getStats() {\n      var _this5 = this;\n\n      var _arguments = Array.prototype.slice.call(arguments),\n          selector = _arguments[0],\n          onSucc = _arguments[1],\n          onErr = _arguments[2];\n\n      // If selector is a function then we are in the old style stats so just\n      // pass back the original getStats format to avoid breaking old users.\n\n\n      if (arguments.length > 0 && typeof selector === 'function') {\n        return origGetStats.apply(this, arguments);\n      }\n\n      // When spec-style getStats is supported, return those when called with\n      // either no arguments or the selector argument is null.\n      if (origGetStats.length === 0 && (arguments.length === 0 || typeof selector !== 'function')) {\n        return origGetStats.apply(this, []);\n      }\n\n      var fixChromeStats_ = function fixChromeStats_(response) {\n        var standardReport = {};\n        var reports = response.result();\n        reports.forEach(function (report) {\n          var standardStats = {\n            id: report.id,\n            timestamp: report.timestamp,\n            type: {\n              localcandidate: 'local-candidate',\n              remotecandidate: 'remote-candidate'\n            }[report.type] || report.type\n          };\n          report.names().forEach(function (name) {\n            standardStats[name] = report.stat(name);\n          });\n          standardReport[standardStats.id] = standardStats;\n        });\n\n        return standardReport;\n      };\n\n      // shim getStats with maplike support\n      var makeMapStats = function makeMapStats(stats) {\n        return new Map(Object.keys(stats).map(function (key) {\n          return [key, stats[key]];\n        }));\n      };\n\n      if (arguments.length >= 2) {\n        var successCallbackWrapper_ = function successCallbackWrapper_(response) {\n          onSucc(makeMapStats(fixChromeStats_(response)));\n        };\n\n        return origGetStats.apply(this, [successCallbackWrapper_, selector]);\n      }\n\n      // promise-support\n      return new Promise(function (resolve, reject) {\n        origGetStats.apply(_this5, [function (response) {\n          resolve(makeMapStats(fixChromeStats_(response)));\n        }, reject]);\n      }).then(onSucc, onErr);\n    };\n  }\n\n  function shimSenderReceiverGetStats(window) {\n    if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender && window.RTCRtpReceiver)) {\n      return;\n    }\n\n    // shim sender stats.\n    if (!('getStats' in window.RTCRtpSender.prototype)) {\n      var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n      if (origGetSenders) {\n        window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n          var _this6 = this;\n\n          var senders = origGetSenders.apply(this, []);\n          senders.forEach(function (sender) {\n            return sender._pc = _this6;\n          });\n          return senders;\n        };\n      }\n\n      var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      if (origAddTrack) {\n        window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n          var sender = origAddTrack.apply(this, arguments);\n          sender._pc = this;\n          return sender;\n        };\n      }\n      window.RTCRtpSender.prototype.getStats = function getStats() {\n        var sender = this;\n        return this._pc.getStats().then(function (result) {\n          return (\n            /* Note: this will include stats of all senders that\n             *   send a track with the same id as sender.track as\n             *   it is not possible to identify the RTCRtpSender.\n             */\n            utils.filterStats(result, sender.track, true)\n          );\n        });\n      };\n    }\n\n    // shim receiver stats.\n    if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n      var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n      if (origGetReceivers) {\n        window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n          var _this7 = this;\n\n          var receivers = origGetReceivers.apply(this, []);\n          receivers.forEach(function (receiver) {\n            return receiver._pc = _this7;\n          });\n          return receivers;\n        };\n      }\n      utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n        e.receiver._pc = e.srcElement;\n        return e;\n      });\n      window.RTCRtpReceiver.prototype.getStats = function getStats() {\n        var receiver = this;\n        return this._pc.getStats().then(function (result) {\n          return utils.filterStats(result, receiver.track, false);\n        });\n      };\n    }\n\n    if (!('getStats' in window.RTCRtpSender.prototype && 'getStats' in window.RTCRtpReceiver.prototype)) {\n      return;\n    }\n\n    // shim RTCPeerConnection.getStats(track).\n    var origGetStats = window.RTCPeerConnection.prototype.getStats;\n    window.RTCPeerConnection.prototype.getStats = function getStats() {\n      if (arguments.length > 0 && arguments[0] instanceof window.MediaStreamTrack) {\n        var track = arguments[0];\n        var sender = void 0;\n        var receiver = void 0;\n        var err = void 0;\n        this.getSenders().forEach(function (s) {\n          if (s.track === track) {\n            if (sender) {\n              err = true;\n            } else {\n              sender = s;\n            }\n          }\n        });\n        this.getReceivers().forEach(function (r) {\n          if (r.track === track) {\n            if (receiver) {\n              err = true;\n            } else {\n              receiver = r;\n            }\n          }\n          return r.track === track;\n        });\n        if (err || sender && receiver) {\n          return Promise.reject(new DOMException('There are more than one sender or receiver for the track.', 'InvalidAccessError'));\n        } else if (sender) {\n          return sender.getStats();\n        } else if (receiver) {\n          return receiver.getStats();\n        }\n        return Promise.reject(new DOMException('There is no sender or receiver for the track.', 'InvalidAccessError'));\n      }\n      return origGetStats.apply(this, arguments);\n    };\n  }\n\n  function shimAddTrackRemoveTrackWithNative(window) {\n    // shim addTrack/removeTrack with native variants in order to make\n    // the interactions with legacy getLocalStreams behave as in other browsers.\n    // Keeps a mapping stream.id => [stream, rtpsenders...]\n    window.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\n      var _this8 = this;\n\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      return Object.keys(this._shimmedLocalStreams).map(function (streamId) {\n        return _this8._shimmedLocalStreams[streamId][0];\n      });\n    };\n\n    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    window.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\n      if (!stream) {\n        return origAddTrack.apply(this, arguments);\n      }\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      var sender = origAddTrack.apply(this, arguments);\n      if (!this._shimmedLocalStreams[stream.id]) {\n        this._shimmedLocalStreams[stream.id] = [stream, sender];\n      } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n        this._shimmedLocalStreams[stream.id].push(sender);\n      }\n      return sender;\n    };\n\n    var origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      var _this9 = this;\n\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n      stream.getTracks().forEach(function (track) {\n        var alreadyExists = _this9.getSenders().find(function (s) {\n          return s.track === track;\n        });\n        if (alreadyExists) {\n          throw new DOMException('Track already exists.', 'InvalidAccessError');\n        }\n      });\n      var existingSenders = this.getSenders();\n      origAddStream.apply(this, arguments);\n      var newSenders = this.getSenders().filter(function (newSender) {\n        return existingSenders.indexOf(newSender) === -1;\n      });\n      this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n    };\n\n    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      delete this._shimmedLocalStreams[stream.id];\n      return origRemoveStream.apply(this, arguments);\n    };\n\n    var origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n    window.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\n      var _this10 = this;\n\n      this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n      if (sender) {\n        Object.keys(this._shimmedLocalStreams).forEach(function (streamId) {\n          var idx = _this10._shimmedLocalStreams[streamId].indexOf(sender);\n          if (idx !== -1) {\n            _this10._shimmedLocalStreams[streamId].splice(idx, 1);\n          }\n          if (_this10._shimmedLocalStreams[streamId].length === 1) {\n            delete _this10._shimmedLocalStreams[streamId];\n          }\n        });\n      }\n      return origRemoveTrack.apply(this, arguments);\n    };\n  }\n\n  function shimAddTrackRemoveTrack(window, browserDetails) {\n    if (!window.RTCPeerConnection) {\n      return;\n    }\n    // shim addTrack and removeTrack.\n    if (window.RTCPeerConnection.prototype.addTrack && browserDetails.version >= 65) {\n      return shimAddTrackRemoveTrackWithNative(window);\n    }\n\n    // also shim pc.getLocalStreams when addTrack is shimmed\n    // to return the original streams.\n    var origGetLocalStreams = window.RTCPeerConnection.prototype.getLocalStreams;\n    window.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\n      var _this11 = this;\n\n      var nativeStreams = origGetLocalStreams.apply(this);\n      this._reverseStreams = this._reverseStreams || {};\n      return nativeStreams.map(function (stream) {\n        return _this11._reverseStreams[stream.id];\n      });\n    };\n\n    var origAddStream = window.RTCPeerConnection.prototype.addStream;\n    window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n      var _this12 = this;\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      stream.getTracks().forEach(function (track) {\n        var alreadyExists = _this12.getSenders().find(function (s) {\n          return s.track === track;\n        });\n        if (alreadyExists) {\n          throw new DOMException('Track already exists.', 'InvalidAccessError');\n        }\n      });\n      // Add identity mapping for consistency with addTrack.\n      // Unless this is being used with a stream from addTrack.\n      if (!this._reverseStreams[stream.id]) {\n        var newStream = new window.MediaStream(stream.getTracks());\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        stream = newStream;\n      }\n      origAddStream.apply(this, [stream]);\n    };\n\n    var origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n    window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n\n      origRemoveStream.apply(this, [this._streams[stream.id] || stream]);\n      delete this._reverseStreams[this._streams[stream.id] ? this._streams[stream.id].id : stream.id];\n      delete this._streams[stream.id];\n    };\n\n    window.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\n      var _this13 = this;\n\n      if (this.signalingState === 'closed') {\n        throw new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\n      }\n      var streams = [].slice.call(arguments, 1);\n      if (streams.length !== 1 || !streams[0].getTracks().find(function (t) {\n        return t === track;\n      })) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n        throw new DOMException('The adapter.js addTrack polyfill only supports a single ' + ' stream which is associated with the specified track.', 'NotSupportedError');\n      }\n\n      var alreadyExists = this.getSenders().find(function (s) {\n        return s.track === track;\n      });\n      if (alreadyExists) {\n        throw new DOMException('Track already exists.', 'InvalidAccessError');\n      }\n\n      this._streams = this._streams || {};\n      this._reverseStreams = this._reverseStreams || {};\n      var oldStream = this._streams[stream.id];\n      if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n        oldStream.addTrack(track);\n\n        // Trigger ONN async.\n        Promise.resolve().then(function () {\n          _this13.dispatchEvent(new Event('negotiationneeded'));\n        });\n      } else {\n        var newStream = new window.MediaStream([track]);\n        this._streams[stream.id] = newStream;\n        this._reverseStreams[newStream.id] = stream;\n        this.addStream(newStream);\n      }\n      return this.getSenders().find(function (s) {\n        return s.track === track;\n      });\n    };\n\n    // replace the internal stream id with the external one and\n    // vice versa.\n    function replaceInternalStreamId(pc, description) {\n      var sdp = description.sdp;\n      Object.keys(pc._reverseStreams || []).forEach(function (internalId) {\n        var externalStream = pc._reverseStreams[internalId];\n        var internalStream = pc._streams[externalStream.id];\n        sdp = sdp.replace(new RegExp(internalStream.id, 'g'), externalStream.id);\n      });\n      return new RTCSessionDescription({\n        type: description.type,\n        sdp: sdp\n      });\n    }\n    function replaceExternalStreamId(pc, description) {\n      var sdp = description.sdp;\n      Object.keys(pc._reverseStreams || []).forEach(function (internalId) {\n        var externalStream = pc._reverseStreams[internalId];\n        var internalStream = pc._streams[externalStream.id];\n        sdp = sdp.replace(new RegExp(externalStream.id, 'g'), internalStream.id);\n      });\n      return new RTCSessionDescription({\n        type: description.type,\n        sdp: sdp\n      });\n    }\n    ['createOffer', 'createAnswer'].forEach(function (method) {\n      var nativeMethod = window.RTCPeerConnection.prototype[method];\n      var methodObj = _defineProperty({}, method, function () {\n        var _this14 = this;\n\n        var args = arguments;\n        var isLegacyCall = arguments.length && typeof arguments[0] === 'function';\n        if (isLegacyCall) {\n          return nativeMethod.apply(this, [function (description) {\n            var desc = replaceInternalStreamId(_this14, description);\n            args[0].apply(null, [desc]);\n          }, function (err) {\n            if (args[1]) {\n              args[1].apply(null, err);\n            }\n          }, arguments[2]]);\n        }\n        return nativeMethod.apply(this, arguments).then(function (description) {\n          return replaceInternalStreamId(_this14, description);\n        });\n      });\n      window.RTCPeerConnection.prototype[method] = methodObj[method];\n    });\n\n    var origSetLocalDescription = window.RTCPeerConnection.prototype.setLocalDescription;\n    window.RTCPeerConnection.prototype.setLocalDescription = function setLocalDescription() {\n      if (!arguments.length || !arguments[0].type) {\n        return origSetLocalDescription.apply(this, arguments);\n      }\n      arguments[0] = replaceExternalStreamId(this, arguments[0]);\n      return origSetLocalDescription.apply(this, arguments);\n    };\n\n    // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n    var origLocalDescription = Object.getOwnPropertyDescriptor(window.RTCPeerConnection.prototype, 'localDescription');\n    Object.defineProperty(window.RTCPeerConnection.prototype, 'localDescription', {\n      get: function get() {\n        var description = origLocalDescription.get.apply(this);\n        if (description.type === '') {\n          return description;\n        }\n        return replaceInternalStreamId(this, description);\n      }\n    });\n\n    window.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\n      var _this15 = this;\n\n      if (this.signalingState === 'closed') {\n        throw new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\n      }\n      // We can not yet check for sender instanceof RTCRtpSender\n      // since we shim RTPSender. So we check if sender._pc is set.\n      if (!sender._pc) {\n        throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' + 'does not implement interface RTCRtpSender.', 'TypeError');\n      }\n      var isLocal = sender._pc === this;\n      if (!isLocal) {\n        throw new DOMException('Sender was not created by this connection.', 'InvalidAccessError');\n      }\n\n      // Search for the native stream the senders track belongs to.\n      this._streams = this._streams || {};\n      var stream = void 0;\n      Object.keys(this._streams).forEach(function (streamid) {\n        var hasTrack = _this15._streams[streamid].getTracks().find(function (track) {\n          return sender.track === track;\n        });\n        if (hasTrack) {\n          stream = _this15._streams[streamid];\n        }\n      });\n\n      if (stream) {\n        if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n          this.removeStream(this._reverseStreams[stream.id]);\n        } else {\n          // relying on the same odd chrome behaviour as above.\n          stream.removeTrack(sender.track);\n        }\n        this.dispatchEvent(new Event('negotiationneeded'));\n      }\n    };\n  }\n\n  function shimPeerConnection(window, browserDetails) {\n    if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n      // very basic support for old versions.\n      window.RTCPeerConnection = window.webkitRTCPeerConnection;\n    }\n    if (!window.RTCPeerConnection) {\n      return;\n    }\n\n    // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n    if (browserDetails.version < 53) {\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\n        var nativeMethod = window.RTCPeerConnection.prototype[method];\n        var methodObj = _defineProperty({}, method, function () {\n          arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        });\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n    }\n  }\n\n  // Attempt to fix ONN in plan-b mode.\n  function fixNegotiationNeeded(window, browserDetails) {\n    utils.wrapPeerConnectionEvent(window, 'negotiationneeded', function (e) {\n      var pc = e.target;\n      if (browserDetails.version < 72 || pc.getConfiguration && pc.getConfiguration().sdpSemantics === 'plan-b') {\n        if (pc.signalingState !== 'stable') {\n          return;\n        }\n      }\n      return e;\n    });\n  }\n\n  },{\"../utils.js\":11,\"./getdisplaymedia\":4,\"./getusermedia\":5}],4:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n  /* eslint-env node */\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.shimGetDisplayMedia = shimGetDisplayMedia;\n  function shimGetDisplayMedia(window, getSourceId) {\n    if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n      return;\n    }\n    if (!window.navigator.mediaDevices) {\n      return;\n    }\n    // getSourceId is a function that returns a promise resolving with\n    // the sourceId of the screen/window/tab to be shared.\n    if (typeof getSourceId !== 'function') {\n      console.error('shimGetDisplayMedia: getSourceId argument is not ' + 'a function');\n      return;\n    }\n    window.navigator.mediaDevices.getDisplayMedia = function getDisplayMedia(constraints) {\n      return getSourceId(constraints).then(function (sourceId) {\n        var widthSpecified = constraints.video && constraints.video.width;\n        var heightSpecified = constraints.video && constraints.video.height;\n        var frameRateSpecified = constraints.video && constraints.video.frameRate;\n        constraints.video = {\n          mandatory: {\n            chromeMediaSource: 'desktop',\n            chromeMediaSourceId: sourceId,\n            maxFrameRate: frameRateSpecified || 3\n          }\n        };\n        if (widthSpecified) {\n          constraints.video.mandatory.maxWidth = widthSpecified;\n        }\n        if (heightSpecified) {\n          constraints.video.mandatory.maxHeight = heightSpecified;\n        }\n        return window.navigator.mediaDevices.getUserMedia(constraints);\n      });\n    };\n  }\n\n  },{}],5:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n  /* eslint-env node */\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n  exports.shimGetUserMedia = shimGetUserMedia;\n\n  var _utils = require('../utils.js');\n\n  var utils = _interopRequireWildcard(_utils);\n\n  function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n  var logging = utils.log;\n\n  function shimGetUserMedia(window, browserDetails) {\n    var navigator = window && window.navigator;\n\n    if (!navigator.mediaDevices) {\n      return;\n    }\n\n    var constraintsToChrome_ = function constraintsToChrome_(c) {\n      if ((typeof c === 'undefined' ? 'undefined' : _typeof(c)) !== 'object' || c.mandatory || c.optional) {\n        return c;\n      }\n      var cc = {};\n      Object.keys(c).forEach(function (key) {\n        if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n          return;\n        }\n        var r = _typeof(c[key]) === 'object' ? c[key] : { ideal: c[key] };\n        if (r.exact !== undefined && typeof r.exact === 'number') {\n          r.min = r.max = r.exact;\n        }\n        var oldname_ = function oldname_(prefix, name) {\n          if (prefix) {\n            return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n          }\n          return name === 'deviceId' ? 'sourceId' : name;\n        };\n        if (r.ideal !== undefined) {\n          cc.optional = cc.optional || [];\n          var oc = {};\n          if (typeof r.ideal === 'number') {\n            oc[oldname_('min', key)] = r.ideal;\n            cc.optional.push(oc);\n            oc = {};\n            oc[oldname_('max', key)] = r.ideal;\n            cc.optional.push(oc);\n          } else {\n            oc[oldname_('', key)] = r.ideal;\n            cc.optional.push(oc);\n          }\n        }\n        if (r.exact !== undefined && typeof r.exact !== 'number') {\n          cc.mandatory = cc.mandatory || {};\n          cc.mandatory[oldname_('', key)] = r.exact;\n        } else {\n          ['min', 'max'].forEach(function (mix) {\n            if (r[mix] !== undefined) {\n              cc.mandatory = cc.mandatory || {};\n              cc.mandatory[oldname_(mix, key)] = r[mix];\n            }\n          });\n        }\n      });\n      if (c.advanced) {\n        cc.optional = (cc.optional || []).concat(c.advanced);\n      }\n      return cc;\n    };\n\n    var shimConstraints_ = function shimConstraints_(constraints, func) {\n      if (browserDetails.version >= 61) {\n        return func(constraints);\n      }\n      constraints = JSON.parse(JSON.stringify(constraints));\n      if (constraints && _typeof(constraints.audio) === 'object') {\n        var remap = function remap(obj, a, b) {\n          if (a in obj && !(b in obj)) {\n            obj[b] = obj[a];\n            delete obj[a];\n          }\n        };\n        constraints = JSON.parse(JSON.stringify(constraints));\n        remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n        remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n        constraints.audio = constraintsToChrome_(constraints.audio);\n      }\n      if (constraints && _typeof(constraints.video) === 'object') {\n        // Shim facingMode for mobile & surface pro.\n        var face = constraints.video.facingMode;\n        face = face && ((typeof face === 'undefined' ? 'undefined' : _typeof(face)) === 'object' ? face : { ideal: face });\n        var getSupportedFacingModeLies = browserDetails.version < 66;\n\n        if (face && (face.exact === 'user' || face.exact === 'environment' || face.ideal === 'user' || face.ideal === 'environment') && !(navigator.mediaDevices.getSupportedConstraints && navigator.mediaDevices.getSupportedConstraints().facingMode && !getSupportedFacingModeLies)) {\n          delete constraints.video.facingMode;\n          var matches = void 0;\n          if (face.exact === 'environment' || face.ideal === 'environment') {\n            matches = ['back', 'rear'];\n          } else if (face.exact === 'user' || face.ideal === 'user') {\n            matches = ['front'];\n          }\n          if (matches) {\n            // Look for matches in label, or use last cam for back (typical).\n            return navigator.mediaDevices.enumerateDevices().then(function (devices) {\n              devices = devices.filter(function (d) {\n                return d.kind === 'videoinput';\n              });\n              var dev = devices.find(function (d) {\n                return matches.some(function (match) {\n                  return d.label.toLowerCase().includes(match);\n                });\n              });\n              if (!dev && devices.length && matches.includes('back')) {\n                dev = devices[devices.length - 1]; // more likely the back cam\n              }\n              if (dev) {\n                constraints.video.deviceId = face.exact ? { exact: dev.deviceId } : { ideal: dev.deviceId };\n              }\n              constraints.video = constraintsToChrome_(constraints.video);\n              logging('chrome: ' + JSON.stringify(constraints));\n              return func(constraints);\n            });\n          }\n        }\n        constraints.video = constraintsToChrome_(constraints.video);\n      }\n      logging('chrome: ' + JSON.stringify(constraints));\n      return func(constraints);\n    };\n\n    var shimError_ = function shimError_(e) {\n      if (browserDetails.version >= 64) {\n        return e;\n      }\n      return {\n        name: {\n          PermissionDeniedError: 'NotAllowedError',\n          PermissionDismissedError: 'NotAllowedError',\n          InvalidStateError: 'NotAllowedError',\n          DevicesNotFoundError: 'NotFoundError',\n          ConstraintNotSatisfiedError: 'OverconstrainedError',\n          TrackStartError: 'NotReadableError',\n          MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n          MediaDeviceKillSwitchOn: 'NotAllowedError',\n          TabCaptureError: 'AbortError',\n          ScreenCaptureError: 'AbortError',\n          DeviceCaptureError: 'AbortError'\n        }[e.name] || e.name,\n        message: e.message,\n        constraint: e.constraint || e.constraintName,\n        toString: function toString() {\n          return this.name + (this.message && ': ') + this.message;\n        }\n      };\n    };\n\n    var getUserMedia_ = function getUserMedia_(constraints, onSuccess, onError) {\n      shimConstraints_(constraints, function (c) {\n        navigator.webkitGetUserMedia(c, onSuccess, function (e) {\n          if (onError) {\n            onError(shimError_(e));\n          }\n        });\n      });\n    };\n    navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n    // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n    // function which returns a Promise, it does not accept spec-style\n    // constraints.\n    if (navigator.mediaDevices.getUserMedia) {\n      var origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n      navigator.mediaDevices.getUserMedia = function (cs) {\n        return shimConstraints_(cs, function (c) {\n          return origGetUserMedia(c).then(function (stream) {\n            if (c.audio && !stream.getAudioTracks().length || c.video && !stream.getVideoTracks().length) {\n              stream.getTracks().forEach(function (track) {\n                track.stop();\n              });\n              throw new DOMException('', 'NotFoundError');\n            }\n            return stream;\n          }, function (e) {\n            return Promise.reject(shimError_(e));\n          });\n        });\n      };\n    }\n  }\n\n  },{\"../utils.js\":11}],6:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n  /* eslint-env node */\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n  exports.shimRTCIceCandidate = shimRTCIceCandidate;\n  exports.shimMaxMessageSize = shimMaxMessageSize;\n  exports.shimSendThrowTypeError = shimSendThrowTypeError;\n  exports.shimConnectionState = shimConnectionState;\n  exports.removeExtmapAllowMixed = removeExtmapAllowMixed;\n  exports.shimAddIceCandidateNullOrEmpty = shimAddIceCandidateNullOrEmpty;\n  exports.shimParameterlessSetLocalDescription = shimParameterlessSetLocalDescription;\n\n  var _sdp = require('sdp');\n\n  var _sdp2 = _interopRequireDefault(_sdp);\n\n  var _utils = require('./utils');\n\n  var utils = _interopRequireWildcard(_utils);\n\n  function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n  function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n  function shimRTCIceCandidate(window) {\n    // foundation is arbitrarily chosen as an indicator for full support for\n    // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n    if (!window.RTCIceCandidate || window.RTCIceCandidate && 'foundation' in window.RTCIceCandidate.prototype) {\n      return;\n    }\n\n    var NativeRTCIceCandidate = window.RTCIceCandidate;\n    window.RTCIceCandidate = function RTCIceCandidate(args) {\n      // Remove the a= which shouldn't be part of the candidate string.\n      if ((typeof args === 'undefined' ? 'undefined' : _typeof(args)) === 'object' && args.candidate && args.candidate.indexOf('a=') === 0) {\n        args = JSON.parse(JSON.stringify(args));\n        args.candidate = args.candidate.substr(2);\n      }\n\n      if (args.candidate && args.candidate.length) {\n        // Augment the native candidate with the parsed fields.\n        var nativeCandidate = new NativeRTCIceCandidate(args);\n        var parsedCandidate = _sdp2.default.parseCandidate(args.candidate);\n        var augmentedCandidate = Object.assign(nativeCandidate, parsedCandidate);\n\n        // Add a serializer that does not serialize the extra attributes.\n        augmentedCandidate.toJSON = function toJSON() {\n          return {\n            candidate: augmentedCandidate.candidate,\n            sdpMid: augmentedCandidate.sdpMid,\n            sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n            usernameFragment: augmentedCandidate.usernameFragment\n          };\n        };\n        return augmentedCandidate;\n      }\n      return new NativeRTCIceCandidate(args);\n    };\n    window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n    // Hook up the augmented candidate in onicecandidate and\n    // addEventListener('icecandidate', ...)\n    utils.wrapPeerConnectionEvent(window, 'icecandidate', function (e) {\n      if (e.candidate) {\n        Object.defineProperty(e, 'candidate', {\n          value: new window.RTCIceCandidate(e.candidate),\n          writable: 'false'\n        });\n      }\n      return e;\n    });\n  }\n\n  function shimMaxMessageSize(window, browserDetails) {\n    if (!window.RTCPeerConnection) {\n      return;\n    }\n\n    if (!('sctp' in window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n        get: function get() {\n          return typeof this._sctp === 'undefined' ? null : this._sctp;\n        }\n      });\n    }\n\n    var sctpInDescription = function sctpInDescription(description) {\n      if (!description || !description.sdp) {\n        return false;\n      }\n      var sections = _sdp2.default.splitSections(description.sdp);\n      sections.shift();\n      return sections.some(function (mediaSection) {\n        var mLine = _sdp2.default.parseMLine(mediaSection);\n        return mLine && mLine.kind === 'application' && mLine.protocol.indexOf('SCTP') !== -1;\n      });\n    };\n\n    var getRemoteFirefoxVersion = function getRemoteFirefoxVersion(description) {\n      // TODO: Is there a better solution for detecting Firefox?\n      var match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n      if (match === null || match.length < 2) {\n        return -1;\n      }\n      var version = parseInt(match[1], 10);\n      // Test for NaN (yes, this is ugly)\n      return version !== version ? -1 : version;\n    };\n\n    var getCanSendMaxMessageSize = function getCanSendMaxMessageSize(remoteIsFirefox) {\n      // Every implementation we know can send at least 64 KiB.\n      // Note: Although Chrome is technically able to send up to 256 KiB, the\n      //       data does not reach the other peer reliably.\n      //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n      var canSendMaxMessageSize = 65536;\n      if (browserDetails.browser === 'firefox') {\n        if (browserDetails.version < 57) {\n          if (remoteIsFirefox === -1) {\n            // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n            // fragmentation.\n            canSendMaxMessageSize = 16384;\n          } else {\n            // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n            // messages. Thus, supporting ~2 GiB when sending.\n            canSendMaxMessageSize = 2147483637;\n          }\n        } else if (browserDetails.version < 60) {\n          // Currently, all FF >= 57 will reset the remote maximum message size\n          // to the default value when a data channel is created at a later\n          // stage. :(\n          // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n          canSendMaxMessageSize = browserDetails.version === 57 ? 65535 : 65536;\n        } else {\n          // FF >= 60 supports sending ~2 GiB\n          canSendMaxMessageSize = 2147483637;\n        }\n      }\n      return canSendMaxMessageSize;\n    };\n\n    var getMaxMessageSize = function getMaxMessageSize(description, remoteIsFirefox) {\n      // Note: 65536 bytes is the default value from the SDP spec. Also,\n      //       every implementation we know supports receiving 65536 bytes.\n      var maxMessageSize = 65536;\n\n      // FF 57 has a slightly incorrect default remote max message size, so\n      // we need to adjust it here to avoid a failure when sending.\n      // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n      if (browserDetails.browser === 'firefox' && browserDetails.version === 57) {\n        maxMessageSize = 65535;\n      }\n\n      var match = _sdp2.default.matchPrefix(description.sdp, 'a=max-message-size:');\n      if (match.length > 0) {\n        maxMessageSize = parseInt(match[0].substr(19), 10);\n      } else if (browserDetails.browser === 'firefox' && remoteIsFirefox !== -1) {\n        // If the maximum message size is not present in the remote SDP and\n        // both local and remote are Firefox, the remote peer can receive\n        // ~2 GiB.\n        maxMessageSize = 2147483637;\n      }\n      return maxMessageSize;\n    };\n\n    var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\n      this._sctp = null;\n      // Chrome decided to not expose .sctp in plan-b mode.\n      // As usual, adapter.js has to do an 'ugly worakaround'\n      // to cover up the mess.\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n        var _getConfiguration = this.getConfiguration(),\n            sdpSemantics = _getConfiguration.sdpSemantics;\n\n        if (sdpSemantics === 'plan-b') {\n          Object.defineProperty(this, 'sctp', {\n            get: function get() {\n              return typeof this._sctp === 'undefined' ? null : this._sctp;\n            },\n\n            enumerable: true,\n            configurable: true\n          });\n        }\n      }\n\n      if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n        var isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n        // Get the maximum message size the local peer is capable of sending\n        var canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n        // Get the maximum message size of the remote peer.\n        var remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n        // Determine final maximum message size\n        var maxMessageSize = void 0;\n        if (canSendMMS === 0 && remoteMMS === 0) {\n          maxMessageSize = Number.POSITIVE_INFINITY;\n        } else if (canSendMMS === 0 || remoteMMS === 0) {\n          maxMessageSize = Math.max(canSendMMS, remoteMMS);\n        } else {\n          maxMessageSize = Math.min(canSendMMS, remoteMMS);\n        }\n\n        // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n        // attribute.\n        var sctp = {};\n        Object.defineProperty(sctp, 'maxMessageSize', {\n          get: function get() {\n            return maxMessageSize;\n          }\n        });\n        this._sctp = sctp;\n      }\n\n      return origSetRemoteDescription.apply(this, arguments);\n    };\n  }\n\n  function shimSendThrowTypeError(window) {\n    if (!(window.RTCPeerConnection && 'createDataChannel' in window.RTCPeerConnection.prototype)) {\n      return;\n    }\n\n    // Note: Although Firefox >= 57 has a native implementation, the maximum\n    //       message size can be reset for all data channels at a later stage.\n    //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n    function wrapDcSend(dc, pc) {\n      var origDataChannelSend = dc.send;\n      dc.send = function send() {\n        var data = arguments[0];\n        var length = data.length || data.size || data.byteLength;\n        if (dc.readyState === 'open' && pc.sctp && length > pc.sctp.maxMessageSize) {\n          throw new TypeError('Message too large (can send a maximum of ' + pc.sctp.maxMessageSize + ' bytes)');\n        }\n        return origDataChannelSend.apply(dc, arguments);\n      };\n    }\n    var origCreateDataChannel = window.RTCPeerConnection.prototype.createDataChannel;\n    window.RTCPeerConnection.prototype.createDataChannel = function createDataChannel() {\n      var dataChannel = origCreateDataChannel.apply(this, arguments);\n      wrapDcSend(dataChannel, this);\n      return dataChannel;\n    };\n    utils.wrapPeerConnectionEvent(window, 'datachannel', function (e) {\n      wrapDcSend(e.channel, e.target);\n      return e;\n    });\n  }\n\n  /* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n   * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n   * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n   * since DTLS failures would be hidden. See\n   * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n   * for the Firefox tracking bug.\n   */\n  function shimConnectionState(window) {\n    if (!window.RTCPeerConnection || 'connectionState' in window.RTCPeerConnection.prototype) {\n      return;\n    }\n    var proto = window.RTCPeerConnection.prototype;\n    Object.defineProperty(proto, 'connectionState', {\n      get: function get() {\n        return {\n          completed: 'connected',\n          checking: 'connecting'\n        }[this.iceConnectionState] || this.iceConnectionState;\n      },\n\n      enumerable: true,\n      configurable: true\n    });\n    Object.defineProperty(proto, 'onconnectionstatechange', {\n      get: function get() {\n        return this._onconnectionstatechange || null;\n      },\n      set: function set(cb) {\n        if (this._onconnectionstatechange) {\n          this.removeEventListener('connectionstatechange', this._onconnectionstatechange);\n          delete this._onconnectionstatechange;\n        }\n        if (cb) {\n          this.addEventListener('connectionstatechange', this._onconnectionstatechange = cb);\n        }\n      },\n\n      enumerable: true,\n      configurable: true\n    });\n\n    ['setLocalDescription', 'setRemoteDescription'].forEach(function (method) {\n      var origMethod = proto[method];\n      proto[method] = function () {\n        if (!this._connectionstatechangepoly) {\n          this._connectionstatechangepoly = function (e) {\n            var pc = e.target;\n            if (pc._lastConnectionState !== pc.connectionState) {\n              pc._lastConnectionState = pc.connectionState;\n              var newEvent = new Event('connectionstatechange', e);\n              pc.dispatchEvent(newEvent);\n            }\n            return e;\n          };\n          this.addEventListener('iceconnectionstatechange', this._connectionstatechangepoly);\n        }\n        return origMethod.apply(this, arguments);\n      };\n    });\n  }\n\n  function removeExtmapAllowMixed(window, browserDetails) {\n    /* remove a=extmap-allow-mixed for webrtc.org < M71 */\n    if (!window.RTCPeerConnection) {\n      return;\n    }\n    if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n      return;\n    }\n    if (browserDetails.browser === 'safari' && browserDetails.version >= 605) {\n      return;\n    }\n    var nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n    window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription(desc) {\n      if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n        var sdp = desc.sdp.split('\\n').filter(function (line) {\n          return line.trim() !== 'a=extmap-allow-mixed';\n        }).join('\\n');\n        // Safari enforces read-only-ness of RTCSessionDescription fields.\n        if (window.RTCSessionDescription && desc instanceof window.RTCSessionDescription) {\n          arguments[0] = new window.RTCSessionDescription({\n            type: desc.type,\n            sdp: sdp\n          });\n        } else {\n          desc.sdp = sdp;\n        }\n      }\n      return nativeSRD.apply(this, arguments);\n    };\n  }\n\n  function shimAddIceCandidateNullOrEmpty(window, browserDetails) {\n    // Support for addIceCandidate(null or undefined)\n    // as well as addIceCandidate({candidate: \"\", ...})\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=978582\n    // Note: must be called before other polyfills which change the signature.\n    if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n      return;\n    }\n    var nativeAddIceCandidate = window.RTCPeerConnection.prototype.addIceCandidate;\n    if (!nativeAddIceCandidate || nativeAddIceCandidate.length === 0) {\n      return;\n    }\n    window.RTCPeerConnection.prototype.addIceCandidate = function addIceCandidate() {\n      if (!arguments[0]) {\n        if (arguments[1]) {\n          arguments[1].apply(null);\n        }\n        return Promise.resolve();\n      }\n      // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n      // in older versions.\n      // Native support for ignoring exists for Chrome M77+.\n      // Safari ignores as well, exact version unknown but works in the same\n      // version that also ignores addIceCandidate(null).\n      if ((browserDetails.browser === 'chrome' && browserDetails.version < 78 || browserDetails.browser === 'firefox' && browserDetails.version < 68 || browserDetails.browser === 'safari') && arguments[0] && arguments[0].candidate === '') {\n        return Promise.resolve();\n      }\n      return nativeAddIceCandidate.apply(this, arguments);\n    };\n  }\n\n  // Note: Make sure to call this ahead of APIs that modify\n  // setLocalDescription.length\n  function shimParameterlessSetLocalDescription(window, browserDetails) {\n    if (!(window.RTCPeerConnection && window.RTCPeerConnection.prototype)) {\n      return;\n    }\n    var nativeSetLocalDescription = window.RTCPeerConnection.prototype.setLocalDescription;\n    if (!nativeSetLocalDescription || nativeSetLocalDescription.length === 0) {\n      return;\n    }\n    window.RTCPeerConnection.prototype.setLocalDescription = function setLocalDescription() {\n      var _this = this;\n\n      var desc = arguments[0] || {};\n      if ((typeof desc === 'undefined' ? 'undefined' : _typeof(desc)) !== 'object' || desc.type && desc.sdp) {\n        return nativeSetLocalDescription.apply(this, arguments);\n      }\n      // The remaining steps should technically happen when SLD comes off the\n      // RTCPeerConnection's operations chain (not ahead of going on it), but\n      // this is too difficult to shim. Instead, this shim only covers the\n      // common case where the operations chain is empty. This is imperfect, but\n      // should cover many cases. Rationale: Even if we can't reduce the glare\n      // window to zero on imperfect implementations, there's value in tapping\n      // into the perfect negotiation pattern that several browsers support.\n      desc = { type: desc.type, sdp: desc.sdp };\n      if (!desc.type) {\n        switch (this.signalingState) {\n          case 'stable':\n          case 'have-local-offer':\n          case 'have-remote-pranswer':\n            desc.type = 'offer';\n            break;\n          default:\n            desc.type = 'answer';\n            break;\n        }\n      }\n      if (desc.sdp || desc.type !== 'offer' && desc.type !== 'answer') {\n        return nativeSetLocalDescription.apply(this, [desc]);\n      }\n      var func = desc.type === 'offer' ? this.createOffer : this.createAnswer;\n      return func.apply(this).then(function (d) {\n        return nativeSetLocalDescription.apply(_this, [d]);\n      });\n    };\n  }\n\n  },{\"./utils\":11,\"sdp\":12}],7:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n  /* eslint-env node */\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\n  var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n  var _getusermedia = require('./getusermedia');\n\n  Object.defineProperty(exports, 'shimGetUserMedia', {\n    enumerable: true,\n    get: function get() {\n      return _getusermedia.shimGetUserMedia;\n    }\n  });\n\n  var _getdisplaymedia = require('./getdisplaymedia');\n\n  Object.defineProperty(exports, 'shimGetDisplayMedia', {\n    enumerable: true,\n    get: function get() {\n      return _getdisplaymedia.shimGetDisplayMedia;\n    }\n  });\n  exports.shimOnTrack = shimOnTrack;\n  exports.shimPeerConnection = shimPeerConnection;\n  exports.shimSenderGetStats = shimSenderGetStats;\n  exports.shimReceiverGetStats = shimReceiverGetStats;\n  exports.shimRemoveStream = shimRemoveStream;\n  exports.shimRTCDataChannel = shimRTCDataChannel;\n  exports.shimAddTransceiver = shimAddTransceiver;\n  exports.shimGetParameters = shimGetParameters;\n  exports.shimCreateOffer = shimCreateOffer;\n  exports.shimCreateAnswer = shimCreateAnswer;\n\n  var _utils = require('../utils');\n\n  var utils = _interopRequireWildcard(_utils);\n\n  function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  function shimOnTrack(window) {\n    if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\n      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n        get: function get() {\n          return { receiver: this.receiver };\n        }\n      });\n    }\n  }\n\n  function shimPeerConnection(window, browserDetails) {\n    if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n      return; // probably media.peerconnection.enabled=false in about:config\n    }\n    if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n      // very basic support for old versions.\n      window.RTCPeerConnection = window.mozRTCPeerConnection;\n    }\n\n    if (browserDetails.version < 53) {\n      // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n      ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach(function (method) {\n        var nativeMethod = window.RTCPeerConnection.prototype[method];\n        var methodObj = _defineProperty({}, method, function () {\n          arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n          return nativeMethod.apply(this, arguments);\n        });\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n    }\n\n    var modernStatsTypes = {\n      inboundrtp: 'inbound-rtp',\n      outboundrtp: 'outbound-rtp',\n      candidatepair: 'candidate-pair',\n      localcandidate: 'local-candidate',\n      remotecandidate: 'remote-candidate'\n    };\n\n    var nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n    window.RTCPeerConnection.prototype.getStats = function getStats() {\n      var _arguments = Array.prototype.slice.call(arguments),\n          selector = _arguments[0],\n          onSucc = _arguments[1],\n          onErr = _arguments[2];\n\n      return nativeGetStats.apply(this, [selector || null]).then(function (stats) {\n        if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n          try {\n            stats.forEach(function (stat) {\n              stat.type = modernStatsTypes[stat.type] || stat.type;\n            });\n          } catch (e) {\n            if (e.name !== 'TypeError') {\n              throw e;\n            }\n            // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n            stats.forEach(function (stat, i) {\n              stats.set(i, Object.assign({}, stat, {\n                type: modernStatsTypes[stat.type] || stat.type\n              }));\n            });\n          }\n        }\n        return stats;\n      }).then(onSucc, onErr);\n    };\n  }\n\n  function shimSenderGetStats(window) {\n    if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n      return;\n    }\n    if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n      return;\n    }\n    var origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n    if (origGetSenders) {\n      window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n        var _this = this;\n\n        var senders = origGetSenders.apply(this, []);\n        senders.forEach(function (sender) {\n          return sender._pc = _this;\n        });\n        return senders;\n      };\n    }\n\n    var origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n    if (origAddTrack) {\n      window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n        var sender = origAddTrack.apply(this, arguments);\n        sender._pc = this;\n        return sender;\n      };\n    }\n    window.RTCRtpSender.prototype.getStats = function getStats() {\n      return this.track ? this._pc.getStats(this.track) : Promise.resolve(new Map());\n    };\n  }\n\n  function shimReceiverGetStats(window) {\n    if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n      return;\n    }\n    if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n      return;\n    }\n    var origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n    if (origGetReceivers) {\n      window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n        var _this2 = this;\n\n        var receivers = origGetReceivers.apply(this, []);\n        receivers.forEach(function (receiver) {\n          return receiver._pc = _this2;\n        });\n        return receivers;\n      };\n    }\n    utils.wrapPeerConnectionEvent(window, 'track', function (e) {\n      e.receiver._pc = e.srcElement;\n      return e;\n    });\n    window.RTCRtpReceiver.prototype.getStats = function getStats() {\n      return this._pc.getStats(this.track);\n    };\n  }\n\n  function shimRemoveStream(window) {\n    if (!window.RTCPeerConnection || 'removeStream' in window.RTCPeerConnection.prototype) {\n      return;\n    }\n    window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n      var _this3 = this;\n\n      utils.deprecated('removeStream', 'removeTrack');\n      this.getSenders().forEach(function (sender) {\n        if (sender.track && stream.getTracks().includes(sender.track)) {\n          _this3.removeTrack(sender);\n        }\n      });\n    };\n  }\n\n  function shimRTCDataChannel(window) {\n    // rename DataChannel to RTCDataChannel (native fix in FF60):\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n    if (window.DataChannel && !window.RTCDataChannel) {\n      window.RTCDataChannel = window.DataChannel;\n    }\n  }\n\n  function shimAddTransceiver(window) {\n    // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n    // Firefox ignores the init sendEncodings options passed to addTransceiver\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n    if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\n      return;\n    }\n    var origAddTransceiver = window.RTCPeerConnection.prototype.addTransceiver;\n    if (origAddTransceiver) {\n      window.RTCPeerConnection.prototype.addTransceiver = function addTransceiver() {\n        this.setParametersPromises = [];\n        var initParameters = arguments[1];\n        var shouldPerformCheck = initParameters && 'sendEncodings' in initParameters;\n        if (shouldPerformCheck) {\n          // If sendEncodings params are provided, validate grammar\n          initParameters.sendEncodings.forEach(function (encodingParam) {\n            if ('rid' in encodingParam) {\n              var ridRegex = /^[a-z0-9]{0,16}$/i;\n              if (!ridRegex.test(encodingParam.rid)) {\n                throw new TypeError('Invalid RID value provided.');\n              }\n            }\n            if ('scaleResolutionDownBy' in encodingParam) {\n              if (!(parseFloat(encodingParam.scaleResolutionDownBy) >= 1.0)) {\n                throw new RangeError('scale_resolution_down_by must be >= 1.0');\n              }\n            }\n            if ('maxFramerate' in encodingParam) {\n              if (!(parseFloat(encodingParam.maxFramerate) >= 0)) {\n                throw new RangeError('max_framerate must be >= 0.0');\n              }\n            }\n          });\n        }\n        var transceiver = origAddTransceiver.apply(this, arguments);\n        if (shouldPerformCheck) {\n          // Check if the init options were applied. If not we do this in an\n          // asynchronous way and save the promise reference in a global object.\n          // This is an ugly hack, but at the same time is way more robust than\n          // checking the sender parameters before and after the createOffer\n          // Also note that after the createoffer we are not 100% sure that\n          // the params were asynchronously applied so we might miss the\n          // opportunity to recreate offer.\n          var sender = transceiver.sender;\n\n          var params = sender.getParameters();\n          if (!('encodings' in params) ||\n          // Avoid being fooled by patched getParameters() below.\n          params.encodings.length === 1 && Object.keys(params.encodings[0]).length === 0) {\n            params.encodings = initParameters.sendEncodings;\n            sender.sendEncodings = initParameters.sendEncodings;\n            this.setParametersPromises.push(sender.setParameters(params).then(function () {\n              delete sender.sendEncodings;\n            }).catch(function () {\n              delete sender.sendEncodings;\n            }));\n          }\n        }\n        return transceiver;\n      };\n    }\n  }\n\n  function shimGetParameters(window) {\n    if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCRtpSender)) {\n      return;\n    }\n    var origGetParameters = window.RTCRtpSender.prototype.getParameters;\n    if (origGetParameters) {\n      window.RTCRtpSender.prototype.getParameters = function getParameters() {\n        var params = origGetParameters.apply(this, arguments);\n        if (!('encodings' in params)) {\n          params.encodings = [].concat(this.sendEncodings || [{}]);\n        }\n        return params;\n      };\n    }\n  }\n\n  function shimCreateOffer(window) {\n    // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n    // Firefox ignores the init sendEncodings options passed to addTransceiver\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n    if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\n      return;\n    }\n    var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n    window.RTCPeerConnection.prototype.createOffer = function createOffer() {\n      var _this4 = this,\n          _arguments2 = arguments;\n\n      if (this.setParametersPromises && this.setParametersPromises.length) {\n        return Promise.all(this.setParametersPromises).then(function () {\n          return origCreateOffer.apply(_this4, _arguments2);\n        }).finally(function () {\n          _this4.setParametersPromises = [];\n        });\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n  }\n\n  function shimCreateAnswer(window) {\n    // https://github.com/webrtcHacks/adapter/issues/998#issuecomment-516921647\n    // Firefox ignores the init sendEncodings options passed to addTransceiver\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1396918\n    if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection)) {\n      return;\n    }\n    var origCreateAnswer = window.RTCPeerConnection.prototype.createAnswer;\n    window.RTCPeerConnection.prototype.createAnswer = function createAnswer() {\n      var _this5 = this,\n          _arguments3 = arguments;\n\n      if (this.setParametersPromises && this.setParametersPromises.length) {\n        return Promise.all(this.setParametersPromises).then(function () {\n          return origCreateAnswer.apply(_this5, _arguments3);\n        }).finally(function () {\n          _this5.setParametersPromises = [];\n        });\n      }\n      return origCreateAnswer.apply(this, arguments);\n    };\n  }\n\n  },{\"../utils\":11,\"./getdisplaymedia\":8,\"./getusermedia\":9}],8:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n  /* eslint-env node */\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.shimGetDisplayMedia = shimGetDisplayMedia;\n  function shimGetDisplayMedia(window, preferredMediaSource) {\n    if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n      return;\n    }\n    if (!window.navigator.mediaDevices) {\n      return;\n    }\n    window.navigator.mediaDevices.getDisplayMedia = function getDisplayMedia(constraints) {\n      if (!(constraints && constraints.video)) {\n        var err = new DOMException('getDisplayMedia without video ' + 'constraints is undefined');\n        err.name = 'NotFoundError';\n        // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n        err.code = 8;\n        return Promise.reject(err);\n      }\n      if (constraints.video === true) {\n        constraints.video = { mediaSource: preferredMediaSource };\n      } else {\n        constraints.video.mediaSource = preferredMediaSource;\n      }\n      return window.navigator.mediaDevices.getUserMedia(constraints);\n    };\n  }\n\n  },{}],9:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n  /* eslint-env node */\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n  exports.shimGetUserMedia = shimGetUserMedia;\n\n  var _utils = require('../utils');\n\n  var utils = _interopRequireWildcard(_utils);\n\n  function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n  function shimGetUserMedia(window, browserDetails) {\n    var navigator = window && window.navigator;\n    var MediaStreamTrack = window && window.MediaStreamTrack;\n\n    navigator.getUserMedia = function (constraints, onSuccess, onError) {\n      // Replace Firefox 44+'s deprecation warning with unprefixed version.\n      utils.deprecated('navigator.getUserMedia', 'navigator.mediaDevices.getUserMedia');\n      navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n    };\n\n    if (!(browserDetails.version > 55 && 'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n      var remap = function remap(obj, a, b) {\n        if (a in obj && !(b in obj)) {\n          obj[b] = obj[a];\n          delete obj[a];\n        }\n      };\n\n      var nativeGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n      navigator.mediaDevices.getUserMedia = function (c) {\n        if ((typeof c === 'undefined' ? 'undefined' : _typeof(c)) === 'object' && _typeof(c.audio) === 'object') {\n          c = JSON.parse(JSON.stringify(c));\n          remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n          remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n        }\n        return nativeGetUserMedia(c);\n      };\n\n      if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n        var nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n        MediaStreamTrack.prototype.getSettings = function () {\n          var obj = nativeGetSettings.apply(this, arguments);\n          remap(obj, 'mozAutoGainControl', 'autoGainControl');\n          remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n          return obj;\n        };\n      }\n\n      if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n        var nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;\n        MediaStreamTrack.prototype.applyConstraints = function (c) {\n          if (this.kind === 'audio' && (typeof c === 'undefined' ? 'undefined' : _typeof(c)) === 'object') {\n            c = JSON.parse(JSON.stringify(c));\n            remap(c, 'autoGainControl', 'mozAutoGainControl');\n            remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n          }\n          return nativeApplyConstraints.apply(this, [c]);\n        };\n      }\n    }\n  }\n\n  },{\"../utils\":11}],10:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n  exports.shimLocalStreamsAPI = shimLocalStreamsAPI;\n  exports.shimRemoteStreamsAPI = shimRemoteStreamsAPI;\n  exports.shimCallbacksAPI = shimCallbacksAPI;\n  exports.shimGetUserMedia = shimGetUserMedia;\n  exports.shimConstraints = shimConstraints;\n  exports.shimRTCIceServerUrls = shimRTCIceServerUrls;\n  exports.shimTrackEventTransceiver = shimTrackEventTransceiver;\n  exports.shimCreateOfferLegacy = shimCreateOfferLegacy;\n  exports.shimAudioContext = shimAudioContext;\n\n  var _utils = require('../utils');\n\n  var utils = _interopRequireWildcard(_utils);\n\n  function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n  function shimLocalStreamsAPI(window) {\n    if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        return this._localStreams;\n      };\n    }\n    if (!('addStream' in window.RTCPeerConnection.prototype)) {\n      var _addTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n        var _this = this;\n\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        if (!this._localStreams.includes(stream)) {\n          this._localStreams.push(stream);\n        }\n        // Try to emulate Chrome's behaviour of adding in audio-video order.\n        // Safari orders by track id.\n        stream.getAudioTracks().forEach(function (track) {\n          return _addTrack.call(_this, track, stream);\n        });\n        stream.getVideoTracks().forEach(function (track) {\n          return _addTrack.call(_this, track, stream);\n        });\n      };\n\n      window.RTCPeerConnection.prototype.addTrack = function addTrack(track) {\n        var _this2 = this;\n\n        for (var _len = arguments.length, streams = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n          streams[_key - 1] = arguments[_key];\n        }\n\n        if (streams) {\n          streams.forEach(function (stream) {\n            if (!_this2._localStreams) {\n              _this2._localStreams = [stream];\n            } else if (!_this2._localStreams.includes(stream)) {\n              _this2._localStreams.push(stream);\n            }\n          });\n        }\n        return _addTrack.apply(this, arguments);\n      };\n    }\n    if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n        var _this3 = this;\n\n        if (!this._localStreams) {\n          this._localStreams = [];\n        }\n        var index = this._localStreams.indexOf(stream);\n        if (index === -1) {\n          return;\n        }\n        this._localStreams.splice(index, 1);\n        var tracks = stream.getTracks();\n        this.getSenders().forEach(function (sender) {\n          if (tracks.includes(sender.track)) {\n            _this3.removeTrack(sender);\n          }\n        });\n      };\n    }\n  }\n\n  function shimRemoteStreamsAPI(window) {\n    if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n      window.RTCPeerConnection.prototype.getRemoteStreams = function getRemoteStreams() {\n        return this._remoteStreams ? this._remoteStreams : [];\n      };\n    }\n    if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n        get: function get() {\n          return this._onaddstream;\n        },\n        set: function set(f) {\n          var _this4 = this;\n\n          if (this._onaddstream) {\n            this.removeEventListener('addstream', this._onaddstream);\n            this.removeEventListener('track', this._onaddstreampoly);\n          }\n          this.addEventListener('addstream', this._onaddstream = f);\n          this.addEventListener('track', this._onaddstreampoly = function (e) {\n            e.streams.forEach(function (stream) {\n              if (!_this4._remoteStreams) {\n                _this4._remoteStreams = [];\n              }\n              if (_this4._remoteStreams.includes(stream)) {\n                return;\n              }\n              _this4._remoteStreams.push(stream);\n              var event = new Event('addstream');\n              event.stream = stream;\n              _this4.dispatchEvent(event);\n            });\n          });\n        }\n      });\n      var origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n      window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\n        var pc = this;\n        if (!this._onaddstreampoly) {\n          this.addEventListener('track', this._onaddstreampoly = function (e) {\n            e.streams.forEach(function (stream) {\n              if (!pc._remoteStreams) {\n                pc._remoteStreams = [];\n              }\n              if (pc._remoteStreams.indexOf(stream) >= 0) {\n                return;\n              }\n              pc._remoteStreams.push(stream);\n              var event = new Event('addstream');\n              event.stream = stream;\n              pc.dispatchEvent(event);\n            });\n          });\n        }\n        return origSetRemoteDescription.apply(pc, arguments);\n      };\n    }\n  }\n\n  function shimCallbacksAPI(window) {\n    if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n      return;\n    }\n    var prototype = window.RTCPeerConnection.prototype;\n    var origCreateOffer = prototype.createOffer;\n    var origCreateAnswer = prototype.createAnswer;\n    var setLocalDescription = prototype.setLocalDescription;\n    var setRemoteDescription = prototype.setRemoteDescription;\n    var addIceCandidate = prototype.addIceCandidate;\n\n    prototype.createOffer = function createOffer(successCallback, failureCallback) {\n      var options = arguments.length >= 2 ? arguments[2] : arguments[0];\n      var promise = origCreateOffer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n    prototype.createAnswer = function createAnswer(successCallback, failureCallback) {\n      var options = arguments.length >= 2 ? arguments[2] : arguments[0];\n      var promise = origCreateAnswer.apply(this, [options]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n\n    var withCallback = function withCallback(description, successCallback, failureCallback) {\n      var promise = setLocalDescription.apply(this, [description]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.setLocalDescription = withCallback;\n\n    withCallback = function withCallback(description, successCallback, failureCallback) {\n      var promise = setRemoteDescription.apply(this, [description]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.setRemoteDescription = withCallback;\n\n    withCallback = function withCallback(candidate, successCallback, failureCallback) {\n      var promise = addIceCandidate.apply(this, [candidate]);\n      if (!failureCallback) {\n        return promise;\n      }\n      promise.then(successCallback, failureCallback);\n      return Promise.resolve();\n    };\n    prototype.addIceCandidate = withCallback;\n  }\n\n  function shimGetUserMedia(window) {\n    var navigator = window && window.navigator;\n\n    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      // shim not needed in Safari 12.1\n      var mediaDevices = navigator.mediaDevices;\n      var _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n      navigator.mediaDevices.getUserMedia = function (constraints) {\n        return _getUserMedia(shimConstraints(constraints));\n      };\n    }\n\n    if (!navigator.getUserMedia && navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n        navigator.mediaDevices.getUserMedia(constraints).then(cb, errcb);\n      }.bind(navigator);\n    }\n  }\n\n  function shimConstraints(constraints) {\n    if (constraints && constraints.video !== undefined) {\n      return Object.assign({}, constraints, { video: utils.compactObject(constraints.video) });\n    }\n\n    return constraints;\n  }\n\n  function shimRTCIceServerUrls(window) {\n    if (!window.RTCPeerConnection) {\n      return;\n    }\n    // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n    var OrigPeerConnection = window.RTCPeerConnection;\n    window.RTCPeerConnection = function RTCPeerConnection(pcConfig, pcConstraints) {\n      if (pcConfig && pcConfig.iceServers) {\n        var newIceServers = [];\n        for (var i = 0; i < pcConfig.iceServers.length; i++) {\n          var server = pcConfig.iceServers[i];\n          if (!server.hasOwnProperty('urls') && server.hasOwnProperty('url')) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n            server = JSON.parse(JSON.stringify(server));\n            server.urls = server.url;\n            delete server.url;\n            newIceServers.push(server);\n          } else {\n            newIceServers.push(pcConfig.iceServers[i]);\n          }\n        }\n        pcConfig.iceServers = newIceServers;\n      }\n      return new OrigPeerConnection(pcConfig, pcConstraints);\n    };\n    window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n    // wrap static methods. Currently just generateCertificate.\n    if ('generateCertificate' in OrigPeerConnection) {\n      Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n        get: function get() {\n          return OrigPeerConnection.generateCertificate;\n        }\n      });\n    }\n  }\n\n  function shimTrackEventTransceiver(window) {\n    // Add event.transceiver member over deprecated event.receiver\n    if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\n      Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n        get: function get() {\n          return { receiver: this.receiver };\n        }\n      });\n    }\n  }\n\n  function shimCreateOfferLegacy(window) {\n    var origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n    window.RTCPeerConnection.prototype.createOffer = function createOffer(offerOptions) {\n      if (offerOptions) {\n        if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveAudio = !!offerOptions.offerToReceiveAudio;\n        }\n        var audioTransceiver = this.getTransceivers().find(function (transceiver) {\n          return transceiver.receiver.track.kind === 'audio';\n        });\n        if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n          if (audioTransceiver.direction === 'sendrecv') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('sendonly');\n            } else {\n              audioTransceiver.direction = 'sendonly';\n            }\n          } else if (audioTransceiver.direction === 'recvonly') {\n            if (audioTransceiver.setDirection) {\n              audioTransceiver.setDirection('inactive');\n            } else {\n              audioTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveAudio === true && !audioTransceiver) {\n          this.addTransceiver('audio', { direction: 'recvonly' });\n        }\n\n        if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n          offerOptions.offerToReceiveVideo = !!offerOptions.offerToReceiveVideo;\n        }\n        var videoTransceiver = this.getTransceivers().find(function (transceiver) {\n          return transceiver.receiver.track.kind === 'video';\n        });\n        if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n          if (videoTransceiver.direction === 'sendrecv') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('sendonly');\n            } else {\n              videoTransceiver.direction = 'sendonly';\n            }\n          } else if (videoTransceiver.direction === 'recvonly') {\n            if (videoTransceiver.setDirection) {\n              videoTransceiver.setDirection('inactive');\n            } else {\n              videoTransceiver.direction = 'inactive';\n            }\n          }\n        } else if (offerOptions.offerToReceiveVideo === true && !videoTransceiver) {\n          this.addTransceiver('video', { direction: 'recvonly' });\n        }\n      }\n      return origCreateOffer.apply(this, arguments);\n    };\n  }\n\n  function shimAudioContext(window) {\n    if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || window.AudioContext) {\n      return;\n    }\n    window.AudioContext = window.webkitAudioContext;\n  }\n\n  },{\"../utils\":11}],11:[function(require,module,exports){\n  /*\n   *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n   *\n   *  Use of this source code is governed by a BSD-style license\n   *  that can be found in the LICENSE file in the root of the source\n   *  tree.\n   */\n  /* eslint-env node */\n  'use strict';\n\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n\n  var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n  exports.extractVersion = extractVersion;\n  exports.wrapPeerConnectionEvent = wrapPeerConnectionEvent;\n  exports.disableLog = disableLog;\n  exports.disableWarnings = disableWarnings;\n  exports.log = log;\n  exports.deprecated = deprecated;\n  exports.detectBrowser = detectBrowser;\n  exports.compactObject = compactObject;\n  exports.walkStats = walkStats;\n  exports.filterStats = filterStats;\n\n  function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n  var logDisabled_ = true;\n  var deprecationWarnings_ = true;\n\n  /**\n   * Extract browser version out of the provided user agent string.\n   *\n   * @param {!string} uastring userAgent string.\n   * @param {!string} expr Regular expression used as match criteria.\n   * @param {!number} pos position in the version string to be returned.\n   * @return {!number} browser version.\n   */\n  function extractVersion(uastring, expr, pos) {\n    var match = uastring.match(expr);\n    return match && match.length >= pos && parseInt(match[pos], 10);\n  }\n\n  // Wraps the peerconnection event eventNameToWrap in a function\n  // which returns the modified event object (or false to prevent\n  // the event).\n  function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n    if (!window.RTCPeerConnection) {\n      return;\n    }\n    var proto = window.RTCPeerConnection.prototype;\n    var nativeAddEventListener = proto.addEventListener;\n    proto.addEventListener = function (nativeEventName, cb) {\n      if (nativeEventName !== eventNameToWrap) {\n        return nativeAddEventListener.apply(this, arguments);\n      }\n      var wrappedCallback = function wrappedCallback(e) {\n        var modifiedEvent = wrapper(e);\n        if (modifiedEvent) {\n          if (cb.handleEvent) {\n            cb.handleEvent(modifiedEvent);\n          } else {\n            cb(modifiedEvent);\n          }\n        }\n      };\n      this._eventMap = this._eventMap || {};\n      if (!this._eventMap[eventNameToWrap]) {\n        this._eventMap[eventNameToWrap] = new Map();\n      }\n      this._eventMap[eventNameToWrap].set(cb, wrappedCallback);\n      return nativeAddEventListener.apply(this, [nativeEventName, wrappedCallback]);\n    };\n\n    var nativeRemoveEventListener = proto.removeEventListener;\n    proto.removeEventListener = function (nativeEventName, cb) {\n      if (nativeEventName !== eventNameToWrap || !this._eventMap || !this._eventMap[eventNameToWrap]) {\n        return nativeRemoveEventListener.apply(this, arguments);\n      }\n      if (!this._eventMap[eventNameToWrap].has(cb)) {\n        return nativeRemoveEventListener.apply(this, arguments);\n      }\n      var unwrappedCb = this._eventMap[eventNameToWrap].get(cb);\n      this._eventMap[eventNameToWrap].delete(cb);\n      if (this._eventMap[eventNameToWrap].size === 0) {\n        delete this._eventMap[eventNameToWrap];\n      }\n      if (Object.keys(this._eventMap).length === 0) {\n        delete this._eventMap;\n      }\n      return nativeRemoveEventListener.apply(this, [nativeEventName, unwrappedCb]);\n    };\n\n    Object.defineProperty(proto, 'on' + eventNameToWrap, {\n      get: function get() {\n        return this['_on' + eventNameToWrap];\n      },\n      set: function set(cb) {\n        if (this['_on' + eventNameToWrap]) {\n          this.removeEventListener(eventNameToWrap, this['_on' + eventNameToWrap]);\n          delete this['_on' + eventNameToWrap];\n        }\n        if (cb) {\n          this.addEventListener(eventNameToWrap, this['_on' + eventNameToWrap] = cb);\n        }\n      },\n\n      enumerable: true,\n      configurable: true\n    });\n  }\n\n  function disableLog(bool) {\n    if (typeof bool !== 'boolean') {\n      return new Error('Argument type: ' + (typeof bool === 'undefined' ? 'undefined' : _typeof(bool)) + '. Please use a boolean.');\n    }\n    logDisabled_ = bool;\n    return bool ? 'adapter.js logging disabled' : 'adapter.js logging enabled';\n  }\n\n  /**\n   * Disable or enable deprecation warnings\n   * @param {!boolean} bool set to true to disable warnings.\n   */\n  function disableWarnings(bool) {\n    if (typeof bool !== 'boolean') {\n      return new Error('Argument type: ' + (typeof bool === 'undefined' ? 'undefined' : _typeof(bool)) + '. Please use a boolean.');\n    }\n    deprecationWarnings_ = !bool;\n    return 'adapter.js deprecation warnings ' + (bool ? 'disabled' : 'enabled');\n  }\n\n  function log() {\n    if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object') {\n      if (logDisabled_) {\n        return;\n      }\n      if (typeof console !== 'undefined' && typeof console.log === 'function') {\n        console.log.apply(console, arguments);\n      }\n    }\n  }\n\n  /**\n   * Shows a deprecation warning suggesting the modern and spec-compatible API.\n   */\n  function deprecated(oldMethod, newMethod) {\n    if (!deprecationWarnings_) {\n      return;\n    }\n    console.warn(oldMethod + ' is deprecated, please use ' + newMethod + ' instead.');\n  }\n\n  /**\n   * Browser detector.\n   *\n   * @return {object} result containing browser and version\n   *     properties.\n   */\n  function detectBrowser(window) {\n    // Returned result object.\n    var result = { browser: null, version: null };\n\n    // Fail early if it's not a browser\n    if (typeof window === 'undefined' || !window.navigator) {\n      result.browser = 'Not a browser.';\n      return result;\n    }\n\n    var navigator = window.navigator;\n\n\n    if (navigator.mozGetUserMedia) {\n      // Firefox.\n      result.browser = 'firefox';\n      result.version = extractVersion(navigator.userAgent, /Firefox\\/(\\d+)\\./, 1);\n    } else if (navigator.webkitGetUserMedia || window.isSecureContext === false && window.webkitRTCPeerConnection && !window.RTCIceGatherer) {\n      // Chrome, Chromium, Webview, Opera.\n      // Version matches Chrome/WebRTC version.\n      // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n      // more complicated fallback to webkitRTCPeerConnection.\n      result.browser = 'chrome';\n      result.version = extractVersion(navigator.userAgent, /Chrom(e|ium)\\/(\\d+)\\./, 2);\n    } else if (window.RTCPeerConnection && navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) {\n      // Safari.\n      result.browser = 'safari';\n      result.version = extractVersion(navigator.userAgent, /AppleWebKit\\/(\\d+)\\./, 1);\n      result.supportsUnifiedPlan = window.RTCRtpTransceiver && 'currentDirection' in window.RTCRtpTransceiver.prototype;\n    } else {\n      // Default fallthrough: not supported.\n      result.browser = 'Not a supported browser.';\n      return result;\n    }\n\n    return result;\n  }\n\n  /**\n   * Checks if something is an object.\n   *\n   * @param {*} val The something you want to check.\n   * @return true if val is an object, false otherwise.\n   */\n  function isObject(val) {\n    return Object.prototype.toString.call(val) === '[object Object]';\n  }\n\n  /**\n   * Remove all empty objects and undefined values\n   * from a nested object -- an enhanced and vanilla version\n   * of Lodash's `compact`.\n   */\n  function compactObject(data) {\n    if (!isObject(data)) {\n      return data;\n    }\n\n    return Object.keys(data).reduce(function (accumulator, key) {\n      var isObj = isObject(data[key]);\n      var value = isObj ? compactObject(data[key]) : data[key];\n      var isEmptyObject = isObj && !Object.keys(value).length;\n      if (value === undefined || isEmptyObject) {\n        return accumulator;\n      }\n      return Object.assign(accumulator, _defineProperty({}, key, value));\n    }, {});\n  }\n\n  /* iterates the stats graph recursively. */\n  function walkStats(stats, base, resultSet) {\n    if (!base || resultSet.has(base.id)) {\n      return;\n    }\n    resultSet.set(base.id, base);\n    Object.keys(base).forEach(function (name) {\n      if (name.endsWith('Id')) {\n        walkStats(stats, stats.get(base[name]), resultSet);\n      } else if (name.endsWith('Ids')) {\n        base[name].forEach(function (id) {\n          walkStats(stats, stats.get(id), resultSet);\n        });\n      }\n    });\n  }\n\n  /* filter getStats for a sender/receiver track. */\n  function filterStats(result, track, outbound) {\n    var streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n    var filteredResult = new Map();\n    if (track === null) {\n      return filteredResult;\n    }\n    var trackStats = [];\n    result.forEach(function (value) {\n      if (value.type === 'track' && value.trackIdentifier === track.id) {\n        trackStats.push(value);\n      }\n    });\n    trackStats.forEach(function (trackStat) {\n      result.forEach(function (stats) {\n        if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n          walkStats(result, stats, filteredResult);\n        }\n      });\n    });\n    return filteredResult;\n  }\n\n  },{}],12:[function(require,module,exports){\n  /* eslint-env node */\n  'use strict';\n\n  // SDP helpers.\n\n  var _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n  var SDPUtils = {};\n\n  // Generate an alphanumeric identifier for cname or mids.\n  // TODO: use UUIDs instead? https://gist.github.com/jed/982883\n  SDPUtils.generateIdentifier = function () {\n    return Math.random().toString(36).substr(2, 10);\n  };\n\n  // The RTCP CNAME used by all peerconnections from the same JS.\n  SDPUtils.localCName = SDPUtils.generateIdentifier();\n\n  // Splits SDP into lines, dealing with both CRLF and LF.\n  SDPUtils.splitLines = function (blob) {\n    return blob.trim().split('\\n').map(function (line) {\n      return line.trim();\n    });\n  };\n  // Splits SDP into sessionpart and mediasections. Ensures CRLF.\n  SDPUtils.splitSections = function (blob) {\n    var parts = blob.split('\\nm=');\n    return parts.map(function (part, index) {\n      return (index > 0 ? 'm=' + part : part).trim() + '\\r\\n';\n    });\n  };\n\n  // Returns the session description.\n  SDPUtils.getDescription = function (blob) {\n    var sections = SDPUtils.splitSections(blob);\n    return sections && sections[0];\n  };\n\n  // Returns the individual media sections.\n  SDPUtils.getMediaSections = function (blob) {\n    var sections = SDPUtils.splitSections(blob);\n    sections.shift();\n    return sections;\n  };\n\n  // Returns lines that start with a certain prefix.\n  SDPUtils.matchPrefix = function (blob, prefix) {\n    return SDPUtils.splitLines(blob).filter(function (line) {\n      return line.indexOf(prefix) === 0;\n    });\n  };\n\n  // Parses an ICE candidate line. Sample input:\n  // candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n  // rport 55996\"\n  // Input can be prefixed with a=.\n  SDPUtils.parseCandidate = function (line) {\n    var parts = void 0;\n    // Parse both variants.\n    if (line.indexOf('a=candidate:') === 0) {\n      parts = line.substring(12).split(' ');\n    } else {\n      parts = line.substring(10).split(' ');\n    }\n\n    var candidate = {\n      foundation: parts[0],\n      component: { 1: 'rtp', 2: 'rtcp' }[parts[1]] || parts[1],\n      protocol: parts[2].toLowerCase(),\n      priority: parseInt(parts[3], 10),\n      ip: parts[4],\n      address: parts[4], // address is an alias for ip.\n      port: parseInt(parts[5], 10),\n      // skip parts[6] == 'typ'\n      type: parts[7]\n    };\n\n    for (var i = 8; i < parts.length; i += 2) {\n      switch (parts[i]) {\n        case 'raddr':\n          candidate.relatedAddress = parts[i + 1];\n          break;\n        case 'rport':\n          candidate.relatedPort = parseInt(parts[i + 1], 10);\n          break;\n        case 'tcptype':\n          candidate.tcpType = parts[i + 1];\n          break;\n        case 'ufrag':\n          candidate.ufrag = parts[i + 1]; // for backward compatibility.\n          candidate.usernameFragment = parts[i + 1];\n          break;\n        default:\n          // extension handling, in particular ufrag. Don't overwrite.\n          if (candidate[parts[i]] === undefined) {\n            candidate[parts[i]] = parts[i + 1];\n          }\n          break;\n      }\n    }\n    return candidate;\n  };\n\n  // Translates a candidate object into SDP candidate attribute.\n  // This does not include the a= prefix!\n  SDPUtils.writeCandidate = function (candidate) {\n    var sdp = [];\n    sdp.push(candidate.foundation);\n\n    var component = candidate.component;\n    if (component === 'rtp') {\n      sdp.push(1);\n    } else if (component === 'rtcp') {\n      sdp.push(2);\n    } else {\n      sdp.push(component);\n    }\n    sdp.push(candidate.protocol.toUpperCase());\n    sdp.push(candidate.priority);\n    sdp.push(candidate.address || candidate.ip);\n    sdp.push(candidate.port);\n\n    var type = candidate.type;\n    sdp.push('typ');\n    sdp.push(type);\n    if (type !== 'host' && candidate.relatedAddress && candidate.relatedPort) {\n      sdp.push('raddr');\n      sdp.push(candidate.relatedAddress);\n      sdp.push('rport');\n      sdp.push(candidate.relatedPort);\n    }\n    if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n      sdp.push('tcptype');\n      sdp.push(candidate.tcpType);\n    }\n    if (candidate.usernameFragment || candidate.ufrag) {\n      sdp.push('ufrag');\n      sdp.push(candidate.usernameFragment || candidate.ufrag);\n    }\n    return 'candidate:' + sdp.join(' ');\n  };\n\n  // Parses an ice-options line, returns an array of option tags.\n  // Sample input:\n  // a=ice-options:foo bar\n  SDPUtils.parseIceOptions = function (line) {\n    return line.substr(14).split(' ');\n  };\n\n  // Parses a rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n  // a=rtpmap:111 opus/48000/2\n  SDPUtils.parseRtpMap = function (line) {\n    var parts = line.substr(9).split(' ');\n    var parsed = {\n      payloadType: parseInt(parts.shift(), 10) // was: id\n    };\n\n    parts = parts[0].split('/');\n\n    parsed.name = parts[0];\n    parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n    parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n    // legacy alias, got renamed back to channels in ORTC.\n    parsed.numChannels = parsed.channels;\n    return parsed;\n  };\n\n  // Generates a rtpmap line from RTCRtpCodecCapability or\n  // RTCRtpCodecParameters.\n  SDPUtils.writeRtpMap = function (codec) {\n    var pt = codec.payloadType;\n    if (codec.preferredPayloadType !== undefined) {\n      pt = codec.preferredPayloadType;\n    }\n    var channels = codec.channels || codec.numChannels || 1;\n    return 'a=rtpmap:' + pt + ' ' + codec.name + '/' + codec.clockRate + (channels !== 1 ? '/' + channels : '') + '\\r\\n';\n  };\n\n  // Parses a extmap line (headerextension from RFC 5285). Sample input:\n  // a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n  // a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\n  SDPUtils.parseExtmap = function (line) {\n    var parts = line.substr(9).split(' ');\n    return {\n      id: parseInt(parts[0], 10),\n      direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n      uri: parts[1]\n    };\n  };\n\n  // Generates an extmap line from RTCRtpHeaderExtensionParameters or\n  // RTCRtpHeaderExtension.\n  SDPUtils.writeExtmap = function (headerExtension) {\n    return 'a=extmap:' + (headerExtension.id || headerExtension.preferredId) + (headerExtension.direction && headerExtension.direction !== 'sendrecv' ? '/' + headerExtension.direction : '') + ' ' + headerExtension.uri + '\\r\\n';\n  };\n\n  // Parses a fmtp line, returns dictionary. Sample input:\n  // a=fmtp:96 vbr=on;cng=on\n  // Also deals with vbr=on; cng=on\n  SDPUtils.parseFmtp = function (line) {\n    var parsed = {};\n    var kv = void 0;\n    var parts = line.substr(line.indexOf(' ') + 1).split(';');\n    for (var j = 0; j < parts.length; j++) {\n      kv = parts[j].trim().split('=');\n      parsed[kv[0].trim()] = kv[1];\n    }\n    return parsed;\n  };\n\n  // Generates a fmtp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\n  SDPUtils.writeFmtp = function (codec) {\n    var line = '';\n    var pt = codec.payloadType;\n    if (codec.preferredPayloadType !== undefined) {\n      pt = codec.preferredPayloadType;\n    }\n    if (codec.parameters && Object.keys(codec.parameters).length) {\n      var params = [];\n      Object.keys(codec.parameters).forEach(function (param) {\n        if (codec.parameters[param] !== undefined) {\n          params.push(param + '=' + codec.parameters[param]);\n        } else {\n          params.push(param);\n        }\n      });\n      line += 'a=fmtp:' + pt + ' ' + params.join(';') + '\\r\\n';\n    }\n    return line;\n  };\n\n  // Parses a rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n  // a=rtcp-fb:98 nack rpsi\n  SDPUtils.parseRtcpFb = function (line) {\n    var parts = line.substr(line.indexOf(' ') + 1).split(' ');\n    return {\n      type: parts.shift(),\n      parameter: parts.join(' ')\n    };\n  };\n\n  // Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\n  SDPUtils.writeRtcpFb = function (codec) {\n    var lines = '';\n    var pt = codec.payloadType;\n    if (codec.preferredPayloadType !== undefined) {\n      pt = codec.preferredPayloadType;\n    }\n    if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n      // FIXME: special handling for trr-int?\n      codec.rtcpFeedback.forEach(function (fb) {\n        lines += 'a=rtcp-fb:' + pt + ' ' + fb.type + (fb.parameter && fb.parameter.length ? ' ' + fb.parameter : '') + '\\r\\n';\n      });\n    }\n    return lines;\n  };\n\n  // Parses a RFC 5576 ssrc media attribute. Sample input:\n  // a=ssrc:3735928559 cname:something\n  SDPUtils.parseSsrcMedia = function (line) {\n    var sp = line.indexOf(' ');\n    var parts = {\n      ssrc: parseInt(line.substr(7, sp - 7), 10)\n    };\n    var colon = line.indexOf(':', sp);\n    if (colon > -1) {\n      parts.attribute = line.substr(sp + 1, colon - sp - 1);\n      parts.value = line.substr(colon + 1);\n    } else {\n      parts.attribute = line.substr(sp + 1);\n    }\n    return parts;\n  };\n\n  // Parse a ssrc-group line (see RFC 5576). Sample input:\n  // a=ssrc-group:semantics 12 34\n  SDPUtils.parseSsrcGroup = function (line) {\n    var parts = line.substr(13).split(' ');\n    return {\n      semantics: parts.shift(),\n      ssrcs: parts.map(function (ssrc) {\n        return parseInt(ssrc, 10);\n      })\n    };\n  };\n\n  // Extracts the MID (RFC 5888) from a media section.\n  // Returns the MID or undefined if no mid line was found.\n  SDPUtils.getMid = function (mediaSection) {\n    var mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n    if (mid) {\n      return mid.substr(6);\n    }\n  };\n\n  // Parses a fingerprint line for DTLS-SRTP.\n  SDPUtils.parseFingerprint = function (line) {\n    var parts = line.substr(14).split(' ');\n    return {\n      algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n      value: parts[1].toUpperCase() // the definition is upper-case in RFC 4572.\n    };\n  };\n\n  // Extracts DTLS parameters from SDP media section or sessionpart.\n  // FIXME: for consistency with other functions this should only\n  //   get the fingerprint line as input. See also getIceParameters.\n  SDPUtils.getDtlsParameters = function (mediaSection, sessionpart) {\n    var lines = SDPUtils.matchPrefix(mediaSection + sessionpart, 'a=fingerprint:');\n    // Note: a=setup line is ignored since we use the 'auto' role in Edge.\n    return {\n      role: 'auto',\n      fingerprints: lines.map(SDPUtils.parseFingerprint)\n    };\n  };\n\n  // Serializes DTLS parameters to SDP.\n  SDPUtils.writeDtlsParameters = function (params, setupType) {\n    var sdp = 'a=setup:' + setupType + '\\r\\n';\n    params.fingerprints.forEach(function (fp) {\n      sdp += 'a=fingerprint:' + fp.algorithm + ' ' + fp.value + '\\r\\n';\n    });\n    return sdp;\n  };\n\n  // Parses a=crypto lines into\n  //   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#dictionary-rtcsrtpsdesparameters-members\n  SDPUtils.parseCryptoLine = function (line) {\n    var parts = line.substr(9).split(' ');\n    return {\n      tag: parseInt(parts[0], 10),\n      cryptoSuite: parts[1],\n      keyParams: parts[2],\n      sessionParams: parts.slice(3)\n    };\n  };\n\n  SDPUtils.writeCryptoLine = function (parameters) {\n    return 'a=crypto:' + parameters.tag + ' ' + parameters.cryptoSuite + ' ' + (_typeof(parameters.keyParams) === 'object' ? SDPUtils.writeCryptoKeyParams(parameters.keyParams) : parameters.keyParams) + (parameters.sessionParams ? ' ' + parameters.sessionParams.join(' ') : '') + '\\r\\n';\n  };\n\n  // Parses the crypto key parameters into\n  //   https://rawgit.com/aboba/edgertc/master/msortc-rs4.html#rtcsrtpkeyparam*\n  SDPUtils.parseCryptoKeyParams = function (keyParams) {\n    if (keyParams.indexOf('inline:') !== 0) {\n      return null;\n    }\n    var parts = keyParams.substr(7).split('|');\n    return {\n      keyMethod: 'inline',\n      keySalt: parts[0],\n      lifeTime: parts[1],\n      mkiValue: parts[2] ? parts[2].split(':')[0] : undefined,\n      mkiLength: parts[2] ? parts[2].split(':')[1] : undefined\n    };\n  };\n\n  SDPUtils.writeCryptoKeyParams = function (keyParams) {\n    return keyParams.keyMethod + ':' + keyParams.keySalt + (keyParams.lifeTime ? '|' + keyParams.lifeTime : '') + (keyParams.mkiValue && keyParams.mkiLength ? '|' + keyParams.mkiValue + ':' + keyParams.mkiLength : '');\n  };\n\n  // Extracts all SDES parameters.\n  SDPUtils.getCryptoParameters = function (mediaSection, sessionpart) {\n    var lines = SDPUtils.matchPrefix(mediaSection + sessionpart, 'a=crypto:');\n    return lines.map(SDPUtils.parseCryptoLine);\n  };\n\n  // Parses ICE information from SDP media section or sessionpart.\n  // FIXME: for consistency with other functions this should only\n  //   get the ice-ufrag and ice-pwd lines as input.\n  SDPUtils.getIceParameters = function (mediaSection, sessionpart) {\n    var ufrag = SDPUtils.matchPrefix(mediaSection + sessionpart, 'a=ice-ufrag:')[0];\n    var pwd = SDPUtils.matchPrefix(mediaSection + sessionpart, 'a=ice-pwd:')[0];\n    if (!(ufrag && pwd)) {\n      return null;\n    }\n    return {\n      usernameFragment: ufrag.substr(12),\n      password: pwd.substr(10)\n    };\n  };\n\n  // Serializes ICE parameters to SDP.\n  SDPUtils.writeIceParameters = function (params) {\n    var sdp = 'a=ice-ufrag:' + params.usernameFragment + '\\r\\n' + 'a=ice-pwd:' + params.password + '\\r\\n';\n    if (params.iceLite) {\n      sdp += 'a=ice-lite\\r\\n';\n    }\n    return sdp;\n  };\n\n  // Parses the SDP media section and returns RTCRtpParameters.\n  SDPUtils.parseRtpParameters = function (mediaSection) {\n    var description = {\n      codecs: [],\n      headerExtensions: [],\n      fecMechanisms: [],\n      rtcp: []\n    };\n    var lines = SDPUtils.splitLines(mediaSection);\n    var mline = lines[0].split(' ');\n    for (var i = 3; i < mline.length; i++) {\n      // find all codecs from mline[3..]\n      var pt = mline[i];\n      var rtpmapline = SDPUtils.matchPrefix(mediaSection, 'a=rtpmap:' + pt + ' ')[0];\n      if (rtpmapline) {\n        var codec = SDPUtils.parseRtpMap(rtpmapline);\n        var fmtps = SDPUtils.matchPrefix(mediaSection, 'a=fmtp:' + pt + ' ');\n        // Only the first a=fmtp:<pt> is considered.\n        codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n        codec.rtcpFeedback = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-fb:' + pt + ' ').map(SDPUtils.parseRtcpFb);\n        description.codecs.push(codec);\n        // parse FEC mechanisms from rtpmap lines.\n        switch (codec.name.toUpperCase()) {\n          case 'RED':\n          case 'ULPFEC':\n            description.fecMechanisms.push(codec.name.toUpperCase());\n            break;\n          default:\n            // only RED and ULPFEC are recognized as FEC mechanisms.\n            break;\n        }\n      }\n    }\n    SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach(function (line) {\n      description.headerExtensions.push(SDPUtils.parseExtmap(line));\n    });\n    // FIXME: parse rtcp.\n    return description;\n  };\n\n  // Generates parts of the SDP media section describing the capabilities /\n  // parameters.\n  SDPUtils.writeRtpDescription = function (kind, caps) {\n    var sdp = '';\n\n    // Build the mline.\n    sdp += 'm=' + kind + ' ';\n    sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n    sdp += ' UDP/TLS/RTP/SAVPF ';\n    sdp += caps.codecs.map(function (codec) {\n      if (codec.preferredPayloadType !== undefined) {\n        return codec.preferredPayloadType;\n      }\n      return codec.payloadType;\n    }).join(' ') + '\\r\\n';\n\n    sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n    sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n    // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n    caps.codecs.forEach(function (codec) {\n      sdp += SDPUtils.writeRtpMap(codec);\n      sdp += SDPUtils.writeFmtp(codec);\n      sdp += SDPUtils.writeRtcpFb(codec);\n    });\n    var maxptime = 0;\n    caps.codecs.forEach(function (codec) {\n      if (codec.maxptime > maxptime) {\n        maxptime = codec.maxptime;\n      }\n    });\n    if (maxptime > 0) {\n      sdp += 'a=maxptime:' + maxptime + '\\r\\n';\n    }\n\n    if (caps.headerExtensions) {\n      caps.headerExtensions.forEach(function (extension) {\n        sdp += SDPUtils.writeExtmap(extension);\n      });\n    }\n    // FIXME: write fecMechanisms.\n    return sdp;\n  };\n\n  // Parses the SDP media section and returns an array of\n  // RTCRtpEncodingParameters.\n  SDPUtils.parseRtpEncodingParameters = function (mediaSection) {\n    var encodingParameters = [];\n    var description = SDPUtils.parseRtpParameters(mediaSection);\n    var hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n    var hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n    // filter a=ssrc:... cname:, ignore PlanB-msid\n    var ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:').map(function (line) {\n      return SDPUtils.parseSsrcMedia(line);\n    }).filter(function (parts) {\n      return parts.attribute === 'cname';\n    });\n    var primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n    var secondarySsrc = void 0;\n\n    var flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID').map(function (line) {\n      var parts = line.substr(17).split(' ');\n      return parts.map(function (part) {\n        return parseInt(part, 10);\n      });\n    });\n    if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n      secondarySsrc = flows[0][1];\n    }\n\n    description.codecs.forEach(function (codec) {\n      if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n        var encParam = {\n          ssrc: primarySsrc,\n          codecPayloadType: parseInt(codec.parameters.apt, 10)\n        };\n        if (primarySsrc && secondarySsrc) {\n          encParam.rtx = { ssrc: secondarySsrc };\n        }\n        encodingParameters.push(encParam);\n        if (hasRed) {\n          encParam = JSON.parse(JSON.stringify(encParam));\n          encParam.fec = {\n            ssrc: primarySsrc,\n            mechanism: hasUlpfec ? 'red+ulpfec' : 'red'\n          };\n          encodingParameters.push(encParam);\n        }\n      }\n    });\n    if (encodingParameters.length === 0 && primarySsrc) {\n      encodingParameters.push({\n        ssrc: primarySsrc\n      });\n    }\n\n    // we support both b=AS and b=TIAS but interpret AS as TIAS.\n    var bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n    if (bandwidth.length) {\n      if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n        bandwidth = parseInt(bandwidth[0].substr(7), 10);\n      } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n        // use formula from JSEP to convert b=AS to TIAS value.\n        bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95 - 50 * 40 * 8;\n      } else {\n        bandwidth = undefined;\n      }\n      encodingParameters.forEach(function (params) {\n        params.maxBitrate = bandwidth;\n      });\n    }\n    return encodingParameters;\n  };\n\n  // parses http://draft.ortc.org/#rtcrtcpparameters*\n  SDPUtils.parseRtcpParameters = function (mediaSection) {\n    var rtcpParameters = {};\n\n    // Gets the first SSRC. Note that with RTX there might be multiple\n    // SSRCs.\n    var remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:').map(function (line) {\n      return SDPUtils.parseSsrcMedia(line);\n    }).filter(function (obj) {\n      return obj.attribute === 'cname';\n    })[0];\n    if (remoteSsrc) {\n      rtcpParameters.cname = remoteSsrc.value;\n      rtcpParameters.ssrc = remoteSsrc.ssrc;\n    }\n\n    // Edge uses the compound attribute instead of reducedSize\n    // compound is !reducedSize\n    var rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n    rtcpParameters.reducedSize = rsize.length > 0;\n    rtcpParameters.compound = rsize.length === 0;\n\n    // parses the rtcp-mux attrbute.\n    // Note that Edge does not support unmuxed RTCP.\n    var mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n    rtcpParameters.mux = mux.length > 0;\n\n    return rtcpParameters;\n  };\n\n  SDPUtils.writeRtcpParameters = function (rtcpParameters) {\n    var sdp = '';\n    if (rtcpParameters.reducedSize) {\n      sdp += 'a=rtcp-rsize\\r\\n';\n    }\n    if (rtcpParameters.mux) {\n      sdp += 'a=rtcp-mux\\r\\n';\n    }\n    if (rtcpParameters.ssrc !== undefined && rtcpParameters.cname) {\n      sdp += 'a=ssrc:' + rtcpParameters.ssrc + ' cname:' + rtcpParameters.cname + '\\r\\n';\n    }\n    return sdp;\n  };\n\n  // parses either a=msid: or a=ssrc:... msid lines and returns\n  // the id of the MediaStream and MediaStreamTrack.\n  SDPUtils.parseMsid = function (mediaSection) {\n    var parts = void 0;\n    var spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n    if (spec.length === 1) {\n      parts = spec[0].substr(7).split(' ');\n      return { stream: parts[0], track: parts[1] };\n    }\n    var planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:').map(function (line) {\n      return SDPUtils.parseSsrcMedia(line);\n    }).filter(function (msidParts) {\n      return msidParts.attribute === 'msid';\n    });\n    if (planB.length > 0) {\n      parts = planB[0].value.split(' ');\n      return { stream: parts[0], track: parts[1] };\n    }\n  };\n\n  // SCTP\n  // parses draft-ietf-mmusic-sctp-sdp-26 first and falls back\n  // to draft-ietf-mmusic-sctp-sdp-05\n  SDPUtils.parseSctpDescription = function (mediaSection) {\n    var mline = SDPUtils.parseMLine(mediaSection);\n    var maxSizeLine = SDPUtils.matchPrefix(mediaSection, 'a=max-message-size:');\n    var maxMessageSize = void 0;\n    if (maxSizeLine.length > 0) {\n      maxMessageSize = parseInt(maxSizeLine[0].substr(19), 10);\n    }\n    if (isNaN(maxMessageSize)) {\n      maxMessageSize = 65536;\n    }\n    var sctpPort = SDPUtils.matchPrefix(mediaSection, 'a=sctp-port:');\n    if (sctpPort.length > 0) {\n      return {\n        port: parseInt(sctpPort[0].substr(12), 10),\n        protocol: mline.fmt,\n        maxMessageSize: maxMessageSize\n      };\n    }\n    var sctpMapLines = SDPUtils.matchPrefix(mediaSection, 'a=sctpmap:');\n    if (sctpMapLines.length > 0) {\n      var parts = sctpMapLines[0].substr(10).split(' ');\n      return {\n        port: parseInt(parts[0], 10),\n        protocol: parts[1],\n        maxMessageSize: maxMessageSize\n      };\n    }\n  };\n\n  // SCTP\n  // outputs the draft-ietf-mmusic-sctp-sdp-26 version that all browsers\n  // support by now receiving in this format, unless we originally parsed\n  // as the draft-ietf-mmusic-sctp-sdp-05 format (indicated by the m-line\n  // protocol of DTLS/SCTP -- without UDP/ or TCP/)\n  SDPUtils.writeSctpDescription = function (media, sctp) {\n    var output = [];\n    if (media.protocol !== 'DTLS/SCTP') {\n      output = ['m=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.protocol + '\\r\\n', 'c=IN IP4 0.0.0.0\\r\\n', 'a=sctp-port:' + sctp.port + '\\r\\n'];\n    } else {\n      output = ['m=' + media.kind + ' 9 ' + media.protocol + ' ' + sctp.port + '\\r\\n', 'c=IN IP4 0.0.0.0\\r\\n', 'a=sctpmap:' + sctp.port + ' ' + sctp.protocol + ' 65535\\r\\n'];\n    }\n    if (sctp.maxMessageSize !== undefined) {\n      output.push('a=max-message-size:' + sctp.maxMessageSize + '\\r\\n');\n    }\n    return output.join('');\n  };\n\n  // Generate a session ID for SDP.\n  // https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n  // recommends using a cryptographically random +ve 64-bit value\n  // but right now this should be acceptable and within the right range\n  SDPUtils.generateSessionId = function () {\n    return Math.random().toString().substr(2, 21);\n  };\n\n  // Write boiler plate for start of SDP\n  // sessId argument is optional - if not supplied it will\n  // be generated randomly\n  // sessVersion is optional and defaults to 2\n  // sessUser is optional and defaults to 'thisisadapterortc'\n  SDPUtils.writeSessionBoilerplate = function (sessId, sessVer, sessUser) {\n    var sessionId = void 0;\n    var version = sessVer !== undefined ? sessVer : 2;\n    if (sessId) {\n      sessionId = sessId;\n    } else {\n      sessionId = SDPUtils.generateSessionId();\n    }\n    var user = sessUser || 'thisisadapterortc';\n    // FIXME: sess-id should be an NTP timestamp.\n    return 'v=0\\r\\n' + 'o=' + user + ' ' + sessionId + ' ' + version + ' IN IP4 127.0.0.1\\r\\n' + 's=-\\r\\n' + 't=0 0\\r\\n';\n  };\n\n  // Gets the direction from the mediaSection or the sessionpart.\n  SDPUtils.getDirection = function (mediaSection, sessionpart) {\n    // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n    var lines = SDPUtils.splitLines(mediaSection);\n    for (var i = 0; i < lines.length; i++) {\n      switch (lines[i]) {\n        case 'a=sendrecv':\n        case 'a=sendonly':\n        case 'a=recvonly':\n        case 'a=inactive':\n          return lines[i].substr(2);\n        default:\n        // FIXME: What should happen here?\n      }\n    }\n    if (sessionpart) {\n      return SDPUtils.getDirection(sessionpart);\n    }\n    return 'sendrecv';\n  };\n\n  SDPUtils.getKind = function (mediaSection) {\n    var lines = SDPUtils.splitLines(mediaSection);\n    var mline = lines[0].split(' ');\n    return mline[0].substr(2);\n  };\n\n  SDPUtils.isRejected = function (mediaSection) {\n    return mediaSection.split(' ', 2)[1] === '0';\n  };\n\n  SDPUtils.parseMLine = function (mediaSection) {\n    var lines = SDPUtils.splitLines(mediaSection);\n    var parts = lines[0].substr(2).split(' ');\n    return {\n      kind: parts[0],\n      port: parseInt(parts[1], 10),\n      protocol: parts[2],\n      fmt: parts.slice(3).join(' ')\n    };\n  };\n\n  SDPUtils.parseOLine = function (mediaSection) {\n    var line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n    var parts = line.substr(2).split(' ');\n    return {\n      username: parts[0],\n      sessionId: parts[1],\n      sessionVersion: parseInt(parts[2], 10),\n      netType: parts[3],\n      addressType: parts[4],\n      address: parts[5]\n    };\n  };\n\n  // a very naive interpretation of a valid SDP.\n  SDPUtils.isValidSDP = function (blob) {\n    if (typeof blob !== 'string' || blob.length === 0) {\n      return false;\n    }\n    var lines = SDPUtils.splitLines(blob);\n    for (var i = 0; i < lines.length; i++) {\n      if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n        return false;\n      }\n      // TODO: check the modifier a bit more.\n    }\n    return true;\n  };\n\n  // Expose public methods.\n  if ((typeof module === 'undefined' ? 'undefined' : _typeof(module)) === 'object') {\n    module.exports = SDPUtils;\n  }\n  },{}]},{},[1])(1)\n  });\n","(function() {\n  if (!navigator.mediaDevices) navigator.mediaDevices = {};\n  if (!navigator.mediaDevices.getUserMedia) {\n    var getUserMedia =\n      navigator.webkitGetUserMedia ||\n      navigator.mozGetUserMedia ||\n      navigator.msGetUserMedia ||\n      navigator.getUserMedia;\n\n    if (getUserMedia) {\n      navigator.mediaDevices.getUserMedia = function(constraints) {\n        return new Promise(function(resolve, reject) {\n          getUserMedia(\n            constraints,\n            function(stream) {\n              resolve(stream);\n            },\n            function(error) {\n              reject(error);\n            }\n          );\n        });\n      };\n    } else {\n      navigator.mediaDevices.getUserMedia = function() {\n        // A missing `getUserMedia` seemingly can mean one of two things:\n        //\n        // 1) WebRTC is unsupported or disabled on this browser\n        // 2) This is an insecure connection\n        //   * This handling of insecure connections happens only on certain browsers.\n        //     It was observed in Chromium 80 and Firefox 75, but not Firefox 68. I suspect it's the new behavior.\n        //   * In other browsers, it handles insecure connections by throwing `NotAllowedError`.\n        //     We still handle this case in the calling function.\n        //   * See: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n        //     As of this writing, this claims that the browser does *both* of these things for\n        //     insecure connections, which is of course impossible and thus confusing.\n        //\n        // We will attempt to distinguish these two cases by checking for various webrtc-related fields on\n        // `window` (inspired by github.com/muaz-khan/DetectRTC). If none of those fields exist, we assume\n        // that WebRTC is not supported on this browser.\n        return new Promise(function(resolve, reject) {\n          if (!(window.RTCPeerConnection || window.webkitRTCPeerConnection || window.mozRTCPeerConnection || window.RTCIceGatherer)) {\n            var e = new Error(\"getUserMedia is not supported in this browser.\");\n            // I'd use NotSupportedError but I'm afraid they'll change the spec on us again\n            e.name = 'CustomNotSupportedError';\n            reject(e);\n          } else {\n            var e = new Error(\"insecure connection\");\n            // I'd use NotAllowedError but I'm afraid they'll change the spec on us again\n            e.name = 'CustomSecureConnectionError';\n            reject(e);\n          }\n        });\n      };\n    }\n  }\n})();","(function(a){var r=a.fn.domManip,d=\"_tmplitem\",q=/^[^<]*(<[\\w\\W]+>)[^>]*$|\\{\\{\\! /,b={},f={},e,p={key:0,data:{}},h=0,c=0,l=[];function g(e,d,g,i){var c={data:i||(d?d.data:{}),_wrap:d?d._wrap:null,tmpl:null,parent:d||null,nodes:[],calls:u,nest:w,wrap:x,html:v,update:t};e&&a.extend(c,e,{nodes:[],parent:d});if(g){c.tmpl=g;c._ctnt=c._ctnt||c.tmpl(a,c);c.key=++h;(l.length?f:b)[h]=c}return c}a.each({appendTo:\"append\",prependTo:\"prepend\",insertBefore:\"before\",insertAfter:\"after\",replaceAll:\"replaceWith\"},function(f,d){a.fn[f]=function(n){var g=[],i=a(n),k,h,m,l,j=this.length===1&&this[0].parentNode;e=b||{};if(j&&j.nodeType===11&&j.childNodes.length===1&&i.length===1){i[d](this[0]);g=this}else{for(h=0,m=i.length;h<m;h++){c=h;k=(h>0?this.clone(true):this).get();a.fn[d].apply(a(i[h]),k);g=g.concat(k)}c=0;g=this.pushStack(g,f,i.selector)}l=e;e=null;a.tmpl.complete(l);return g}});a.fn.extend({tmpl:function(d,c,b){return a.tmpl(this[0],d,c,b)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(d,l,j){if(d[0]&&d[0].nodeType){var f=a.makeArray(arguments),g=d.length,i=0,h;while(i<g&&!(h=a.data(d[i++],\"tmplItem\")));if(g>1)f[0]=[a.makeArray(d)];if(h&&c)f[2]=function(b){a.tmpl.afterManip(this,b,j)};r.apply(this,f)}else r.apply(this,arguments);c=0;!e&&a.tmpl.complete(b);return this}});a.extend({tmpl:function(d,h,e,c){var j,k=!c;if(k){c=p;d=a.template[d]||a.template(null,d);f={}}else if(!d){d=c.tmpl;b[c.key]=c;c.nodes=[];c.wrapped&&n(c,c.wrapped);return a(i(c,null,c.tmpl(a,c)))}if(!d)return[];if(typeof h===\"function\")h=h.call(c||{});e&&e.wrapped&&n(e,e.wrapped);j=a.isArray(h)?a.map(h,function(a){return a?g(e,c,d,a):null}):[g(e,c,d,h)];return k?a(i(c,null,j)):j},tmplItem:function(b){var c;if(b instanceof a)b=b[0];while(b&&b.nodeType===1&&!(c=a.data(b,\"tmplItem\"))&&(b=b.parentNode));return c||p},template:function(c,b){if(b){if(typeof b===\"string\")b=o(b);else if(b instanceof a)b=b[0]||{};if(b.nodeType)b=a.data(b,\"tmpl\")||a.data(b,\"tmpl\",o(b.innerHTML));return typeof c===\"string\"?(a.template[c]=b):b}return c?typeof c!==\"string\"?a.template(null,c):a.template[c]||a.template(null,q.test(c)?c:a(c)):null},encode:function(a){return(\"\"+a).split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\").split('\"').join(\"&#34;\").split(\"'\").join(\"&#39;\")}});a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:\"null\"},open:\"if($notnull_1){_=_.concat($item.nest($1,$2));}\"},wrap:{_default:{$2:\"null\"},open:\"$item.calls(_,$1,$2);_=[];\",close:\"call=$item.calls();_=call._.concat($item.wrap(call,_));\"},each:{_default:{$2:\"$index, $value\"},open:\"if($notnull_1){$.each($1a,function($2){with(this){\",close:\"}});}\"},\"if\":{open:\"if(($notnull_1) && $1a){\",close:\"}\"},\"else\":{_default:{$1:\"true\"},open:\"}else if(($notnull_1) && $1a){\"},html:{open:\"if($notnull_1){_.push($1a);}\"},\"=\":{_default:{$1:\"$data\"},open:\"if($notnull_1){_.push($.encode($1a));}\"},\"!\":{open:\"\"}},complete:function(){b={}},afterManip:function(f,b,d){var e=b.nodeType===11?a.makeArray(b.childNodes):b.nodeType===1?[b]:[];d.call(f,b);m(e);c++}});function i(e,g,f){var b,c=f?a.map(f,function(a){return typeof a===\"string\"?e.key?a.replace(/(<\\w+)(?=[\\s>])(?![^>]*_tmplitem)([^>]*)/g,\"$1 \"+d+'=\"'+e.key+'\" $2'):a:i(a,e,a._ctnt)}):e;if(g)return c;c=c.join(\"\");c.replace(/^\\s*([^<\\s][^<]*)?(<[\\w\\W]+>)([^>]*[^>\\s])?\\s*$/,function(f,c,e,d){b=a(e).get();m(b);if(c)b=j(c).concat(b);if(d)b=b.concat(j(d))});return b?b:j(c)}function j(c){var b=document.createElement(\"div\");b.innerHTML=c;return a.makeArray(b.childNodes)}function o(b){return new Function(\"jQuery\",\"$item\",\"var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('\"+a.trim(b).replace(/([\\\\'])/g,\"\\\\$1\").replace(/[\\r\\t\\n]/g,\" \").replace(/\\$\\{([^\\}]*)\\}/g,\"{{= $1}}\").replace(/\\{\\{(\\/?)(\\w+|.)(?:\\(((?:[^\\}]|\\}(?!\\}))*?)?\\))?(?:\\s+(.*?)?)?(\\(((?:[^\\}]|\\}(?!\\}))*?)\\))?\\s*\\}\\}/g,function(m,l,j,d,b,c,e){var i=a.tmpl.tag[j],h,f,g;if(!i)throw\"Template command not found: \"+j;h=i._default||[];if(c&&!/\\w$/.test(b)){b+=c;c=\"\"}if(b){b=k(b);e=e?\",\"+k(e)+\")\":c?\")\":\"\";f=c?b.indexOf(\".\")>-1?b+c:\"(\"+b+\").call($item\"+e:b;g=c?f:\"(typeof(\"+b+\")==='function'?(\"+b+\").call($item):(\"+b+\"))\"}else g=f=h.$1||\"null\";d=k(d);return\"');\"+i[l?\"close\":\"open\"].split(\"$notnull_1\").join(b?\"typeof(\"+b+\")!=='undefined' && (\"+b+\")!=null\":\"true\").split(\"$1a\").join(g).split(\"$1\").join(f).split(\"$2\").join(d?d.replace(/\\s*([^\\(]+)\\s*(\\((.*?)\\))?/g,function(d,c,b,a){a=a?\",\"+a+\")\":b?\")\":\"\";return a?\"(\"+c+\").call($item\"+a:d}):h.$2||\"\")+\"_.push('\"})+\"');}return _;\")}function n(c,b){c._wrap=i(c,true,a.isArray(b)?b:[q.test(b)?b:a(b).html()]).join(\"\")}function k(a){return a?a.replace(/\\\\'/g,\"'\").replace(/\\\\\\\\/g,\"\\\\\"):null}function s(b){var a=document.createElement(\"div\");a.appendChild(b.cloneNode(true));return a.innerHTML}function m(o){var n=\"_\"+c,k,j,l={},e,p,i;for(e=0,p=o.length;e<p;e++){if((k=o[e]).nodeType!==1)continue;j=k.getElementsByTagName(\"*\");for(i=j.length-1;i>=0;i--)m(j[i]);m(k)}function m(j){var p,i=j,k,e,m;if(m=j.getAttribute(d)){while(i.parentNode&&(i=i.parentNode).nodeType===1&&!(p=i.getAttribute(d)));if(p!==m){i=i.parentNode?i.nodeType===11?0:i.getAttribute(d)||0:0;if(!(e=b[m])){e=f[m];e=g(e,b[i]||f[i],null,true);e.key=++h;b[h]=e}c&&o(m)}j.removeAttribute(d)}else if(c&&(e=a.data(j,\"tmplItem\"))){o(e.key);b[e.key]=e;i=a.data(j.parentNode,\"tmplItem\");i=i?i.key:0}if(e){k=e;while(k&&k.key!=i){k.nodes.push(j);k=k.parent}delete e._ctnt;delete e._wrap;a.data(j,\"tmplItem\",e)}function o(a){a=a+n;e=l[a]=l[a]||g(e,b[e.parent.key+n]||e.parent,null,true)}}}function u(a,d,c,b){if(!a)return l.pop();l.push({_:a,tmpl:d,item:this,data:c,options:b})}function w(d,c,b){return a.tmpl(a.template(d),c,b,this)}function x(b,d){var c=b.options||{};c.wrapped=d;return a.tmpl(a.template(b.tmpl),b.data,c,b.item)}function v(d,c){var b=this._wrap;return a.map(a(a.isArray(b)?b.join(\"\"):b).filter(d||\"*\"),function(a){return c?a.innerText||a.textContent:a.outerHTML||s(a)})}function t(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]);a(b).remove()}})(jQuery)","'use strict';\n\n// Last time updated: 2019-02-20 3:31:30 PM UTC\n\n// _______________\n// getStats v1.2.0\n\n// Open-Sourced: https://github.com/muaz-khan/getStats\n\n// --------------------------------------------------\n// Muaz Khan     - www.MuazKhan.com\n// MIT License   - www.WebRTC-Experiment.com/licence\n// --------------------------------------------------\n\n\"use strict\";var getStats=function(mediaStreamTrack,callback,interval){function getStatsLooper(){getStatsWrapper(function(results){if(results&&results.forEach){results.forEach(function(result){Object.keys(getStatsParser).forEach(function(key){if(\"function\"==typeof getStatsParser[key])try{getStatsParser[key](result)}catch(e){console.error(e.message,e.stack,e)}})});try{peer.iceConnectionState.search(/failed|closed|disconnected/gi)!==-1&&(nomore=!0)}catch(e){nomore=!0}nomore===!0&&(getStatsResult.datachannel&&(getStatsResult.datachannel.state=\"close\"),getStatsResult.ended=!0),getStatsResult.results=results,getStatsResult.audio&&getStatsResult.video&&(getStatsResult.bandwidth.speed=getStatsResult.audio.bytesSent-getStatsResult.bandwidth.helper.audioBytesSent+(getStatsResult.video.bytesSent-getStatsResult.bandwidth.helper.videoBytesSent),getStatsResult.bandwidth.helper.audioBytesSent=getStatsResult.audio.bytesSent,getStatsResult.bandwidth.helper.videoBytesSent=getStatsResult.video.bytesSent),callback(getStatsResult),nomore||void 0!=typeof interval&&interval&&setTimeout(getStatsLooper,interval||1e3)}})}function getStatsWrapper(cb){\"undefined\"!=typeof window.InstallTrigger||isSafari?peer.getStats(window.mediaStreamTrack||null).then(function(res){var items=[];res.forEach(function(r){items.push(r)}),cb(items)})[\"catch\"](cb):peer.getStats(function(res){var items=[];res.result().forEach(function(res){var item={};res.names().forEach(function(name){item[name]=res.stat(name)}),item.id=res.id,item.type=res.type,item.timestamp=res.timestamp,items.push(item)}),cb(items)})}var browserFakeUserAgent=\"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45\";!function(that){that&&\"undefined\"==typeof window&&\"undefined\"!=typeof global&&(global.navigator={userAgent:browserFakeUserAgent,getUserMedia:function(){}},global.console||(global.console={}),\"undefined\"!=typeof global.console.log&&\"undefined\"!=typeof global.console.error||(global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),\"undefined\"==typeof document&&(that.document={documentElement:{appendChild:function(){return\"\"}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var obj={getContext:function(){return obj},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return\"\"}};return obj},that.HTMLVideoElement=function(){}),\"undefined\"==typeof location&&(that.location={protocol:\"file:\",href:\"\",hash:\"\"}),\"undefined\"==typeof screen&&(that.screen={width:0,height:0}),\"undefined\"==typeof URL&&(that.URL={createObjectURL:function(){return\"\"},revokeObjectURL:function(){return\"\"}}),\"undefined\"==typeof MediaStreamTrack&&(that.MediaStreamTrack=function(){}),\"undefined\"==typeof RTCPeerConnection&&(that.RTCPeerConnection=function(){}),that.window=global)}(\"undefined\"!=typeof global?global:null);var RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;\"undefined\"==typeof MediaStreamTrack&&(MediaStreamTrack={});var systemNetworkType=((navigator.connection||{}).type||\"unknown\").toString().toLowerCase(),getStatsResult={encryption:\"sha-256\",audio:{send:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},recv:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},bytesSent:0,bytesReceived:0,latency:0,packetsLost:0},video:{send:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},recv:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},bytesSent:0,bytesReceived:0,latency:0,packetsLost:0},bandwidth:{systemBandwidth:0,sentPerSecond:0,encodedPerSecond:0,helper:{audioBytesSent:0,videoBytestSent:0},speed:0},results:{},connectionType:{systemNetworkType:systemNetworkType,systemIpAddress:\"192.168.1.2\",local:{candidateType:[],transport:[],ipAddress:[],networkType:[]},remote:{candidateType:[],transport:[],ipAddress:[],networkType:[]}},resolutions:{send:{width:0,height:0},recv:{width:0,height:0}},internal:{audio:{send:{},recv:{}},video:{send:{},recv:{}},candidates:{}},nomore:function(){nomore=!0}},getStatsParser={checkIfOfferer:function(result){\"googLibjingleSession\"===result.type&&(getStatsResult.isOfferer=result.googInitiator)}},isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),peer=this;if(!(arguments[0]instanceof RTCPeerConnection))throw\"1st argument is not instance of RTCPeerConnection.\";peer=arguments[0],arguments[1]instanceof MediaStreamTrack&&(mediaStreamTrack=arguments[1],callback=arguments[2],interval=arguments[3]);var nomore=!1;getStatsParser.datachannel=function(result){\"datachannel\"===result.type&&(getStatsResult.datachannel={state:result.state})},getStatsParser.googCertificate=function(result){\"googCertificate\"==result.type&&(getStatsResult.encryption=result.googFingerprintAlgorithm),\"certificate\"==result.type&&(getStatsResult.encryption=result.fingerprintAlgorithm)},getStatsParser.checkAudioTracks=function(result){if(\"audio\"===result.mediaType){var sendrecvType=result.id.split(\"_\").pop();if(result.isRemote===!0&&(sendrecvType=\"recv\"),result.isRemote===!1&&(sendrecvType=\"send\"),sendrecvType){if(getStatsResult.audio[sendrecvType].codecs.indexOf(result.googCodecName||\"opus\")===-1&&getStatsResult.audio[sendrecvType].codecs.push(result.googCodecName||\"opus\"),result.bytesSent){var kilobytes=0;getStatsResult.internal.audio[sendrecvType].prevBytesSent||(getStatsResult.internal.audio[sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal.audio[sendrecvType].prevBytesSent;getStatsResult.internal.audio[sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult.audio[sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult.audio.bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal.audio[sendrecvType].prevBytesReceived||(getStatsResult.internal.audio[sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal.audio[sendrecvType].prevBytesReceived;getStatsResult.internal.audio[sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult.audio.bytesReceived=kilobytes.toFixed(1)}if(result.googTrackId&&getStatsResult.audio[sendrecvType].tracks.indexOf(result.googTrackId)===-1&&getStatsResult.audio[sendrecvType].tracks.push(result.googTrackId),result.googCurrentDelayMs){var kilobytes=0;getStatsResult.internal.audio.prevGoogCurrentDelayMs||(getStatsResult.internal.audio.prevGoogCurrentDelayMs=result.googCurrentDelayMs);var bytes=result.googCurrentDelayMs-getStatsResult.internal.audio.prevGoogCurrentDelayMs;getStatsResult.internal.audio.prevGoogCurrentDelayMs=result.googCurrentDelayMs,getStatsResult.audio.latency=bytes.toFixed(1),getStatsResult.audio.latency<0&&(getStatsResult.audio.latency=0)}if(result.packetsLost){var kilobytes=0;getStatsResult.internal.audio.prevPacketsLost||(getStatsResult.internal.audio.prevPacketsLost=result.packetsLost);var bytes=result.packetsLost-getStatsResult.internal.audio.prevPacketsLost;getStatsResult.internal.audio.prevPacketsLost=result.packetsLost,getStatsResult.audio.packetsLost=bytes.toFixed(1),getStatsResult.audio.packetsLost<0&&(getStatsResult.audio.packetsLost=0)}}}},getStatsParser.checkVideoTracks=function(result){if(\"video\"===result.mediaType){var sendrecvType=result.id.split(\"_\").pop();if(result.isRemote===!0&&(sendrecvType=\"recv\"),result.isRemote===!1&&(sendrecvType=\"send\"),sendrecvType){if(getStatsResult.video[sendrecvType].codecs.indexOf(result.googCodecName||\"VP8\")===-1&&getStatsResult.video[sendrecvType].codecs.push(result.googCodecName||\"VP8\"),result.bytesSent){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBytesSent||(getStatsResult.internal.video[sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal.video[sendrecvType].prevBytesSent;getStatsResult.internal.video[sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult.video[sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult.video.bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBytesReceived||(getStatsResult.internal.video[sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal.video[sendrecvType].prevBytesReceived;getStatsResult.internal.video[sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult.video.bytesReceived=kilobytes.toFixed(1)}if(result.googFrameHeightReceived&&result.googFrameWidthReceived&&(getStatsResult.resolutions[sendrecvType].width=result.googFrameWidthReceived,getStatsResult.resolutions[sendrecvType].height=result.googFrameHeightReceived),result.googFrameHeightSent&&result.googFrameWidthSent&&(getStatsResult.resolutions[sendrecvType].width=result.googFrameWidthSent,getStatsResult.resolutions[sendrecvType].height=result.googFrameHeightSent),result.googTrackId&&getStatsResult.video[sendrecvType].tracks.indexOf(result.googTrackId)===-1&&getStatsResult.video[sendrecvType].tracks.push(result.googTrackId),result.framerateMean){getStatsResult.bandwidth.framerateMean=result.framerateMean;var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevFramerateMean||(getStatsResult.internal.video[sendrecvType].prevFramerateMean=result.bitrateMean);var bytes=result.bytesSent-getStatsResult.internal.video[sendrecvType].prevFramerateMean;getStatsResult.internal.video[sendrecvType].prevFramerateMean=result.framerateMean,kilobytes=bytes/1024,getStatsResult.video[sendrecvType].framerateMean=bytes.toFixed(1)}if(result.bitrateMean){getStatsResult.bandwidth.bitrateMean=result.bitrateMean;var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBitrateMean||(getStatsResult.internal.video[sendrecvType].prevBitrateMean=result.bitrateMean);var bytes=result.bytesSent-getStatsResult.internal.video[sendrecvType].prevBitrateMean;getStatsResult.internal.video[sendrecvType].prevBitrateMean=result.bitrateMean,kilobytes=bytes/1024,getStatsResult.video[sendrecvType].bitrateMean=bytes.toFixed(1)}if(result.googCurrentDelayMs){var kilobytes=0;getStatsResult.internal.video.prevGoogCurrentDelayMs||(getStatsResult.internal.video.prevGoogCurrentDelayMs=result.googCurrentDelayMs);var bytes=result.googCurrentDelayMs-getStatsResult.internal.video.prevGoogCurrentDelayMs;getStatsResult.internal.video.prevGoogCurrentDelayMs=result.googCurrentDelayMs,getStatsResult.video.latency=bytes.toFixed(1),getStatsResult.video.latency<0&&(getStatsResult.video.latency=0)}if(result.packetsLost){var kilobytes=0;getStatsResult.internal.video.prevPacketsLost||(getStatsResult.internal.video.prevPacketsLost=result.packetsLost);var bytes=result.packetsLost-getStatsResult.internal.video.prevPacketsLost;getStatsResult.internal.video.prevPacketsLost=result.packetsLost,getStatsResult.video.packetsLost=bytes.toFixed(1),getStatsResult.video.packetsLost<0&&(getStatsResult.video.packetsLost=0)}}}},getStatsParser.bweforvideo=function(result){\"VideoBwe\"===result.type&&(getStatsResult.bandwidth.availableSendBandwidth=result.googAvailableSendBandwidth,getStatsResult.bandwidth.googActualEncBitrate=result.googActualEncBitrate,getStatsResult.bandwidth.googAvailableSendBandwidth=result.googAvailableSendBandwidth,getStatsResult.bandwidth.googAvailableReceiveBandwidth=result.googAvailableReceiveBandwidth,getStatsResult.bandwidth.googRetransmitBitrate=result.googRetransmitBitrate,getStatsResult.bandwidth.googTargetEncBitrate=result.googTargetEncBitrate,getStatsResult.bandwidth.googBucketDelay=result.googBucketDelay,getStatsResult.bandwidth.googTransmitBitrate=result.googTransmitBitrate)},getStatsParser.candidatePair=function(result){if(\"googCandidatePair\"===result.type||\"candidate-pair\"===result.type||\"local-candidate\"===result.type||\"remote-candidate\"===result.type){if(\"true\"==result.googActiveConnection){Object.keys(getStatsResult.internal.candidates).forEach(function(cid){var candidate=getStatsResult.internal.candidates[cid];candidate.ipAddress.indexOf(result.googLocalAddress)!==-1&&(getStatsResult.connectionType.local.candidateType=candidate.candidateType,getStatsResult.connectionType.local.ipAddress=candidate.ipAddress,getStatsResult.connectionType.local.networkType=candidate.networkType,getStatsResult.connectionType.local.transport=candidate.transport),candidate.ipAddress.indexOf(result.googRemoteAddress)!==-1&&(getStatsResult.connectionType.remote.candidateType=candidate.candidateType,getStatsResult.connectionType.remote.ipAddress=candidate.ipAddress,getStatsResult.connectionType.remote.networkType=candidate.networkType,getStatsResult.connectionType.remote.transport=candidate.transport)}),getStatsResult.connectionType.transport=result.googTransportType;var localCandidate=getStatsResult.internal.candidates[result.localCandidateId];localCandidate&&localCandidate.ipAddress&&(getStatsResult.connectionType.systemIpAddress=localCandidate.ipAddress);var remoteCandidate=getStatsResult.internal.candidates[result.remoteCandidateId];remoteCandidate&&remoteCandidate.ipAddress&&(getStatsResult.connectionType.systemIpAddress=remoteCandidate.ipAddress)}if(\"candidate-pair\"===result.type&&result.selected===!0&&result.nominated===!0&&\"succeeded\"===result.state)var localCandidate=getStatsResult.internal.candidates[result.remoteCandidateId],remoteCandidate=getStatsResult.internal.candidates[result.remoteCandidateId];if(\"local-candidate\"===result.type&&(getStatsResult.connectionType.local.candidateType=result.candidateType,getStatsResult.connectionType.local.ipAddress=result.ipAddress,getStatsResult.connectionType.local.networkType=result.networkType,getStatsResult.connectionType.local.transport=result.mozLocalTransport||result.transport),\"remote-candidate\"===result.type&&(getStatsResult.connectionType.remote.candidateType=result.candidateType,getStatsResult.connectionType.remote.ipAddress=result.ipAddress,getStatsResult.connectionType.remote.networkType=result.networkType,getStatsResult.connectionType.remote.transport=result.mozRemoteTransport||result.transport),isSafari){var sendrecvType=result.localCandidateId?\"send\":\"recv\";if(!sendrecvType)return;if(result.bytesSent){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBytesSent||(getStatsResult.internal.video[sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal.video[sendrecvType].prevBytesSent;getStatsResult.internal.video[sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult.video[sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult.video.bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBytesReceived||(getStatsResult.internal.video[sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal.video[sendrecvType].prevBytesReceived;getStatsResult.internal.video[sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult.video.bytesReceived=kilobytes.toFixed(1)}if(result.availableOutgoingBitrate){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevAvailableOutgoingBitrate||(getStatsResult.internal.video[sendrecvType].prevAvailableOutgoingBitrate=result.availableOutgoingBitrate);var bytes=result.availableOutgoingBitrate-getStatsResult.internal.video[sendrecvType].prevAvailableOutgoingBitrate;getStatsResult.internal.video[sendrecvType].prevAvailableOutgoingBitrate=result.availableOutgoingBitrate,kilobytes=bytes/1024,getStatsResult.video.availableOutgoingBitrate=kilobytes.toFixed(1)}if(result.availableIncomingBitrate){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevAvailableIncomingBitrate||(getStatsResult.internal.video[sendrecvType].prevAvailableIncomingBitrate=result.availableIncomingBitrate);var bytes=result.availableIncomingBitrate-getStatsResult.internal.video[sendrecvType].prevAvailableIncomingBitrate;getStatsResult.internal.video[sendrecvType].prevAvailableIncomingBitrate=result.availableIncomingBitrate,kilobytes=bytes/1024,getStatsResult.video.availableIncomingBitrate=kilobytes.toFixed(1)}}}};var LOCAL_candidateType={},LOCAL_transport={},LOCAL_ipAddress={},LOCAL_networkType={};getStatsParser.localcandidate=function(result){\"localcandidate\"!==result.type&&\"local-candidate\"!==result.type||result.id&&(LOCAL_candidateType[result.id]||(LOCAL_candidateType[result.id]=[]),LOCAL_transport[result.id]||(LOCAL_transport[result.id]=[]),LOCAL_ipAddress[result.id]||(LOCAL_ipAddress[result.id]=[]),LOCAL_networkType[result.id]||(LOCAL_networkType[result.id]=[]),result.candidateType&&LOCAL_candidateType[result.id].indexOf(result.candidateType)===-1&&LOCAL_candidateType[result.id].push(result.candidateType),result.transport&&LOCAL_transport[result.id].indexOf(result.transport)===-1&&LOCAL_transport[result.id].push(result.transport),result.ipAddress&&LOCAL_ipAddress[result.id].indexOf(result.ipAddress+\":\"+result.portNumber)===-1&&LOCAL_ipAddress[result.id].push(result.ipAddress+\":\"+result.portNumber),result.networkType&&LOCAL_networkType[result.id].indexOf(result.networkType)===-1&&LOCAL_networkType[result.id].push(result.networkType),getStatsResult.internal.candidates[result.id]={candidateType:LOCAL_candidateType[result.id],ipAddress:LOCAL_ipAddress[result.id],portNumber:result.portNumber,networkType:LOCAL_networkType[result.id],priority:result.priority,transport:LOCAL_transport[result.id],timestamp:result.timestamp,id:result.id,type:result.type},getStatsResult.connectionType.local.candidateType=LOCAL_candidateType[result.id],getStatsResult.connectionType.local.ipAddress=LOCAL_ipAddress[result.id],getStatsResult.connectionType.local.networkType=LOCAL_networkType[result.id],getStatsResult.connectionType.local.transport=LOCAL_transport[result.id])};var REMOTE_candidateType={},REMOTE_transport={},REMOTE_ipAddress={},REMOTE_networkType={};getStatsParser.remotecandidate=function(result){\"remotecandidate\"!==result.type&&\"remote-candidate\"!==result.type||result.id&&(REMOTE_candidateType[result.id]||(REMOTE_candidateType[result.id]=[]),REMOTE_transport[result.id]||(REMOTE_transport[result.id]=[]),REMOTE_ipAddress[result.id]||(REMOTE_ipAddress[result.id]=[]),REMOTE_networkType[result.id]||(REMOTE_networkType[result.id]=[]),result.candidateType&&REMOTE_candidateType[result.id].indexOf(result.candidateType)===-1&&REMOTE_candidateType[result.id].push(result.candidateType),result.transport&&REMOTE_transport[result.id].indexOf(result.transport)===-1&&REMOTE_transport[result.id].push(result.transport),result.ipAddress&&REMOTE_ipAddress[result.id].indexOf(result.ipAddress+\":\"+result.portNumber)===-1&&REMOTE_ipAddress[result.id].push(result.ipAddress+\":\"+result.portNumber),result.networkType&&REMOTE_networkType[result.id].indexOf(result.networkType)===-1&&REMOTE_networkType[result.id].push(result.networkType),getStatsResult.internal.candidates[result.id]={candidateType:REMOTE_candidateType[result.id],ipAddress:REMOTE_ipAddress[result.id],portNumber:result.portNumber,networkType:REMOTE_networkType[result.id],priority:result.priority,transport:REMOTE_transport[result.id],timestamp:result.timestamp,id:result.id,type:result.type},getStatsResult.connectionType.remote.candidateType=REMOTE_candidateType[result.id],getStatsResult.connectionType.remote.ipAddress=REMOTE_ipAddress[result.id],getStatsResult.connectionType.remote.networkType=REMOTE_networkType[result.id],getStatsResult.connectionType.remote.transport=REMOTE_transport[result.id])},getStatsParser.dataSentReceived=function(result){!result.googCodecName||\"video\"!==result.mediaType&&\"audio\"!==result.mediaType||(result.bytesSent&&(getStatsResult[result.mediaType].bytesSent=parseInt(result.bytesSent)),result.bytesReceived&&(getStatsResult[result.mediaType].bytesReceived=parseInt(result.bytesReceived)))},getStatsParser.inboundrtp=function(result){if(isSafari&&\"inbound-rtp\"===result.type){var mediaType=result.mediaType||\"audio\",sendrecvType=result.isRemote?\"recv\":\"send\";if(sendrecvType){if(result.bytesSent){var kilobytes=0;getStatsResult.internal[mediaType][sendrecvType].prevBytesSent||(getStatsResult.internal[mediaType][sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal[mediaType][sendrecvType].prevBytesSent;getStatsResult.internal[mediaType][sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult[mediaType][sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult[mediaType].bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived||(getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived;getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult[mediaType].bytesReceived=kilobytes.toFixed(1)}}}},getStatsParser.outboundrtp=function(result){if(isSafari&&\"outbound-rtp\"===result.type){var mediaType=result.mediaType||\"audio\",sendrecvType=result.isRemote?\"recv\":\"send\";if(sendrecvType){if(result.bytesSent){var kilobytes=0;getStatsResult.internal[mediaType][sendrecvType].prevBytesSent||(getStatsResult.internal[mediaType][sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal[mediaType][sendrecvType].prevBytesSent;getStatsResult.internal[mediaType][sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult[mediaType][sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult[mediaType].bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived||(getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived;getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult[mediaType].bytesReceived=kilobytes.toFixed(1)}}}},getStatsParser.track=function(result){if(isSafari&&\"track\"===result.type){var sendrecvType=result.remoteSource===!0?\"send\":\"recv\";result.frameWidth&&result.frameHeight&&(getStatsResult.resolutions[sendrecvType].width=result.frameWidth,getStatsResult.resolutions[sendrecvType].height=result.frameHeight)}};var SSRC={audio:{send:[],recv:[]},video:{send:[],recv:[]}};getStatsParser.ssrc=function(result){if(result.googCodecName&&(\"video\"===result.mediaType||\"audio\"===result.mediaType)&&\"ssrc\"===result.type){var sendrecvType=result.id.split(\"_\").pop();SSRC[result.mediaType][sendrecvType].indexOf(result.ssrc)===-1&&SSRC[result.mediaType][sendrecvType].push(result.ssrc),getStatsResult[result.mediaType][sendrecvType].streams=SSRC[result.mediaType][sendrecvType].length}},getStatsLooper()};\"undefined\"!=typeof module&&(module.exports=getStats),\"function\"==typeof define&&define.amd&&define(\"getStats\",[],function(){return getStats});","'use strict';\n\nconst Helper = (() => {\n  const avatarUrl = '../static/plugins/ep_profile_modal/static/img/user.png';\n  const hElements = [\n    'h1',\n    'h2',\n    'h3',\n    'h4',\n    'h5',\n    'h6',\n    '.h1',\n    '.h2',\n    '.h3',\n    '.h4',\n    '.h5',\n    '.h6',\n  ];\n\n  let ace = null;\n\n  const init = (context) => (ace = context.ace);\n\n  const getAvatarUrl = (userId) => {\n    if (!userId) return avatarUrl;\n    return `/static/getUserProfileImage/${userId}/${window.pad.getPadId()}?t=${new Date().getTime()}`;\n  };\n\n  const getValidUrl = function () {\n    const url =\n      arguments.length <= 0 || arguments[0] === undefined ? '' : arguments[0];\n\n    if (url === '') return '';\n    let newUrl = window.decodeURIComponent(url);\n    newUrl = newUrl.trim().replace(/\\s/g, '');\n\n    if (/^(:\\/\\/)/.test(newUrl)) {\n      return `http${newUrl}`;\n    }\n    if (!/^(f|ht)tps?:\\/\\//i.test(newUrl)) {\n      return `http://${newUrl}`;\n    }\n\n    return newUrl;\n  };\n\n  const getUserId = () => clientVars.userId || window.pad.getUserId();\n\n  const stopStreaming = (callback) => {\n    const stream = wrtcStore.localstream;\n    if (stream) {\n      stream.getTracks().forEach((track) => {\n        track.stop();\n        stream.removeTrack(track);\n      });\n      wrtcStore.localstream = null;\n      if (callback) callback();\n    }\n  };\n\n  const scrollDownToLastChatText = (selector) => {\n    const $element = $(selector);\n    if ($element.length <= 0 || !$element[0]) return true;\n    $element.animate(\n      { scrollTop: $element[0].scrollHeight },\n      { duration: 400, queue: false },\n    );\n  };\n\n  const getUserFromId = (userId) => {\n    const anonymousUser = { name: 'anonymous', userId, colorId: '#FFF' };\n    if (!window.pad || !window.pad.collabClient) return anonymousUser;\n    const result = window.pad.collabClient\n      .getConnectedUsers()\n      .filter((user) => user.userId === userId);\n    const user = result.length > 0 ? result[0] : anonymousUser;\n    return user;\n  };\n\n  const slugify = (text) => text\n    .toString()\n    .toLowerCase()\n    .trim()\n    .replace(/\\s+/g, '-') // Replace spaces with -\n    .replace(/&/g, '-and-') // Replace & with 'and'\n    .replace(/[^\\w\\-]+/g, '') // Remove all non-word chars\n    .replace(/\\--+/g, '-') // Replace multiple - with single -\n    .replace(/^-+/, '') // Trim - from start of text\n    .replace(/-+$/, ''); // Trim - from end of text\n\n  const $bodyAceOuter = () => $(document).find('iframe[name=\"ace_outer\"]')\n    .contents();\n\n  const createShareLink = (headerId, headerText = 'headerText') => `${window.location.origin + window.location.pathname}?header=${slugify(\n    headerText,\n  )}&id=${headerId}&target=video&join=true`;\n\n  const appendUserList = (roomInfo, selector) => {\n    if (!roomInfo.list) return true;\n    const $element =\n      typeof selector === 'string' ? $(document).find(selector) : selector;\n    $element.empty();\n    roomInfo.list.forEach((el) => {\n      const userInList = getUserFromId(el.userId) || {\n        colorId: '',\n        name: 'anonymous',\n        userId: '0000000',\n      };\n      const userName = userInList.name || 'anonymous';\n      $element.append(\n        `<li data-id=${el.userId} style='border-color: ${\n          userInList.colorId\n        }'><div class='avatar'><div title='${userName}' style=\"background: url('${getAvatarUrl(\n          el.userId,\n        )}') no-repeat 50% 50% ; background-size : cover;\"></div></div>${userName}</li>`,\n      );\n    });\n  };\n\n  // socketState: 'CLOSED', 'OPENED', 'DISCONNECTED'\n  // enable: plugin active/deactivate\n  const wrtcStore = {\n    enable: true,\n    userInRoom: false,\n    currentOpenRoom: null,\n    socketState: 'CLOSED',\n    localstream: null,\n    components: {\n      text: { init: false, open: false },\n      video: { init: false, open: false },\n      room: { init: false, open: false },\n      wrtc: { init: false, open: false },\n    },\n    rooms: new Map(),\n  };\n\n  const wrtcPubsub = {\n    events: {},\n    on: function on(eventName, fn) {\n      this.events[eventName] = this.events[eventName] || [];\n      this.events[eventName].push(fn);\n    },\n    off: function off(eventName, fn) {\n      if (this.events[eventName]) {\n        for (let i = 0; i < this.events[eventName].length; i++) {\n          if (this.events[eventName][i] === fn) {\n            this.events[eventName].splice(i, 1);\n            break;\n          }\n        }\n      }\n    },\n    emit: function emit(eventName) {\n      for (var _len = arguments.length, data = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        data[_key - 1] = arguments[_key];\n      }\n\n      if (this.events[eventName]) {\n        this.events[eventName].forEach((fn) => {\n          fn.apply(undefined, data);\n        });\n      }\n    },\n  };\n\n  // search the inlineAvatar in all over\n\n  /**\n   * @property ROOM\n   * @property TEXT\n   * @property VIDEO\n   * @property update\n   */\n  const inlineAvatar = {\n    ROOM: (headerId, room) => {\n      if (!clientVars.webrtc.displayInlineAvatar) return;\n\n      const inlineAvatarLimit = clientVars.webrtc.inlineAvatarLimit || 4;\n      let $element = $bodyAceOuter().find(\n        `#wbrtc_avatarCol .${headerId}.wrtcIconLine .wrtc_inlineAvatars`,\n      );\n\n      const offsetTop = findAceHeaderElement(headerId).offset.top() - 16;\n\n      if (!$element.length) {\n        const avatarBox = $('#wrtcLinesIcons').tmpl({ headerId, offsetTop });\n        $element = $bodyAceOuter().find('#wbrtc_avatarCol')\n          .append(avatarBox);\n        $element = $element.find(\n          `.${headerId}.wrtcIconLine .wrtc_inlineAvatars`,\n        );\n      }\n\n      const $videoInlineAvatarIcons = $bodyAceOuter().find(\n        '#wbrtc_avatarCol .wrtc_inlineAvatars',\n      );\n\n      $element.find('.avatar').remove();\n      Object.keys(room).forEach((key, index) => {\n        const userInList = getUserFromId(room[key].userId) || {\n          colorId: '',\n          name: 'anonymous',\n        };\n        if (userInList.userId) {\n          // if user avatar find in other room remove it\n          $videoInlineAvatarIcons\n            .find(`.avatar[data-id=\"${userInList.userId}\"]`)\n            .remove();\n\n          if (index < inlineAvatarLimit) {\n            const userName = userInList.name || 'anonymous';\n            const avatarURL = getAvatarUrl(userInList.userId);\n            $element.find('.avatarMore').hide();\n            $element.append(\n              `<div\n                class=\"avatar btn_roomHandler\"\n                data-join=\"null\" data-action=\"USERPROFILEMODAL\"\n                data-id=\"${userInList.userId}\"\n              >\n                <div\n                  title='${userName}'\n                  style=\"background: url('${avatarURL}') no-repeat 50% 50%;\n                  background-size : cover;\"\n                ></div>\n              </div>`,\n            );\n          } else {\n            $element\n              .find('.avatarMore')\n              .show()\n              .text(`+${index + 1 - inlineAvatarLimit}`);\n          }\n        }\n      });\n    },\n    VIDEO: (headerId, room) => {\n      const $element = $(document).find('#werc_toolbar .wrtc_inlineAvatars');\n      if (!clientVars.webrtc.displayInlineAvatar) {\n        $element.hide();\n        return;\n      }\n      $element.show();\n      $element.find('.avatar').remove();\n      inlineAvatar._append(room.list, $element);\n    },\n    _append: (list, $element) => {\n      const inlineAvatarLimit = clientVars.webrtc.inlineAvatarLimit || 4;\n      list.forEach((el, index) => {\n        const userInList = getUserFromId(el.userId) || {\n          colorId: '',\n          name: 'anonymous',\n        };\n        if (userInList.userId) {\n          if (index < inlineAvatarLimit) {\n            const userName = userInList.name || 'anonymous';\n            const avatarUrl = getAvatarUrl(userInList.userId);\n            $element.find('.avatarMore').hide();\n            $element.append(\n              `\n                <div\n                  class=\"avatar btn_roomHandler\"\n                  data-join=\"null\"\n                  data-action=\"USERPROFILEMODAL\"\n                  data-id=\"${userInList.userId}\"\n                >\n                  <div\n                    title='${userName}'\n                    style=\"background: url('${avatarUrl}') no-repeat 50% 50%;\n                    background-size : cover;\"\n                  ></div>\n                </div>`,\n            );\n          } else {\n            $element\n              .find('.avatarMore')\n              .show()\n              .text(`+${index + 1 - inlineAvatarLimit}`);\n          }\n        }\n      });\n    },\n    update: (userId, data) => {\n      if (!clientVars.webrtc.displayInlineAvatar) return;\n\n      const $roomBox = $bodyAceOuter().find('#wrtcVideoIcons .wrtc_inlineAvatars');\n      const $videoBox = $(document).find('#werc_toolbar .wrtc_inlineAvatars');\n\n      if ($roomBox) {\n        $roomBox.find(`.avatar[data-id=\"${userId}\"] img`).attr({\n          src: data.imageUrl,\n          title: data.userName,\n        });\n      }\n\n      if ($videoBox) {\n        $videoBox.find('.avatar img').attr({\n          src: data.imageUrl,\n          title: data.userName,\n        });\n      }\n    },\n  };\n\n  /**\n   * @param {boolean} state\n   */\n  wrtcPubsub.on('plugin enable', (state) => {\n    $bodyAceOuter()\n      .find('iframe')\n      .contents()\n      .find('#innerdocbody')\n      .find('.heading wrt-inline-icon')\n      .each((i, el) => {\n        el.shadowRoot.querySelector('.btn_roomHandler').style.display = state\n          ? 'flex'\n          : 'none';\n      });\n\n    Helper.$bodyAceOuter()\n      .find('#outerdocbody')\n      .find('#wbrtc_avatarCol')[0].style.display = state ? 'flex' : 'none';\n\n    // deactivate\n    if (!state) {\n      videoChat.userLeave(window.headerId, wrtcPubsub.currentOpenRoom, 'PLUS');\n      wrtcPubsub.currentOpenRoom = null;\n    }\n    wrtcStore.enable = state;\n  });\n\n  wrtcPubsub.on('update network information', () => {});\n\n  /**\n   * state (DISCONNECTED|OPENED)\n   */\n  wrtcPubsub.on('socket state', (state) => {\n    wrtcStore.socketState = state;\n    console.info(\n      '[wrtc]: socket state has been change, new state:',\n      state,\n      wrtcStore.userInRoom,\n      window.headerId,\n    );\n    if (state === 'OPENED' && wrtcStore.userInRoom) {\n      console.info('Try reconnecting...');\n      WRTC.attemptToReconnect();\n    }\n  });\n\n  /**\n   * @param {string}  name @enum(text|video|room|wrtc)\n   * @param {string}  flow @enum(init|open)\n   * @param {boolean} status @enum (true|false)\n   */\n  wrtcPubsub.on('componentsFlow', (name, flow, status) => {\n    wrtcStore.components[name][flow] = status;\n  });\n\n  wrtcPubsub.on('update inlineAvatar info', (userId, data) => {\n    if (clientVars.webrtc.displayInlineAvatar) inlineAvatar.update(userId, data);\n  });\n\n  wrtcPubsub.on('update store', (requestUser, headerId, action, target, roomInfo, callback) => {\n    if (!requestUser || !headerId || !action || !roomInfo || !target) return false;\n\n    if (!wrtcStore.rooms.has(headerId)) {\n      wrtcStore.rooms.set(headerId, {\n        VIDEO: { list: [] },\n        TEXT: { list: [] },\n        USERS: {},\n        headerCount: 0,\n      });\n    }\n\n    const room = wrtcStore.rooms.get(headerId);\n    let users = room.USERS;\n\n    room[target] = roomInfo;\n\n    // remove all users\n    users = {};\n\n    if (room.VIDEO.list) {\n      room.VIDEO.list.forEach((el) => {\n        if (!users[el.userId]) users[el.userId] = {};\n        users[el.userId] = el;\n      });\n    }\n\n    inlineAvatar[target](headerId, room[target]);\n    inlineAvatar.ROOM(headerId, users);\n\n    wrtcStore.rooms.set(headerId, room);\n\n    if (callback) callback(room);\n  },\n  );\n\n  wrtcPubsub.on('disable room buttons', (headerId, actions, target) => {\n    const btn = $('#header_videochat_icon')[0];\n    if (!btn) return;\n    btn.classList.add('activeLoader');\n    btn.setAttribute('disabled', true);\n  });\n\n  wrtcPubsub.on('enable room buttons', (headerId, action, target) => {\n    const btn = $('#header_videochat_icon')[0];\n    if (!btn) return;\n    const newAction = action === 'JOIN' ? 'LEAVE' : 'JOIN';\n    btn.removeAttribute('disabled');\n    btn.setAttribute('data-action', newAction);\n    btn.classList.remove('activeLoader');\n  });\n\n  wrtcPubsub.on('updateWrtcToolbarModal', (headerId, roomInfo) => {\n    // find toolbar attribute and update all of them.\n    // update toolbar title\n    // update inlineAvatar\n\n    const headerTile = findAceHeaderElement(headerId).text;\n\n    $('#wrtc_modal .btn_roomHandler, #werc_toolbar p').attr('data-id', headerId);\n    $('#wrtc_modal .nd_title .title').html(headerTile);\n  });\n\n  wrtcPubsub.on('updateWrtcToolbarTitleModal', (headerTile, headerId) => {\n    if (headerId === window.headerId) {\n      $(`#werc_toolbar .nd_title .titleb[data-id='${headerId}'`).html(headerTile);\n      $(document)\n        .find(`.wrtc_roomLink[data-id='${headerId}']`)\n        .text(headerTile);\n    }\n  });\n\n  const getHeaderRoomY = ($element) => {\n    if (!$element.length) return;\n    const height = $element.outerHeight();\n    const paddingTop = Helper.$bodyAceOuter()\n      .find('iframe[name=\"ace_inner\"]')\n      .css('padding-top');\n    const aceOuterPadding = parseInt(paddingTop, 10);\n    const offsetTop = Math.ceil($element.offset().top + aceOuterPadding);\n    return offsetTop + height / 2;\n  };\n\n  const getHeaderRoomX = ($element) => {\n    if (!$element.length) return;\n    const width = $element.outerWidth();\n    const paddingLeft = Helper.$bodyAceOuter()\n      .find('iframe[name=\"ace_inner\"]')\n      .css('padding-left');\n    const aceOuterPadding = parseInt(paddingLeft, 10);\n    const offsetLeft = Math.ceil(\n      Helper.$bodyAceOuter().find('iframe[name=\"ace_inner\"]')\n        .offset().left -\n        aceOuterPadding,\n    );\n    return offsetLeft - width - 6;\n  };\n\n  const findAceHeaderElement = (headerId) => {\n    const $el = $bodyAceOuter()\n      .find('iframe')\n      .contents()\n      .find('#innerdocbody')\n      .find(`.heading.${headerId}`);\n\n    return {\n      exist: $el.length,\n      $el,\n      text: $el.text(),\n      tag: $el.attr('data-htag'),\n      offset: {\n        top: () => getHeaderRoomY($el),\n        left: () => getHeaderRoomX($el),\n      },\n      $inlineIcon: () => $el.find('wrt-inline-icon').length\n        ? $el.find('wrt-inline-icon')[0].shadowRoot\n        : null,\n    };\n  };\n\n  return {\n    init,\n    hElements,\n    scrollDownToLastChatText,\n    getUserFromId,\n    slugify,\n    $bodyAceOuter,\n    createShareLink,\n    appendUserList,\n    wrtcStore,\n    wrtcPubsub,\n    getUserId,\n    stopStreaming,\n    getValidUrl,\n    findAceHeaderElement,\n    inlineAvatar,\n    getHeaderRoomY,\n  };\n})();\n","// CodecsHandler.js\n'use strict';\n\nvar CodecsHandler = (function () {\n  function preferCodec(sdp, codecName) {\n    const info = splitLines(sdp);\n\n    codecName = codecName.toLowerCase();\n\n    if (!info.videoCodecNumbers) {\n      return sdp;\n    }\n\n    if (codecName === 'vp8' && info.vp8LineNumber === info.videoCodecNumbers[0]) {\n      return sdp;\n    }\n\n    if (codecName === 'vp9' && info.vp9LineNumber === info.videoCodecNumbers[0]) {\n      return sdp;\n    }\n\n    if (codecName === 'h264' && info.h264LineNumber === info.videoCodecNumbers[0]) {\n      return sdp;\n    }\n\n    sdp = preferCodecHelper(sdp, codecName, info);\n\n    return sdp;\n  }\n\n  function preferCodecHelper(sdp, codec, info, ignore) {\n    let preferCodecNumber = '';\n\n    if (codec === 'vp8') {\n      if (!info.vp8LineNumber) {\n        return sdp;\n      }\n      preferCodecNumber = info.vp8LineNumber;\n    }\n\n    if (codec === 'vp9') {\n      if (!info.vp9LineNumber) {\n        return sdp;\n      }\n      preferCodecNumber = info.vp9LineNumber;\n    }\n\n    if (codec === 'h264') {\n      if (!info.h264LineNumber) {\n        return sdp;\n      }\n\n      preferCodecNumber = info.h264LineNumber;\n    }\n\n    let newLine = `${info.videoCodecNumbersOriginal.split('SAVPF')[0]}SAVPF `;\n\n    let newOrder = [preferCodecNumber];\n\n    if (ignore) {\n      newOrder = [];\n    }\n\n    info.videoCodecNumbers.forEach((codecNumber) => {\n      if (codecNumber === preferCodecNumber) return;\n      newOrder.push(codecNumber);\n    });\n\n    newLine += newOrder.join(' ');\n\n    sdp = sdp.replace(info.videoCodecNumbersOriginal, newLine);\n    return sdp;\n  }\n\n  function splitLines(sdp) {\n    const info = {};\n    sdp.split('\\n').forEach((line) => {\n      if (line.indexOf('m=video') === 0) {\n        info.videoCodecNumbers = [];\n        line.split('SAVPF')[1].split(' ').forEach((codecNumber) => {\n          codecNumber = codecNumber.trim();\n          if (!codecNumber || !codecNumber.length) return;\n          info.videoCodecNumbers.push(codecNumber);\n          info.videoCodecNumbersOriginal = line;\n        });\n      }\n\n      if (line.indexOf('VP8/90000') !== -1 && !info.vp8LineNumber) {\n        info.vp8LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\n      }\n\n      if (line.indexOf('VP9/90000') !== -1 && !info.vp9LineNumber) {\n        info.vp9LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\n      }\n\n      if (line.indexOf('H264/90000') !== -1 && !info.h264LineNumber) {\n        info.h264LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\n      }\n    });\n\n    return info;\n  }\n\n  function removeVPX(sdp) {\n    const info = splitLines(sdp);\n\n    // last parameter below means: ignore these codecs\n    sdp = preferCodecHelper(sdp, 'vp9', info, true);\n    sdp = preferCodecHelper(sdp, 'vp8', info, true);\n\n    return sdp;\n  }\n\n  function disableNACK(sdp) {\n    if (!sdp || typeof sdp !== 'string') {\n      throw 'Invalid arguments.';\n    }\n\n    sdp = sdp.replace('a=rtcp-fb:126 nack\\r\\n', '');\n    sdp = sdp.replace('a=rtcp-fb:126 nack pli\\r\\n', 'a=rtcp-fb:126 pli\\r\\n');\n    sdp = sdp.replace('a=rtcp-fb:97 nack\\r\\n', '');\n    sdp = sdp.replace('a=rtcp-fb:97 nack pli\\r\\n', 'a=rtcp-fb:97 pli\\r\\n');\n\n    return sdp;\n  }\n\n  function prioritize(codecMimeType, peer) {\n    if (!peer || !peer.getSenders || !peer.getSenders().length) {\n      return;\n    }\n\n    if (!codecMimeType || typeof codecMimeType !== 'string') {\n      throw 'Invalid arguments.';\n    }\n\n    peer.getSenders().forEach((sender) => {\n      const params = sender.getParameters();\n      for (let i = 0; i < params.codecs.length; i++) {\n        if (params.codecs[i].mimeType === codecMimeType) {\n          params.codecs.unshift(params.codecs.splice(i, 1));\n          break;\n        }\n      }\n      sender.setParameters(params);\n    });\n  }\n\n  function removeNonG722(sdp) {\n    return sdp.replace(/m=audio ([0-9]+) RTP\\/SAVPF ([0-9 ]*)/g, 'm=audio $1 RTP/SAVPF 9');\n  }\n\n  function setBAS(sdp, bandwidth, isScreen) {\n    if (!!navigator.mozGetUserMedia || !bandwidth) {\n      return sdp;\n    }\n\n    if (isScreen) {\n      if (!bandwidth.screen) {\n        console.warn('It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.');\n      } else if (bandwidth.screen < 300) {\n        console.warn('It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail.');\n      }\n    }\n\n    // if screen; must use at least 300kbs\n    if (bandwidth.screen && isScreen) {\n      sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\n      sdp = sdp.replace(/a=mid:video\\r\\n/g, `a=mid:video\\r\\nb=AS:${bandwidth.screen}\\r\\n`);\n    }\n\n    // remove existing bandwidth lines\n    if (bandwidth.audio || bandwidth.video || bandwidth.data) {\n      sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\n    }\n\n    if (bandwidth.audio) {\n      sdp = sdp.replace(/a=mid:audio\\r\\n/g, `a=mid:audio\\r\\nb=AS:${bandwidth.audio}\\r\\n`);\n    }\n\n    if (bandwidth.video) {\n      sdp = sdp.replace(/a=mid:video\\r\\n/g, `a=mid:video\\r\\nb=AS:${isScreen ? bandwidth.screen : bandwidth.video}\\r\\n`);\n    }\n\n    return sdp;\n  }\n\n  // Find the line in sdpLines that starts with |prefix|, and, if specified,\n  // contains |substr| (case-insensitive search).\n  function findLine(sdpLines, prefix, substr) {\n    return findLineInRange(sdpLines, 0, -1, prefix, substr);\n  }\n\n  // Find the line in sdpLines[startLine...endLine - 1] that starts with |prefix|\n  // and, if specified, contains |substr| (case-insensitive search).\n  function findLineInRange(sdpLines, startLine, endLine, prefix, substr) {\n    const realEndLine = endLine !== -1 ? endLine : sdpLines.length;\n    for (let i = startLine; i < realEndLine; ++i) {\n      if (sdpLines[i].indexOf(prefix) === 0) {\n        if (!substr || sdpLines[i].toLowerCase().indexOf(substr.toLowerCase()) !== -1) {\n          return i;\n        }\n      }\n    }\n    return null;\n  }\n\n  // Gets the codec payload type from an a=rtpmap:X line.\n  function getCodecPayloadType(sdpLine) {\n    const pattern = new RegExp('a=rtpmap:(\\\\d+) \\\\w+\\\\/\\\\d+');\n    const result = sdpLine.match(pattern);\n    return result && result.length === 2 ? result[1] : null;\n  }\n\n  function _setVideoBitrates(sdp, params) {\n    params = params || {};\n    const xgoogle_min_bitrate = params.min;\n    const xgoogle_max_bitrate = params.max;\n    const videoCodec = params.codec.toUpperCase() || 'VP8';\n\n    const sdpLines = sdp.split('\\r\\n');\n\n    // VP8\n    const vp8Index = findLine(sdpLines, 'a=rtpmap', `${videoCodec}/90000`);\n    let vp8Payload;\n    if (vp8Index) {\n      vp8Payload = getCodecPayloadType(sdpLines[vp8Index]);\n    }\n\n    if (!vp8Payload) {\n      return sdp;\n    }\n\n    const rtxIndex = findLine(sdpLines, 'a=rtpmap', 'rtx/90000');\n    let rtxPayload;\n    if (rtxIndex) {\n      rtxPayload = getCodecPayloadType(sdpLines[rtxIndex]);\n    }\n\n    if (!rtxIndex) {\n      return sdp;\n    }\n\n    const rtxFmtpLineIndex = findLine(sdpLines, `a=fmtp:${rtxPayload.toString()}`);\n    if (rtxFmtpLineIndex !== null) {\n      let appendrtxNext = '\\r\\n';\n      appendrtxNext += `a=fmtp:${vp8Payload} x-google-min-bitrate=${xgoogle_min_bitrate || '228'}; x-google-max-bitrate=${xgoogle_max_bitrate || '228'}`;\n      sdpLines[rtxFmtpLineIndex] = sdpLines[rtxFmtpLineIndex].concat(appendrtxNext);\n      sdp = sdpLines.join('\\r\\n');\n    }\n\n    return sdp;\n  }\n\n  function _setOpusAttributes(sdp, params) {\n    params = params || {};\n\n    const sdpLines = sdp.split('\\r\\n');\n\n    // Opus\n    const opusIndex = findLine(sdpLines, 'a=rtpmap', 'opus/48000');\n    let opusPayload;\n    if (opusIndex) {\n      opusPayload = getCodecPayloadType(sdpLines[opusIndex]);\n    }\n\n    if (!opusPayload) {\n      return sdp;\n    }\n\n    const opusFmtpLineIndex = findLine(sdpLines, `a=fmtp:${opusPayload.toString()}`);\n    if (opusFmtpLineIndex == null) {\n      return sdp;\n    }\n\n    let appendOpusNext = '';\n    appendOpusNext += `; stereo=${typeof params.stereo !== 'undefined' ? params.stereo : '1'}`;\n    appendOpusNext += `; sprop-stereo=${typeof params['sprop-stereo'] !== 'undefined' ? params['sprop-stereo'] : '1'}`;\n\n    if (typeof params.maxaveragebitrate !== 'undefined') {\n      appendOpusNext += `; maxaveragebitrate=${params.maxaveragebitrate || 128 * 1024 * 8}`;\n    }\n\n    if (typeof params.maxplaybackrate !== 'undefined') {\n      appendOpusNext += `; maxplaybackrate=${params.maxplaybackrate || 128 * 1024 * 8}`;\n    }\n\n    if (typeof params.cbr !== 'undefined') {\n      appendOpusNext += `; cbr=${typeof params.cbr !== 'undefined' ? params.cbr : '1'}`;\n    }\n\n    if (typeof params.useinbandfec !== 'undefined') {\n      appendOpusNext += `; useinbandfec=${params.useinbandfec}`;\n    }\n\n    if (typeof params.usedtx !== 'undefined') {\n      appendOpusNext += `; usedtx=${params.usedtx}`;\n    }\n\n    if (typeof params.maxptime !== 'undefined') {\n      appendOpusNext += `\\r\\na=maxptime:${params.maxptime}`;\n    }\n\n    sdpLines[opusFmtpLineIndex] = sdpLines[opusFmtpLineIndex].concat(appendOpusNext);\n\n    sdp = sdpLines.join('\\r\\n');\n    return sdp;\n  }\n\n  // forceStereoAudio => via webrtcexample.com\n  // requires getUserMedia => echoCancellation:false\n  function forceStereoAudio(sdp) {\n    const sdpLines = sdp.split('\\r\\n');\n    let fmtpLineIndex = null;\n    for (var i = 0; i < sdpLines.length; i++) {\n      if (sdpLines[i].search('opus/48000') !== -1) {\n        var opusPayload = extractSdp(sdpLines[i], /:(\\d+) opus\\/48000/i);\n        break;\n      }\n    }\n    for (var i = 0; i < sdpLines.length; i++) {\n      if (sdpLines[i].search('a=fmtp') !== -1) {\n        const payload = extractSdp(sdpLines[i], /a=fmtp:(\\d+)/);\n        if (payload === opusPayload) {\n          fmtpLineIndex = i;\n          break;\n        }\n      }\n    }\n    if (fmtpLineIndex == null) return sdp;\n    sdpLines[fmtpLineIndex] = sdpLines[fmtpLineIndex].concat('; stereo=1; sprop-stereo=1');\n    sdp = sdpLines.join('\\r\\n');\n    return sdp;\n  }\n\n  return {\n    removeVPX,\n    disableNACK,\n    prioritize,\n    removeNonG722,\n    setApplicationSpecificBandwidth: function setApplicationSpecificBandwidth(sdp, bandwidth, isScreen) {\n      return setBAS(sdp, bandwidth, isScreen);\n    },\n    setVideoBitrates: function setVideoBitrates(sdp, params) {\n      return _setVideoBitrates(sdp, params);\n    },\n    setOpusAttributes: function setOpusAttributes(sdp, params) {\n      return _setOpusAttributes(sdp, params);\n    },\n    preferVP9: function preferVP9(sdp) {\n      return preferCodec(sdp, 'vp9');\n    },\n    preferCodec,\n    forceStereoAudio,\n  };\n})();\n","'use strict';\n\nconst videoChat = (() => {\n  let socket = null;\n  let padId = null;\n  let currentRoom = {};\n  let VIDEOCHATLIMIT = 0;\n  let $joinBtn = null;\n  let networkInterval = null;\n  const pingos = {\n    startTime: 0,\n    latency: 0,\n    LMin: 0,\n    LMax: 0,\n    avg: 0,\n    LineAvg: [],\n    colors: {\n      normal: '#fff',\n      warning: '#ffcc00',\n      danger: '#cc3300',\n    },\n    interavCheck: 1000,\n  };\n\n  const startWatchNetwork = () => {\n    networkInterval = setInterval(() => {\n      pingos.startTime = Date.now();\n      socket.emit('pingil', padId, window.headerId, Helper.getUserId(), pingos.avg);\n    }, pingos.interavCheck);\n  };\n\n  const stopWatchNetwork = () => clearInterval(networkInterval);\n\n  const mediaDevices = () => {\n    navigator.mediaDevices.enumerateDevices().then((deviceInputs) => {\n      const videoSettings = localStorage.getItem('videoSettings');\n      const { microphone, speaker, camera } = JSON.parse(videoSettings);\n\n      const audioInputSection = document.querySelector('.select.audioSource select');\n      const audioOutputSection = document.querySelector('.select.audioOutputSec select');\n      const videoSection = document.querySelector('.select.videoSource select');\n\n      const audioInputElement = document.createElement('select');\n      const audioOutputElement = document.createElement('select');\n      const videoElement = document.createElement('select');\n\n      for (const deviceInfo of deviceInputs) {\n        const option = document.createElement('option');\n        const { deviceId, label, kind } = deviceInfo;\n        option.value = deviceId;\n        if (kind === 'audioinput') {\n          option.text = label || `microphone ${audioInputSection ? audioInputSection.length + 1 : '1'}`;\n          if (microphone === deviceId) option.selected = true;\n          audioInputElement.appendChild(option);\n        } else if (kind === 'audiooutput') {\n          option.text = label || `speaker ${audioOutputSection ? audioOutputSection.length + 1 : '1'}`;\n          if (speaker === deviceId) option.selected = true;\n          audioOutputElement.appendChild(option);\n        } else if (kind === 'videoinput') {\n          option.text = label || `camera ${videoSection ? videoSection.length + 1 : '1'}`;\n          if (camera === deviceId) option.selected = true;\n          videoElement.appendChild(option);\n        }\n      }\n\n      $(audioInputSection).remove();\n      $(audioOutputSection).remove();\n      $(videoSection).remove();\n\n      $('.select.audioSource').append(audioInputElement);\n      $('.select.audioOutputSec').append(audioOutputElement);\n      $('.select.videoSource').append(videoElement);\n    });\n  };\n\n  const isUserMediaAvailable = () => window.navigator.mediaDevices\n    .getUserMedia({ audio: true, video: true });\n\n  const removeUserFromRoom = (data, roomInfo, cb) => {\n    if (!data || !roomInfo || !data.userId) return false;\n    const headerId = data.headerId;\n    const headerTitle = Helper.findAceHeaderElement(headerId).text;\n\n    const userCount = roomInfo.present;\n    $(`.header_videochat_icon[data-id='${headerId}'] .icon .userCount`).text(userCount);\n\n    if (userCount === 0) $(`.header_videochat_icon[data-id='${headerId}'] .icon .userCount`).text('');\n\n    const user = Helper.getUserFromId(data.userId);\n\n    if (user && data.action !== 'JOIN' && data.action !== 'RELOAD') {\n      // notify, a user join the video-chat room\n      const msg = {\n        time: new Date(),\n        userId: data.userId || user.userId,\n        userName: data.name || user.name || 'anonymous',\n        headerId: data.headerId,\n        userCount,\n        headerTitle,\n        VIDEOCHATLIMIT,\n      };\n      $(`.header_videochat_icon[data-id='${headerId}'] .icon`).removeClass('active');\n    }\n\n    if (data.userId === clientVars.userId) {\n      Helper.$bodyAceOuter().find(`#wrtcVideoIcons #${headerId}`)\n        .removeClass('active');\n      WRTC.deactivate(data.userId, data.headerId);\n      stopWatchNetwork();\n      window.headerId = null;\n\n      const videoBtn = Helper.findAceHeaderElement(headerId).$inlineIcon();\n      if (videoBtn) videoBtn.querySelector('.btn_roomHandler').classList.remove('active');\n\n      currentRoom = {};\n\n      $('#wrtc_modal').css({\n        transform: 'translate(-50%, -100%)',\n        opacity: 0,\n      })\n        .attr({ 'data-active': false });\n\n      WRTC.deactivate(data.userId, data.headerId);\n\n      Helper.wrtcPubsub.emit('componentsFlow', 'video', 'open', false);\n\n      Helper.stopStreaming();\n      socket.removeListener(`receiveTextMessage:${data.headerId}`);\n    }\n\n    if (cb && typeof cb === 'function') cb();\n\n    Helper.wrtcPubsub.emit('update store', data, headerId, 'LEAVE', 'VIDEO', roomInfo);\n\n    Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n\n    WRTC.userLeave(data.userId);\n  };\n\n  const addUserToRoom = (data, roomInfo) => {\n    if (!data || !data.userId) return false;\n    const headerId = data.headerId;\n\n    const user = Helper.getUserFromId(data.userId);\n    // some user may session does exist but the user info does not available in all over the current pad\n    if (!user) return true;\n\n    // TODO: this is not good idea, use global state\n    // if incoming user has already in the room don't persuade the request\n    // if (IsUserInRooms) return false;\n    const userCount = roomInfo.present;\n\n    $(`.header_videochat_icon[data-id='${headerId}'] .icon .userCount`).text(userCount);\n    if (userCount === 0) $(`.header_videochat_icon[data-id='${headerId}'] .icon .userCount`).text('');\n\n    $(`.header_videochat_icon[data-id='${headerId}'] .icon`).addClass('active');\n\n    if (data.userId === clientVars.userId) {\n      window.headerId = data.headerId;\n\n      startWatchNetwork();\n\n      const videoBtn = Helper.findAceHeaderElement(headerId).$inlineIcon();\n      if (videoBtn) videoBtn.querySelector('.btn_roomHandler').classList.add('active');\n\n      WRTC.activate(data.headerId, user.userId);\n\n      $('#wrtc_modal').css({\n        transform: 'translate(-50%, 0)',\n        opacity: 1,\n      })\n        .attr({ 'data-active': true });\n\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'JOIN', $joinBtn);\n      Helper.wrtcPubsub.emit('componentsFlow', 'video', 'open', true);\n\n      // this request send once! and must be fire when the room is empty\n      if (!currentRoom.userId && roomInfo.present === 1) {\n        socket.emit('acceptNewCall', padId, window.headerId);\n      }\n\n      currentRoom = data;\n\n      // update modal title, attributes and inline avatar\n      Helper.wrtcPubsub.emit('updateWrtcToolbarModal', headerId, roomInfo);\n    }\n\n    Helper.wrtcPubsub.emit('update store', data, headerId, 'JOIN', 'VIDEO', roomInfo);\n  };\n\n  const createSession = (headerId, userInfo, $joinButton) => {\n    Helper.$bodyAceOuter().find('button.btn_joinChat_chatRoom')\n      .removeClass('active');\n    $joinBtn = $joinButton;\n    isUserMediaAvailable().then((stream) => {\n      // stop last stream\n      Helper.stopStreaming(() => {\n        Helper.wrtcStore.localstream = stream;\n      });\n\n      const participators = window.pad.collabClient.getConnectedUsers().map((x) => x.userId);\n\n      if (!currentRoom.userId) {\n        return socket.emit('userJoin', padId, participators, userInfo, 'video', gateway_userJoin);\n      }\n      // If the user has already joined the video chat, make suer leave that room then join to the new chat room\n      socket.emit('userLeave', padId, currentRoom, 'video', (_userData, roomInfo) => {\n        gateway_userLeave(_userData, roomInfo, () => {\n          socket.emit('userJoin', padId, participators, userInfo, 'video', gateway_userJoin);\n        });\n      });\n    })\n      .catch((err) => {\n        console.error(err);\n        Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n        Helper.wrtcPubsub.emit('componentsFlow', 'video', 'open', false);\n        Helper.stopStreaming();\n        socket.emit('userLeave', padId, currentRoom, 'video', (_userData, roomInfo) => {\n          gateway_userLeave(_userData, roomInfo);\n        });\n        WRTC.showUserMediaError(err, Helper.getUserId(), headerId);\n      });\n  };\n\n  const userJoin = (headerId, userInfo, $joinButton) => {\n    if (!userInfo || !userInfo.userId) {\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n      return false;\n    }\n\n    // check if has user already in the room\n    if (currentRoom && currentRoom.headerId === headerId) {\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n      return false;\n    }\n\n    createSession(headerId, userInfo, $joinButton);\n  };\n  // deprecate\n  const reloadCurrentSession = (headerId, userInfo, $joinButton) => {\n    if (!userInfo || !userInfo.userId) {\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n      return false;\n    }\n\n    createSession(headerId, userInfo, $joinButton, 'RELOAD');\n  };\n\n  const reloadSession = (headerId, userInfo, $joinButton) => {\n    if (!userInfo || !userInfo.userId) {\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n      return false;\n    }\n    socket.emit('reloadVideoSession', padId, headerId);\n  };\n\n  const userLeave = (headerId, data, $joinButton) => {\n    $joinBtn = $joinButton;\n    socket.emit('userLeave', padId, data, 'video', gateway_userLeave);\n  };\n\n  const reachedVideoRoomSize = (roomInfo, showAlert, isBulkUpdate) => {\n    if (roomInfo && roomInfo.present <= VIDEOCHATLIMIT) return true;\n\n    showAlert = showAlert || true;\n    if (showAlert && !isBulkUpdate) {\n      $.gritter.add({\n        title: 'Video chat Limitation',\n        text: `\n          The video chat room has reached its limit. \\r\\n\n          The size of this video chat room is ${VIDEOCHATLIMIT}.\n          (If this seems wrong, please share the problem with the support team.)\n        `,\n        sticky: false,\n        class_name: 'error',\n        time: '5000',\n      });\n    }\n\n    return false;\n  };\n\n  /**\n  *\n  * @param {Object} data @requires\n  * @param {String} data.padId @requires\n  * @param {String} data.userId @requires\n  * @param {String} data.userName @requires\n  * @param {String} data.headerId\n  *\n  * @param {Object} roomInfo\n  * @param {Boolean} showAlert\n  * @param {Boolean} bulkUpdate\n  *\n  * @returns\n  */\n  const gateway_userJoin = (data, roomInfo, showAlert = true, bulkUpdate = false) => {\n    console.info('[wrtc]: gateway user joining,', data, roomInfo, showAlert);\n    // If user data does not exist return false\n    if (!data) return reachedVideoRoomSize(null, false, false);\n\n    // if user data exist then check room size\n    if (data && reachedVideoRoomSize(roomInfo, showAlert, bulkUpdate)) {\n      return addUserToRoom(data, roomInfo);\n    } else if (bulkUpdate) {\n      return addUserToRoom(data, roomInfo);\n    }\n    Helper.stopStreaming();\n    return false;\n  };\n\n  const gateway_userLeave = (data, roomInfo, cb) => {\n    removeUserFromRoom(data, roomInfo, cb);\n  };\n\n  const postAceInit = (hookName, context, webSocket, docId) => {\n    socket = webSocket;\n    padId = docId;\n    VIDEOCHATLIMIT = 2000; // clientVars.webrtc.videoChatLimit;\n    Helper.wrtcPubsub.emit('componentsFlow', 'video', 'init', true);\n    // mediaDevices();\n\n    socket.on('userLatency', (data) => {\n      if (Helper.getUserId() !== data.userId) {\n        const videoId = `interface_video_${data.userId.replace(/\\./g, '_')}`;\n\n        let color = pingos.colors.normal;\n        if (data.latency > 200 && data.latency < 300) color = pingos.colors.warning;\n        if (data.latency > 300) color = pingos.colors.danger;\n\n        $(document)\n          .find(`#${videoId} .latency`)\n          .css({ color })\n          .text(`${Math.ceil(data.latency)}ms`);\n      }\n    });\n    socket.on('pongol', (data) => {\n      pingos.latency = Date.now() - pingos.startTime;\n\n      if (pingos.LMin <= pingos.latency && pingos.latency >= pingos.LMax) { pingos.LMax = pingos.latency; } else { pingos.LMin = pingos.latency; }\n\n      if (pingos.LineAvg.length < 4) {\n        pingos.LineAvg.push((pingos.LMax + pingos.LMin) / 2);\n      } else {\n        pingos.avg = pingos.LineAvg.reduce((a, b) => a + b) / pingos.LineAvg.length;\n        pingos.LineAvg = [];\n        pingos.LMax = 0;\n      }\n\n      let color = pingos.colors.normal;\n      if (pingos.avg > 200 && pingos.avg < 300) color = pingos.colors.warning;\n      if (pingos.avg > 300) color = pingos.colors.danger;\n\n      $(document)\n        .find('.video-container.local-user .latency')\n        .css({ color })\n        .text(`${Math.ceil(pingos.avg)}ms`);\n\n      // Helper.wrtcPubsub.emit('update network information', pingos);\n    });\n    socket.on('reloadVideoSession', (headerId) => {\n      if (currentRoom.headerId !== headerId) return false;\n      const target = 'PLUS';\n      const userInfo = {\n        padId: clientVars.padId || window.pad.getPadId(),\n        userId: clientVars.userId || window.pad.getUserId(),\n        userName: clientVars.userName || 'anonymous',\n        headerId,\n        target,\n        action: 'JOIN',\n      };\n      Helper.wrtcPubsub.emit('disable room buttons', headerId, 'JOIN', target);\n      createSession(headerId, userInfo, target);\n    });\n  };\n\n  return {\n    postAceInit,\n    userJoin,\n    userLeave,\n    gateway_userJoin,\n    gateway_userLeave,\n    reloadSession,\n    reloadCurrentSession,\n    mediaDevices,\n\n  };\n})();\n","'use strict';\n\nconst WrtcRoom = (() => {\n  let socket = null;\n  let padId = null;\n  let VIDEOCHATLIMIT = 0;\n  let tryToJoinByQueryString = 0;\n\n  /** --------- Helper --------- */\n\n  const scroll2Header = (headerId) => {\n    const padContainer = $('iframe[name=\"ace_outer\"]')\n      .contents()\n      .find('iframe')\n      .contents();\n    const header = padContainer.find(`.${headerId}`);\n    if (header.length === 0) return false;\n    header[0].scrollIntoView({\n      behavior: 'smooth',\n    });\n  };\n\n  const joinChatRoom = (headerId, userInfo, target) => {\n    videoChat.userJoin(headerId, userInfo, 'PLUS');\n  };\n\n  const leaveChatRoom = (headerId, userInfo, target) => {\n    videoChat.userLeave(headerId, userInfo, 'PLUS');\n  };\n\n  /**\n   *\n   * @param {string} actions @enum (JOIN|LEAVE|RELOAD|SHARELINK|USERPROFILEMODAL|JOINBYQUERY)\n   * @param {string} headerId\n   * @param {string} target @enum (chatRoom|video|text)\n   */\n  function roomBtnHandler(actions, headerId, target) {\n    if (typeof actions !== 'string') {\n      actions.preventDefault();\n      // no idea! but in some cases! this function fire twice!\n      // the first one has selector, but the second one has not any selector\n      if (!actions.handleObj.selector) return false;\n    }\n\n    headerId = $(this).attr('data-id') || headerId;\n    actions = $(this).attr('data-action') || actions;\n    target = $(this).attr('data-join') || target;\n\n    if (!headerId || !target) return true;\n\n    // If the plugin is disabled\n    if (!Helper.wrtcStore.enable) {\n      console.info('[wrtc]: Plugin disabled');\n      return;\n    }\n\n    const hasHref = $(this).attr('href');\n    // if the link belong to the other pad.\n    // navigate to the new pad\n    // TODO: URL should be sanitize and then decided to navigate\n    if (hasHref) {\n      const url = new URL(hasHref);\n      if (url.pathname !== location.pathname) window.location = hasHref;\n    }\n\n    const userInfo = {\n      padId: clientVars.padId || window.pad.getPadId(),\n      userId: clientVars.userId || window.pad.getUserId(),\n      userName: clientVars.userName || 'anonymous',\n      headerId,\n      target,\n      action: actions,\n    };\n    // Before handel request, check socket state\n    if (Helper.wrtcStore.socketState !== 'OPENED') {\n      // show the alert that user must reload the page\n      $.gritter.add({\n        title: 'Video chat no longer responds',\n        text: `\n          The socket is disconnected and we can no longer make a stable call,\n          please go to stable internet and then reload the page.\n        `,\n        sticky: false,\n        class_name: 'error',\n        time: '15000',\n      });\n      return false;\n    }\n\n    if (actions === 'JOIN') {\n      Helper.wrtcPubsub.currentOpenRoom = userInfo;\n      switch (target) {\n      case 'PLUS':\n        Helper.wrtcPubsub.emit(\n          'disable room buttons',\n          headerId,\n          actions,\n          target,\n        );\n        joinChatRoom(headerId, userInfo, target);\n        break;\n      case 'VIDEO':\n        Helper.wrtcPubsub.emit(\n          'disable room buttons',\n          headerId,\n          actions,\n          target,\n        );\n        videoChat.userJoin(headerId, userInfo, target);\n        break;\n      default:\n        return false;\n      }\n    } else if (actions === 'LEAVE') {\n      Helper.wrtcPubsub.currentOpenRoom = null;\n      switch (target) {\n      case 'PLUS':\n        leaveChatRoom(headerId, userInfo, target);\n        break;\n      case 'VIDEO':\n        videoChat.userLeave(headerId, userInfo, target);\n        break;\n      default:\n        return false;\n      }\n    } else if (actions === 'RELOAD') {\n      videoChat.reloadSession(headerId, userInfo, target, actions);\n    } else if (actions === 'SHARELINK') {\n      shareRoomsLink(headerId, target);\n    } else if (actions === 'USERPROFILEMODAL') {\n      showUserProfileModal(headerId);\n    } else if (actions === 'JOINBYQUERY') {\n      const href = $(this).attr('href');\n      joinByQueryString(href);\n    }\n  }\n\n  const joinByQueryString = (url) => {\n    url = url || window.location.href;\n    const urlParams = new URLSearchParams(url);\n    const headerId = urlParams.get('id');\n    let target = urlParams.get('target');\n    const join = urlParams.get('join');\n\n    if (!headerId) return true;\n\n    const inComeURL = new URL(url);\n    const inComePadName = inComeURL.pathname.split('/').pop();\n    const currentPadName = location.pathname.split('/').pop();\n\n    // check if header id belong to this pad\n    // then if it's not check padName\n\n    if (!Helper.wrtcStore.rooms.get(headerId)) {\n      if (inComePadName !== currentPadName) return (window.location.href = url);\n      $.gritter.add({\n        title: 'Error',\n        text: 'The header seems not to exist anymore!',\n        time: 3000,\n        sticky: false,\n        class_name: 'error',\n      });\n      return false;\n    }\n\n    if (headerId) scroll2Header(headerId);\n\n    if (join === 'true' && target) {\n      target = target.toUpperCase();\n\n      if (\n        Helper.wrtcStore.socketState === 'CLOSED' &&\n        tryToJoinByQueryString <= 4\n      ) {\n        setTimeout(() => {\n          console.warn(\n            `[wrtc]: socket state is ${Helper.wrtcStore.socketState}, try to join again!`,\n          );\n          tryToJoinByQueryString++;\n          joinByQueryString();\n        }, 1500);\n      } else if (Helper.wrtcStore.socketState === 'OPENED') {\n        setTimeout(() => roomBtnHandler('JOIN', headerId, target), 1000);\n      } else {\n        console.error(`\n          [wrtc]: We try to join ${tryToJoinByQueryString}th,\n          Joining by query string has problem!\n        `,\n        Helper.wrtcStore.socketState,\n        tryToJoinByQueryString,\n        );\n      }\n    }\n  };\n\n  // if history state has change fire joinQueryString\n  document.addEventListener('onPushState', (event) => {\n    const { state } = event.detail;\n    if (state.type === 'hyperLink') {\n      const href = state.href;\n      joinByQueryString(href);\n    }\n  });\n\n  function shareRoomsLink(headId, target) {\n    headId = $(this).attr('data-id') || headId;\n    target = $(this).attr('data-join') || target;\n    target = target.toLowerCase();\n\n    const title = Helper.$bodyAceOuter()\n      .find('iframe')\n      .contents()\n      .find('#innerdocbody')\n      .find(`.heading.${headerId}`)\n      .text();\n\n    const origin = window.location.origin;\n    const pathName = window.location.pathname;\n    const queryString = `header=${Helper.slugify(\n      title,\n    )}&id=${headId}&target=${target}&join=true`;\n    const link = `${origin + pathName}?${queryString}`;\n\n    const $temp = $('<input>');\n    $('body').append($temp);\n    $temp.val(link).select();\n    document.execCommand('copy');\n    $temp.remove();\n\n    $.gritter.add({\n      title: 'Copied',\n      text: 'Join link copied to clip board',\n      sticky: false,\n      class_name: 'copyLinkToClipboard',\n      time: '3000',\n    });\n  }\n\n  const getHeaderRoomY = ($element) => {\n    const height = $element.outerHeight();\n    const paddingTop = Helper.$bodyAceOuter()\n      .find('iframe[name=\"ace_inner\"]')\n      .css('padding-top');\n    const aceOuterPadding = parseInt(paddingTop, 10);\n    const offsetTop = Math.ceil($element.offset().top + aceOuterPadding);\n    return offsetTop + height / 2 - 22;\n  };\n\n  function showUserProfileModal(headerId) {\n    const userId = $(this).attr('data-id') || headerId;\n    const user = window.clientVars.ep_profile_list[userId];\n    if (!user) return false;\n    const staticImageURL = `/static/getUserProfileImage/${userId}/${padId}`;\n    const imageUrl = user.imageUrl || staticImageURL;\n    $('#ep_profile_users_profile_name').text(user.userName);\n    $('#ep_profile_users_profile_desc').text(user.about);\n    $('#ep_profile_users_profile_homepage').attr({\n      href: Helper.getValidUrl(user.homepage),\n      target: '_blank',\n    });\n\n    $('#ep_profile_users_profile').addClass('ep_profile_formModal_show');\n    $('#ep_profile_general_overlay').addClass(\n      'ep_profile_formModal_overlay_show',\n    );\n    $('#ep_profile_general_overlay').css({ display: 'block' });\n\n    $('#ep_profile_users_profile_userImage').css({\n      'background-position': '50% 50%',\n      'background-image': `url(${imageUrl})`,\n      'background-repeat': 'no-repeat',\n      'background-size': '69px',\n      'background-color': '#485365',\n    });\n  }\n\n  const activeEventListener = () => {\n    const $AceOuter = Helper.$bodyAceOuter();\n\n    $AceOuter.on('click', '.btn_roomHandler', roomBtnHandler);\n\n    $AceOuter\n      .find('iframe')\n      .contents()\n      .find('#innerdocbody')\n      .on('click', 'chat-inline-icon', function () {\n        const headerId = $(this).attr('data-headerid');\n        $(document)\n          .find('#header_videochat_icon')\n          .attr({\n            'data-action': 'JOIN',\n            'data-id': headerId,\n          });\n\n        $(document)\n          .find(`#tocItems .itemRow.tocItem[sectionid='${headerId}']`)\n          .trigger('click');\n      });\n\n    // integration with ep_rocketChat\n    $(document).on('click', '#toc .itemRow.tocItem', function () {\n      const headerId = $(this).attr('sectionid');\n      const room = Helper.wrtcStore.rooms.get(headerId);\n\n      // clear the button\n      $('.header_videochat_icon').attr('data-id', headerId);\n      $('.header_videochat_icon .icon').removeClass('active');\n      $('.header_videochat_icon .icon .userCount').text('');\n\n      // check wrtc store\n      const userPresent = room.VIDEO.present === 0 ? '' : room.VIDEO.present;\n      $('.header_videochat_icon .icon .userCount').text(userPresent);\n      // does the current user present in this room\n      const currentUserPresent = room.VIDEO.list.find(\n        (x) => x.userId === clientVars.userId,\n      );\n\n      if (currentUserPresent) $('.header_videochat_icon .icon').addClass('active');\n    });\n\n    $(document).on('click', '.btn_roomHandler, .wrtc_roomLink', roomBtnHandler);\n\n    $(document)\n      .on('mouseenter', '.video-container.local-user', () => {\n        $(document).find('#wrtc_modal #networkStatus')\n          .addClass('active');\n      })\n      .on('mouseleave', '.video-container.local-user', () => {\n        $(document).find('#wrtc_modal #networkStatus')\n          .removeClass('active');\n      });\n\n    $(document).on('click', '#werc_toolbar p',\n      function click() {\n        const headerId = $(this).attr('data-id');\n        scroll2Header(headerId);\n      },\n    );\n\n    $(document).on('click', '#werc_toolbar .btn_enlarge', function click() {\n      if (!$(this).attr('active')) return true;\n\n      $(this).toggleClass('large');\n\n      $('#wrtc_modal .video-container .enlarge-btn').each(function trigger() {\n        $(this).trigger('click');\n      });\n    });\n\n    // video interface settings\n    $(document).on('click', '#werc_toolbar .btn_videoSetting',\n      function click() {\n        const offset = $(this).position();\n        const $box = $(document).find('#wrtc_settings');\n        const width = $box.outerWidth();\n        $box\n          .css({ left: `${offset.left - width}px`, top: `${offset.top + 4}px` })\n          .toggleClass('active');\n      },\n    );\n  };\n\n  const self = {\n    joinByQueryString,\n    roomBtnHandler,\n    userLeave: (context, callback) => {\n      // Deprecated, we use socket disconnect\n    },\n    postAceInit: (hookName, context, webSocket, docId) => {\n      socket = webSocket;\n      padId = docId;\n      VIDEOCHATLIMIT = clientVars.webrtc.videoChatLimit;\n      Helper.wrtcPubsub.emit('componentsFlow', 'room', 'init', true);\n\n      socket.on('userJoin', (data, roomInfo, target) => {\n        videoChat.gateway_userJoin(data, roomInfo, false);\n      });\n\n      socket.on('userLeave', (data, roomInfo, target) => {\n        videoChat.gateway_userLeave(data, roomInfo, target);\n      });\n\n      activeEventListener();\n\n      // check if there is a join request in URI queryString\n      setTimeout(() => {\n        joinByQueryString();\n      }, 500);\n    },\n    adoptHeaderYRoom: () => {\n      // Set all video_heading to be inline with their target REP\n      const $padOuter = Helper.$bodyAceOuter();\n      if (!$padOuter) return;\n\n      // TODO: performance issue\n      $padOuter\n        .find('#wbrtc_avatarCol .wrtcIconLine')\n        .each(function adjustHeaderIconPosition() {\n          const $el = $(this);\n          const $headerId = $el.attr('id');\n          const $headingEl = Helper.findAceHeaderElement($headerId).$el;\n\n          // if the H tags does not find, remove chatBox\n          // TODO: and kick out the user form the chatBox\n          if ($headingEl.length <= 0) {\n            $el.remove();\n            return false;\n          }\n\n          $el.css({ top: `${Helper.getHeaderRoomY($headingEl) - 16}px` });\n        });\n    },\n    appendVideoIcon: (headerId, options = { createAgain: false }) => {\n      if (!headerId) return false;\n\n      const roomExist = Helper.wrtcStore.rooms.has(headerId);\n      if (!options.createAgain && roomExist) return false;\n\n      const $elRoomExist = Helper.findAceHeaderElement(headerId);\n\n      if (!roomExist && $elRoomExist.exist) {\n        const $el = Helper.$bodyAceOuter()\n          .find('iframe')\n          .contents()\n          .find('#innerdocbody')\n          .children('div')\n          .find(`.heading.${headerId}`);\n\n        const aceInnerOffset = Helper.$bodyAceOuter()\n          .find('iframe[name=\"ace_inner\"]')\n          .offset();\n\n        const target = Helper.$bodyAceOuter().find('#outerdocbody');\n        const newY = getHeaderRoomY($el);\n        const newX = Math.ceil(aceInnerOffset.left);\n        const lineNumber = $el.parent().parent()\n          .prevAll().length;\n\n        const data = {\n          headingTagId: headerId,\n          positionTop: newY,\n          positionLeft: newX,\n          headTitle: $el.text(),\n          lineNumber,\n          videoChatLimit: VIDEOCHATLIMIT,\n        };\n\n        Helper.wrtcStore.rooms.set(headerId, {\n          VIDEO: { list: [] },\n          USERS: {},\n          headerCount: 0,\n        });\n\n        const box = $('#wrtcLinesIcons').tmpl(data);\n        target.find('#wrtcVideoIcons').append(box);\n        // check the room that has user in there\n        // padId, headerId\n        socket.emit('getVideoRoomInfo', padId, headerId, (result) => {\n          if (result) Helper.inlineAvatar.ROOM(headerId, result);\n        });\n      }\n\n      self.adoptHeaderYRoom();\n    },\n    syncVideoAvatars: (headerId) => {\n      socket.emit('getVideoRoomInfo', padId, headerId, (result) => {\n        if (result) Helper.inlineAvatar.ROOM(headerId, result);\n      });\n    },\n  };\n\n  return self;\n})();\n","/**\n * Copyright 2013 j <j@mailb.org>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nconst WRTC = (() => {\n  const attemptReconnect = 60;\n  let reconnected = 0;\n  const videoSizes = { large: '260px', small: '160px' };\n  const pcConfig = {};\n  let audioInputSelect = null;\n  let videoSelect = null;\n  let audioOutputSelect = null;\n  const pcConstraints = {\n    optional: [{\n      DtlsSrtpKeyAgreement: true,\n    }],\n  };\n  const sdpConstraints = {\n    mandatory: {\n      OfferToReceiveAudio: true,\n      OfferToReceiveVideo: true,\n    },\n  };\n\n  const remoteStream = {};\n  const pc = {};\n  const callQueue = [];\n  const enlargedVideos = new Set();\n  let localVideoElement = null;\n  let padId = null;\n  let socket = null;\n\n  const self = {\n    // API HOOKS\n    postAceInit: (hookName, context, webSocket, docId) => {\n      padId = docId;\n      socket = webSocket;\n\n      if (!clientVars.webrtc) throw new Error('[wrtc]: webrtc settings not found');\n\n      pcConfig.iceServers = clientVars.webrtc.iceServers;\n\n      if (clientVars.webrtc.video.sizes.large) {\n        videoSizes.large = `${clientVars.webrtc.video.sizes.large}px`;\n      }\n      if (clientVars.webrtc.video.sizes.small) {\n        videoSizes.small = `${clientVars.webrtc.video.sizes.small}px`;\n      }\n\n      self._pad = context.pad || window.pad;\n\n      $(document).on('change', 'select#audioSource', self.audioVideoInputChange);\n      $(document).on('change', 'select#videoSource', self.audioVideoInputChange);\n      $(document).on('change', 'select#audioOutput', self.changeAudioDestination);\n\n      $(window).on('unload', () => {\n        console.info('[wrtc]: windos unloaded, now hangupAll');\n        self.hangupAll();\n      });\n      socket.on('RTC_MESSAGE', (context) => {\n        // filter RTC_message just for how is in headerId room\n        const payload = context.data.payload;\n        if (payload.to !== Helper.getUserId()) return;\n        if (payload.data.headerId === window.headerId) {\n          self.receiveMessage(context.data.payload);\n        }\n      });\n    },\n    appendVideoModalToBody: () => {\n      const $wrtcVideoModal = $('#wrtcVideoModal').tmpl({\n        videoChatLimit: clientVars.webrtc.videoChatLimit,\n        headerId: '',\n      });\n\n      $('body').prepend($wrtcVideoModal);\n\n      $(document).on('click', '#wrtc_modal .btn_toggle_modal', function () {\n        const $parent = $(this).parent()\n          .parent();\n        const action = $(this).attr('data-action');\n        const videoBox = $('#wrtc_modal .videoWrapper').innerHeight();\n\n        $(this).find('.fa_arrow-from-top')\n          .toggle();\n        $(this).find('.fa_arrow-to-top')\n          .toggle();\n\n        if (action === 'collapse') {\n          $(this).attr({ 'data-action': 'expand' });\n          $parent.find('.btn_enlarge').removeAttr('active');\n          $('#wrtc_modal').css({\n            transform: `translate(-50%, -${videoBox}px)`,\n          });\n        } else {\n          $(this).attr({ 'data-action': 'collapse' });\n          $parent.find('.btn_enlarge').attr({ active: true });\n          $('#wrtc_modal').css({\n            transform: 'translate(-50%, 0)',\n          });\n        }\n      });\n\n      $(document).on('click', '#wrtc_settings .btn_info', function click() {\n        const userID = Object.keys(pc);\n        const $this = $(this);\n        const isActive = $this.attr('data-active');\n        const $modal = $(document).find('#wrtc_settings .wrtc_info');\n\n        if (isActive) {\n          $modal.hide();\n          if (pc[userID[0]]) {\n            getStats(pc[userID[0]], (result) => {\n              result.nomore();\n            });\n          }\n          $this.removeAttr('data-active');\n          return true;\n        } else {\n          $this.attr({ 'data-active': true });\n          $modal.show();\n        }\n\n        if (pc[userID[0]] && !isActive) {\n          const bytesToSize = (bytes) => {\n            const k = 1000;\n            const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n            if (bytes <= 0) {\n              return '0 Bytes';\n            }\n            const i = parseInt(Math.floor(Math.log(bytes) / Math.log(k)), 10);\n\n            if (!sizes[i]) {\n              return '0 Bytes';\n            }\n\n            return `${(bytes / k ** i).toPrecision(3)} ${sizes[i]}`;\n          };\n\n          const getStats = (pc[userID[0]], (result) => {\n            const { video, audio, bandwidth, resolutions: { send, recv } } = result;\n            const statistic = {\n              speed: bytesToSize(bandwidth.speed),\n              systemNetworkType: result.connectionType.systemNetworkType,\n              availableSendBandwidth: bytesToSize(bandwidth.availableSendBandwidth),\n              video: {\n                'send.codecs': video.send.codecs.join(', '),\n                'resolutionsSend': `width ${send.width}, height ${send.height}`,\n                'resolutionsReceive': `width ${recv.width}, height ${recv.height}`,\n                'bytesSent': bytesToSize(video.bytesSent),\n                'bytesReceived': bytesToSize(video.bytesReceived),\n              },\n              audio: {\n                'send.codecs': audio.send.codecs.join(', '),\n                // \"recv.codecs\": result.audio.recv.codecs.join(\", \"),\n                'bytesSent': bytesToSize(audio.bytesSent),\n                'bytesReceived': bytesToSize(audio.bytesReceived),\n              },\n            };\n            $(document).find('#wrtc_settings .wrtc_info')\n              .html(`<pre>${JSON.stringify(statistic, undefined, 2)}</pre>`);\n          }, 1000);\n        }\n      });\n\n      $(document).on('click', '#wrtc_settings .btn_close', () => {\n        $('#wrtc_settings').toggleClass('active');\n        const $btnInfo = $('#wrtc_settings .btn_info');\n        if ($btnInfo.attr('data-active')) $btnInfo.trigger('click');\n      });\n    },\n    userLeave: (userId, context, callback) => {\n      userId = userId || context.userInfo.userId;\n      if (userId && pc[userId]) {\n        gState = 'LEAVING';\n        self.hide(userId);\n        self.hangup(userId, true);\n      }\n      Helper.wrtcStore.userInRoom = false;\n      if (callback) callback();\n    },\n    // deprecated function\n    handleClientMessage_RTC_MESSAGE: (hook, context) => {\n      if (context.payload.data.headerId === window.headerId) {\n        self.receiveMessage(context.payload);\n      }\n    },\n    // END OF API HOOKS\n    show: () => {\n      $('#pad_title').addClass('f_wrtcActive');\n      videoChat.mediaDevices();\n    },\n    showUserMediaError: (err, userId, headerId) => {\n      // show an error returned from getUserMedia\n      let reason;\n      // For reference on standard errors returned by getUserMedia:\n      // https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n      // However keep in mind that we add our own errors in getUserMediaPolyfill\n      console.error(`[wrtc]: mediaError, ${err}`);\n      switch (err.name) {\n      case 'CustomNotSupportedError':\n        reason = 'Sorry, your browser does not support WebRTC. (or you have it disabled in your settings).<br><br>' + 'To participate in this audio/video chat you have to user a browser with WebRTC support like Chrome, Firefox or Opera.' + '<a href=\"http://www.webrtc.org/\" target=\"_new\">Find out more</a>';\n        self.sendErrorStat('NotSupported');\n        break;\n      case 'CustomSecureConnectionError':\n        reason = 'Sorry, you need to install SSL certificates for your Etherpad instance to use WebRTC';\n        self.sendErrorStat('SecureConnection');\n        break;\n      case 'NotAllowedError':\n        // For certain (I suspect older) browsers, `NotAllowedError` indicates either an insecure connection or the user rejecting camera permissions.\n        // The error for both cases appears to be identical, so our best guess at telling them apart is to guess whether we are in a secure context.\n        // (webrtc is considered secure for https connections or on localhost)\n        if (location.protocol === 'https:' || location.hostname === 'localhost' || location.hostname === '127.0.0.1') {\n          reason = 'Sorry, you need to give us permission to use your camera and microphone';\n          self.sendErrorStat('Permission');\n        } else {\n          reason = 'Sorry, you need to install SSL certificates for your Etherpad instance to use WebRTC';\n          self.sendErrorStat('SecureConnection');\n        }\n        break;\n      case 'NotFoundError':\n        reason = \"Sorry, we couldn't find a suitable camera on your device. If you have a camera, make sure it set up correctly and refresh this website to retry.\";\n        self.sendErrorStat('NotFound');\n        break;\n      case 'NotReadableError':\n        // `err.message` might give useful info to the user (not necessarily useful for other error messages)\n        reason = `Sorry, a hardware error occurred that prevented access to your camera and/or microphone:<br><br>${err.message}`;\n        self.sendErrorStat('Hardware');\n        break;\n      case 'AbortError':\n        // `err.message` might give useful info to the user (not necessarily useful for other error messages)\n        reason = `Sorry, an error occurred (probably not hardware related) that prevented access to your camera and/or microphone:<br><br>${err.message}`;\n        self.sendErrorStat('Abort');\n        break;\n      default:\n        // `err` as a string might give useful info to the user (not necessarily useful for other error messages)\n        reason = `Sorry, there was an unknown Error:<br><br>${err}`;\n        self.sendErrorStat('Unknown');\n      }\n      $.gritter.add({\n        title: 'Error',\n        text: `${reason}; try again!`,\n        time: 4000,\n        sticky: false,\n        class_name: 'error',\n      });\n      userId = userId || clientVars.userId;\n      headerId = headerId || window.headerId;\n      videoChat.userLeave(headerId,\n        {\n          headerId,\n          padId,\n          userId,\n        },\n      );\n    },\n    hide: (userId) => {\n      if (!userId) return false;\n      userId = userId.split('.')[1];\n      $('#rtcbox').find(`#video_a_${userId}`)\n        .parent()\n        .remove();\n    },\n    activate: (headerId) => {\n      self.show();\n      self.hangupAll();\n      self.getUserMedia(headerId);\n      Helper.wrtcStore.userInRoom = true;\n    },\n    deactivate: (userId, headerId) => {\n      if (!userId) return false;\n      self.hide(userId);\n      self.hangupAll(headerId);\n      self.hangup(userId, true, headerId);\n      if (Helper.wrtcStore.localstream) Helper.stopStreaming();\n      Helper.wrtcStore.userInRoom = false;\n    },\n    toggleMuted: () => {\n      const audioTrack = Helper.wrtcStore.localstream.getAudioTracks()[0];\n      if (audioTrack) {\n        audioTrack.enabled = !audioTrack.enabled;\n        return !audioTrack.enabled; // returning \"Muted\" state, which is !enabled\n      }\n      return true; // if there's no audio track, it's muted\n    },\n    toggleVideo: () => {\n      const videoTrack = Helper.wrtcStore.localstream.getVideoTracks()[0];\n      if (videoTrack) {\n        videoTrack.enabled = !videoTrack.enabled;\n        return !videoTrack.enabled;\n      }\n    },\n    setStream: (userId, stream) => {\n      if (!userId) return false;\n      const isLocal = userId === Helper.getUserId();\n      const videoId = `video_${userId.replace(/\\./g, '_')}`;\n      let video = $(`#${videoId}`)[0];\n\n      const user = Helper.getUserFromId(userId);\n\n      if (!video && stream) {\n        const videoContainer = $(\"<div class='video-container'>\").css({\n          'width': videoSizes.small,\n          'max-height': videoSizes.small,\n        })\n          .appendTo($('#wrtc_modal .videoWrapper'));\n        const userName = user.name || 'anonymous';\n        videoContainer.append($('<div class=\"user-name\">').text(userName));\n\n        video = $('<video playsinline>').attr('id', videoId)\n          .css({\n            'border-color': user.colorId,\n            'width': videoSizes.small,\n            'max-height': videoSizes.small,\n          })\n          .on({\n            loadedmetadata: () => {\n              self.addInterface(userId);\n            },\n          })\n          .appendTo(videoContainer)[0];\n\n        video.autoplay = true;\n        if (isLocal) {\n          videoContainer.addClass('local-user');\n          video.muted = true;\n        }\n        self.addInterface(userId);\n      }\n      if (stream) {\n        attachMediaStream(video, stream);\n      } else if (video) {\n        $(video).parent()\n          .remove();\n      }\n    },\n    addInterface: (userId) => {\n      if (!userId) return false;\n      const isLocal = userId === Helper.getUserId();\n      const videoId = `video_${userId.replace(/\\./g, '_')}`;\n      const $video = $(`#${videoId}`);\n\n      const $mute = $(\"<span class='interface-btn audio-btn buttonicon'>\")\n        .attr('title', 'Mute')\n        .on({\n          click: () => {\n            let muted;\n            if (isLocal) {\n              muted = self.toggleMuted();\n            } else {\n              $video[0].muted = !$video[0].muted;\n              muted = $video[0].muted;\n            }\n            $mute.attr('title', muted ? 'Unmute' : 'Mute').toggleClass('muted', muted);\n          },\n        });\n\n      let videoEnabled = true;\n      let $disableVideo;\n      if (isLocal) {\n        $disableVideo = $(\"<span class='interface-btn video-btn buttonicon'>\")\n          .attr('title', 'Disable video')\n          .on('click', function () {\n            self.toggleVideo();\n            videoEnabled = !videoEnabled;\n            const title = videoEnabled ? 'Disable video' : 'Enable video';\n            $(this).attr('title', title)\n              .toggleClass('off', !videoEnabled);\n          });\n      }\n\n      let videoEnlarged = false;\n      const $largeVideo = $(\"<span class='interface-btn enlarge-btn buttonicon'>\")\n        .attr('title', 'Make video larger')\n        .on('click', function () {\n          videoEnlarged = !videoEnlarged;\n\n          if (videoEnlarged) {\n            enlargedVideos.add(userId);\n          } else {\n            enlargedVideos.delete(userId);\n          }\n\n          const title = videoEnlarged ? 'Make video smaller' : 'Make video larger';\n          $(this).attr('title', title)\n            .toggleClass('large', videoEnlarged);\n\n          const videoSize = $(document).find('#wrtc_modal .ndbtn.btn_enlarge')\n            .hasClass('large') ? videoSizes.large : videoSizes.small;\n\n          $video.parent().css({ 'width': videoSize, 'max-height': videoSize });\n          $video.css({ 'width': videoSize, 'max-height': videoSize });\n        });\n\n      if ($(document).find('#wrtc_modal .ndbtn.btn_enlarge')\n        .hasClass('large')) {\n        $video.parent().css({\n          'width': videoSizes.large, 'max-height': videoSizes.large,\n        });\n        $video.css({ 'width': videoSizes.large, 'max-height': videoSizes.large });\n      }\n\n      if (isLocal) localVideoElement = $video;\n\n      const $networkLatency = $(\"<div class='latency'></div>\");\n\n      $(`#interface_${videoId}`).remove();\n      $(\"<div class='interface-container'>\").attr('id', `interface_${videoId}`)\n        .append($mute)\n        .append($disableVideo)\n        .append($largeVideo)\n        .append($networkLatency)\n        .insertAfter($video);\n      self.changeAudioDestination();\n    },\n    // Sends a stat to the back end. `statName` must be in the\n    // approved list on the server side.\n    sendErrorStat: (statName) => {\n      const msg = { component: 'pad', type: 'STATS', data: { statName, type: 'RTC_MESSAGE' } };\n      socket.emit('acceptNewCall', padId, window.headerId);\n      socket.emit('message', msg);\n    },\n    sendMessage: (to, data, socketIdTo) => {\n      socket.emit('RTC_MESSAGE', {\n        type: 'RTC_MESSAGE',\n        payload: { data, to, padId, from: Helper.getUserId(), socket: { from: socket.id, to: socketIdTo } },\n      }, (data) => {\n        // console.log('coming data', data);\n      });\n      // deprecated function\n      // self._pad.collabClient.sendMessage({\n      // \ttype: 'RTC_MESSAGE',\n      //   payload: {data, to},\n      // });\n    },\n    receiveMessage: (msg) => {\n      const peer = msg.from; // userId\n      const data = msg.data;\n      const type = data.type;\n      if (peer === Helper.getUserId()) {\n        // console.info('ignore own messages');\n        return;\n      }\n      /*\n      if (type != 'icecandidate')\n        console.info('receivedMessage', 'peer', peer, 'type', type, 'data', data);\n      */\n      if (type === 'hangup') {\n        self.hangup(peer, true);\n      } else if (type === 'offer') {\n        if (pc[peer]) {\n          self.hangup(peer, true);\n          self.createPeerConnection(peer, data.headerId);\n        } else {\n          self.createPeerConnection(peer, data.headerId);\n        }\n        if (Helper.wrtcStore.localstream) {\n          if (pc[peer].getLocalStreams) {\n            if (!pc[peer].getLocalStreams().length) {\n              Helper.wrtcStore.localstream.getTracks().forEach((track) => {\n                pc[peer].addTrack(track, Helper.wrtcStore.localstream);\n              });\n\n              // pc[peer].addStream(localStream);\n            }\n          } else if (pc[peer].localStreams) {\n            if (!pc[peer].localStreams.length) {\n              Helper.wrtcStore.localstream.getTracks().forEach((track) => {\n                pc[peer].addTrack(track, Helper.wrtcStore.localstream);\n              });\n              // pc[peer].addStream(localStream);\n            }\n          }\n        }\n        const offer = new RTCSessionDescription(data.offer);\n        pc[peer].setRemoteDescription(offer, () => {\n          pc[peer].createAnswer((desc) => {\n            desc.sdp = cleanupSdp(desc.sdp);\n            pc[peer].setLocalDescription(desc, () => {\n              self.sendMessage(peer, { type: 'answer', answer: desc, headerId: data.headerId });\n            }, logError);\n          }, logError, sdpConstraints);\n        }, logError);\n      } else if (type === 'answer') {\n        if (pc[peer]) {\n          const answer = new RTCSessionDescription(data.answer);\n          pc[peer].setRemoteDescription(answer, () => {\n            // console.log(\"call setRemoteDescription\", new Date().getSeconds())\n          }, logError);\n        }\n      } else if (type === 'icecandidate') {\n        if (pc[peer]) {\n          const candidate = new RTCIceCandidate(data.candidate);\n          const p = pc[peer].addIceCandidate(candidate);\n          if (p) {\n            p.then(() => {\n              // Do stuff when the candidate is successfully passed to the ICE agent\n            }).catch(() => {\n              console.error('[wrtc]: Failure during addIceCandidate()', data);\n            });\n          }\n        }\n      } else {\n        console.error('[wrtc]: unknown message', data);\n      }\n    },\n    hangupAll: (_headerId) => {\n      Object.keys(pc).forEach((userId) => {\n        self.hangup(userId, true, _headerId);\n      });\n    },\n    hangup(userId, notify, headerId) {\n      notify = arguments.length === 1 ? true : notify;\n      if (pc[userId] && userId !== Helper.getUserId()) {\n        self.setStream(userId, '');\n        pc[userId].close();\n        delete pc[userId];\n        if (notify) self.sendMessage(userId, { type: 'hangup', headerId });\n      }\n    },\n    call: (userId, headerId) => {\n      // if (!localStream) {\n      //   callQueue.push(userId);\n      //   return;\n      // }\n      let constraints = { optional: [], mandatory: {} };\n      // temporary measure to remove Moz* constraints in Chrome\n      if (webrtcDetectedBrowser === 'chrome') {\n        for (const prop in constraints.mandatory) {\n          if (prop.indexOf('Moz') !== -1) {\n            delete constraints.mandatory[prop];\n          }\n        }\n      }\n      constraints = mergeConstraints(constraints, sdpConstraints);\n\n      if (!pc[userId]) self.createPeerConnection(userId, headerId);\n\n      // pc[userId].addStream(localStream);\n\n      Helper.wrtcStore.localstream.getTracks().forEach((track) => {\n        pc[userId].addTrack(track, Helper.wrtcStore.localstream);\n      });\n\n      pc[userId].createOffer((desc) => {\n        desc.sdp = cleanupSdp(desc.sdp);\n        pc[userId].setLocalDescription(desc, () => {\n          self.sendMessage(userId, { type: 'offer', offer: desc, headerId });\n        }, logError);\n      }, logError, constraints);\n    },\n    createPeerConnection: (userId, headerId) => {\n      if (pc[userId]) {\n        console.warn('WARNING creating PC connection even though one exists', userId);\n      }\n      pc[userId] = new RTCPeerConnection(pcConfig, pcConstraints);\n      pc[userId].onicecandidate = (event) => {\n        if (event.candidate) {\n          self.sendMessage(userId, {\n            type: 'icecandidate',\n            headerId,\n            candidate: event.candidate,\n          });\n        } else {\n          reconnected = 0;\n          socket.emit('acceptNewCall', padId, window.headerId);\n        }\n      };\n\n      pc[userId].oniceconnectionstatechange = () => {\n        console.info('[wrtc]: ICE state: ', pc[userId], pc[userId].iceConnectionState);\n\t\t \t};\n\n      pc[userId].ontrack = (event) => {\n        console.info(event, 'ontrack');\n        remoteStream[userId] = event.streams[0];\n        self.setStream(userId, event.streams[0]);\n      };\n\n      pc[userId].onremovestream = () => {\n        self.setStream(userId, '');\n      };\n    },\n    audioVideoInputChange: () => {\n      Helper.stopStreaming(() => {\n        self.getUserMedia(window.headerId);\n      });\n    },\n    attachSinkId: (element, sinkId) => {\n      // Attach audio output device to video element using device/sink ID.\n      if (element && element[0] && typeof element[0].sinkId !== 'undefined') {\n        element[0].setSinkId(sinkId).then(() => {\n          // console.info(`Success, audio output device attached: ${sinkId}`);\n        })\n          .catch((error) => {\n            let errorMessage = error;\n            if (error.name === 'SecurityError') {\n              errorMessage = `\n                You need to use HTTPS for selecting audio output device: ${error}\n              `;\n            }\n            console.error(errorMessage);\n            // Jump back to first output device in the list as it's the default.\n            audioOutputSelect.selectedIndex = 0;\n          });\n      } else {\n        console.warn('Browser does not support output device selection.');\n        $(document).find('#wrtc_settings .select.audioOutputSec')\n          .hide();\n      }\n    },\n    changeAudioDestination: () => {\n      const cls = '#wrtc_settings .select.audioOutputSec';\n      const audioOutputSelect = document.querySelector(cls);\n      const audioDestination = audioOutputSelect.value;\n      const videoElement = localVideoElement;\n      self.attachSinkId(videoElement, audioDestination);\n    },\n    getUserMedia: (headerId) => {\n      audioInputSelect = document.querySelector('#wrtc_settings .select.audioSource');\n      audioOutputSelect = document.querySelector('#wrtc_settings .select.audioOutputSec');\n      videoSelect = document.querySelector('#wrtc_settings .select.videoSource');\n\n      const audioSource = audioInputSelect ? audioInputSelect.value : undefined;\n      const videoSource = videoSelect ? videoSelect.value : undefined;\n      const audioOutput = audioOutputSelect ? audioOutputSelect.value : undefined;\n\n      const mediaConstraints = {\n        audio: true,\n        video: {\n          width: 320,\n          height: 240,\n          frameRate: { ideal: 15, max: 30 },\n          facingMode: 'user',\n        },\n      };\n\n      if (audioSource) {\n        mediaConstraints.audio.deviceId = { exact: audioSource };\n      }\n      if (videoSource) {\n        mediaConstraints.video.deviceId = { exact: videoSource };\n      }\n\n      const newSettings = {\n        microphone: audioSource,\n        speaker: audioOutput,\n        camera: videoSource,\n      };\n\n      localStorage.setItem('videoSettings', JSON.stringify(newSettings));\n      $('#wrtc_modal #networkError').removeClass('active')\n        .hide();\n\n      window.navigator.mediaDevices\n        .getUserMedia(mediaConstraints)\n        .then((stream) => {\n          Helper.wrtcStore.localstream = stream;\n          self.setStream(Helper.getUserId(), stream);\n          self._pad.collabClient.getConnectedUsers().forEach((user) => {\n            if (user.userId !== Helper.getUserId()) {\n              if (pc[user.userId]) {\n                self.hangup(user.userId, false, headerId);\n              }\n              self.call(user.userId, headerId);\n            }\n          });\n        })\n        .catch((err) => {\n          self.showUserMediaError(err, Helper.getUserId(), headerId);\n        });\n    },\n    attemptToReconnect: () => {\n      reconnected++;\n      console.info('[wrtc]: Try reconnecting', reconnected, attemptReconnect);\n      if (attemptReconnect <= reconnected) {\n        socket.emit('acceptNewCall', padId, window.headerId);\n        throw new Error('[wrtc]: please reload the video chat and try again to connect!');\n      }\n      setTimeout(() => {\n        console.info('[wrtc]: reconnecting...');\n        self.getUserMedia(window.headerId);\n      }, randomIntFromInterval(200, 1000));\n    },\n  };\n\n  // Normalize RTC implementation between browsers\n  // var getUserMedia = window.navigator.mediaDevices.getUserMedia\n  const attachMediaStream = (element, stream) => {\n    if (typeof element.srcObject !== 'undefined') {\n      element.srcObject = stream;\n    } else if (typeof element.mozSrcObject !== 'undefined') {\n      element.mozSrcObject = stream;\n    } else if (typeof element.src !== 'undefined') {\n      element.src = URL.createObjectURL(stream);\n    } else {\n      console.error('Error attaching stream to element.', element);\n    }\n  };\n\n  const webrtcDetectedBrowser = 'chrome';\n\n  const cleanupSdp = (sdp) => {\n    const bandwidth = {\n      screen: 300, // 300kbits minimum\n      audio: 256, // 64kbits  minimum\n      video: 500,\n      minVideo: 128, // 125kbits  min\n      maxVideo: 2048, // 125kbits  max\n      videoCodec: clientVars.webrtc.video.codec,\n    };\n\n    const isScreenSharing = false;\n\n    sdp = CodecsHandler.setApplicationSpecificBandwidth(sdp, bandwidth, isScreenSharing);\n    sdp = CodecsHandler.setVideoBitrates(sdp, {\n      min: bandwidth.minVideo,\n      max: bandwidth.maxVideo,\n      codec: bandwidth.videoCodec,\n    });\n    sdp = CodecsHandler.setOpusAttributes(sdp);\n    sdp = CodecsHandler.preferCodec(sdp, bandwidth.videoCodec);\n\n    return sdp;\n  };\n\n  const mergeConstraints = (cons1, cons2) => {\n    const merged = cons1;\n    for (const name in cons2.mandatory) {\n      merged.mandatory[name] = cons2.mandatory[name];\n    }\n    merged.optional.concat(cons2.optional);\n    return merged;\n  };\n\n  const randomIntFromInterval = (min, max) => Math.floor(Math.random() * (max - min + 1) + min);\n\n  const logError = (error) => {\n    // if (error && error.message.includes(\"Failed to set remote answer sdp\")) {\n    self.attemptToReconnect();\n    // } else {\n    // socket.emit('acceptNewCall', padId, window.headerId);\n    // }\n    console.error('[wrtc]: LogError:', error);\n    $('#wrtc_modal #networkError').show()\n      .addClass('active')\n      .text(`[wrtc]: Error: ${error} ,Reload the session.`);\n  };\n\n  self.pc = pc;\n  return self;\n})();\n"]}