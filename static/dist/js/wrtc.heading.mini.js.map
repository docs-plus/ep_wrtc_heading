{"version":3,"sources":["adapter.js","getUserMediaPolyfill.js","jquery.tmpl.min.js","getStats.min.js","helpers.js","copyPasteEvents.js","codecsHandler.js","textChat.js","videoChat.js","webrtcRoom.js","webrtc.js"],"names":["f","exports","module","define","amd","g","window","global","self","this","adapter","r","e","n","t","o","i","c","require","u","a","Error","code","p","call","length","1","adapterFactory","./adapter_factory.js","2","Object","defineProperty","value","_ref","arguments","undefined","options","shimChrome","shimFirefox","shimEdge","shimSafari","logging","utils","log","browserDetails","detectBrowser","commonShim","extractVersion","disableLog","disableWarnings","browser","chromeShim","shimPeerConnection","browserShim","shimGetUserMedia","shimMediaStream","shimOnTrack","shimAddTrackRemoveTrack","shimGetSendersWithDtmf","shimGetStats","shimSenderReceiverGetStats","fixNegotiationNeeded","shimRTCIceCandidate","shimConnectionState","shimMaxMessageSize","shimSendThrowTypeError","removeAllowExtmapMixed","firefoxShim","shimRemoveStream","shimSenderGetStats","shimReceiverGetStats","shimRTCDataChannel","edgeShim","shimGetDisplayMedia","shimReplaceTrack","safariShim","shimRTCIceServerUrls","shimCreateOfferLegacy","shimCallbacksAPI","shimLocalStreamsAPI","shimRemoteStreamsAPI","shimTrackEventTransceiver","_interopRequireWildcard","obj","__esModule","newObj","key","prototype","hasOwnProperty","default","./chrome/chrome_shim","./common_shim","./edge/edge_shim","./firefox/firefox_shim","./safari/safari_shim","./utils","3","_typeof","Symbol","iterator","constructor","_getusermedia","enumerable","get","_getdisplaymedia","MediaStream","webkitMediaStream","RTCPeerConnection","_ontrack","set","removeEventListener","addEventListener","configurable","origSetRemoteDescription","setRemoteDescription","_this","_ontrackpoly","stream","te","receiver","getReceivers","find","track","id","event","Event","transceiver","streams","dispatchEvent","getTracks","forEach","apply","wrapPeerConnectionEvent","shimSenderWithDtmf","pc","dtmf","_dtmf","kind","createDTMFSender","_pc","getSenders","_senders","slice","origAddTrack","addTrack","sender","push","origRemoveTrack","removeTrack","idx","indexOf","splice","origAddStream","addStream","_this2","origRemoveStream","removeStream","_this3","s","RTCRtpSender","origGetSenders","_this4","senders","origGetStats","getStats","_this5","_arguments","Array","selector","onSucc","onErr","fixChromeStats_","response","standardReport","result","report","standardStats","timestamp","type","localcandidate","remotecandidate","names","name","stat","makeMapStats","stats","Map","keys","map","successCallbackWrapper_","Promise","resolve","reject","then","RTCRtpReceiver","_this6","filterStats","origGetReceivers","_this7","receivers","srcElement","MediaStreamTrack","err","DOMException","shimAddTrackRemoveTrackWithNative","version","origGetLocalStreams","getLocalStreams","_this11","nativeStreams","_reverseStreams","_this12","_streams","newStream","replaceInternalStreamId","description","sdp","internalId","externalStream","internalStream","replace","RegExp","RTCSessionDescription","replaceExternalStreamId","_this13","signalingState","alreadyExists","oldStream","method","nativeMethod","methodObj","_defineProperty","_this14","args","isLegacyCall","desc","origSetLocalDescription","setLocalDescription","origLocalDescription","getOwnPropertyDescriptor","_this15","streamid","webkitRTCPeerConnection","RTCIceCandidate","nativeAddIceCandidate","addIceCandidate","candidate","target","writable","_this8","_shimmedLocalStreams","streamId","_this9","existingSenders","newSenders","filter","newSender","concat","_this10","../utils.js","./getdisplaymedia","./getusermedia","4","getSourceId","navigator","mediaDevices","console","error","getDisplayMedia","constraints","sourceId","widthSpecified","video","width","heightSpecified","height","frameRateSpecified","frameRate","mandatory","chromeMediaSource","chromeMediaSourceId","maxFrameRate","maxWidth","maxHeight","getUserMedia","5","constraintsToChrome_","optional","cc","ideal","exact","min","max","oldname_","prefix","charAt","toUpperCase","oc","mix","advanced","shimConstraints_","func","JSON","parse","stringify","audio","remap","b","face","facingMode","getSupportedFacingModeLies","getSupportedConstraints","matches","enumerateDevices","devices","dev","d","some","match","label","toLowerCase","includes","deviceId","shimError_","PermissionDeniedError","PermissionDismissedError","InvalidStateError","DevicesNotFoundError","ConstraintNotSatisfiedError","TrackStartError","MediaDeviceFailedDueToShutdown","MediaDeviceKillSwitchOn","TabCaptureError","ScreenCaptureError","DeviceCaptureError","message","constraint","constraintName","toString","onSuccess","onError","webkitGetUserMedia","bind","origGetUserMedia","cs","getAudioTracks","getVideoTracks","stop","6","NativeRTCIceCandidate","substr","nativeCandidate","parsedCandidate","_sdp2","parseCandidate","augmentedCandidate","assign","toJSON","sdpMid","sdpMLineIndex","usernameFragment","_sctp","sctpInDescription","sections","splitSections","shift","mediaSection","mLine","parseMLine","protocol","getRemoteFirefoxVersion","parseInt","getCanSendMaxMessageSize","remoteIsFirefox","canSendMaxMessageSize","getMaxMessageSize","maxMessageSize","matchPrefix","getConfiguration","sdpSemantics","isFirefox","canSendMMS","remoteMMS","Number","POSITIVE_INFINITY","Math","sctp","wrapDcSend","dc","origDataChannelSend","send","data","size","byteLength","readyState","TypeError","origCreateDataChannel","createDataChannel","dataChannel","channel","proto","completed","checking","iceConnectionState","_onconnectionstatechange","cb","origMethod","_connectionstatechangepoly","_lastConnectionState","connectionState","newEvent","nativeSRD","split","line","trim","join","_sdp","7","RTCIceGatherer","origMSTEnabled","ev","enabled","RTCDtmfSender","RTCDTMFSender","RTCPeerConnectionShim","_rtcpeerconnectionShim2","config","iceServers","_filtericeservers","filterIceServers","replaceTrack","setTrack","_rtcpeerconnectionShim","../utils","./filtericeservers","rtcpeerconnection-shim","8","edgeVersion","hasTurn","server","urls","url","deprecated","isString","validTurn","startsWith","9","10","catch","11","RTCTrackEvent","mozRTCPeerConnection","modernStatsTypes","inboundrtp","outboundrtp","candidatepair","nativeGetStats","DataChannel","RTCDataChannel","12","preferredMediaSource","mediaSource","13","nativeGetUserMedia","getSettings","nativeGetSettings","applyConstraints","nativeApplyConstraints","14","_localStreams","_addTrack","index","tracks","getRemoteStreams","_remoteStreams","_onaddstream","_onaddstreampoly","origCreateOffer","createOffer","origCreateAnswer","createAnswer","successCallback","failureCallback","promise","withCallback","_getUserMedia","shimConstraints","errcb","OrigPeerConnection","pcConfig","pcConstraints","newIceServers","generateCertificate","offerOptions","offerToReceiveAudio","audioTransceiver","getTransceivers","direction","setDirection","addTransceiver","offerToReceiveVideo","videoTransceiver","compactObject","15","eventNameToWrap","wrapper","nativeAddEventListener","nativeEventName","wrappedCallback","modifiedEvent","_eventMap","nativeRemoveEventListener","unwrappedCb","bool","logDisabled_","deprecationWarnings_","oldMethod","newMethod","warn","mozGetUserMedia","userAgent","isSecureContext","supportsUnifiedPlan","RTCRtpTransceiver","isObject","reduce","accumulator","isObj","isEmptyObject","walkStats","outbound","streamStatsType","filteredResult","trackStats","trackIdentifier","trackStat","trackId","uastring","expr","pos","val","base","resultSet","has","endsWith","16","SDPUtils","writeMediaSection","caps","dtlsRole","writeRtpDescription","writeIceParameters","iceGatherer","getLocalParameters","writeDtlsParameters","dtlsTransport","mid","rtpSender","rtpReceiver","_initialTrackId","msid","sendEncodingParameters","ssrc","rtx","localCName","getCommonCapabilities","localCapabilities","remoteCapabilities","commonCapabilities","codecs","headerExtensions","fecMechanisms","findCodecByPayloadType","pt","payloadType","preferredPayloadType","rtxCapabilityMatches","lRtx","rRtx","lCodecs","rCodecs","lCodec","parameters","apt","rCodec","clockRate","numChannels","rtcpFeedback","fb","j","parameter","lHeaderExtension","rHeaderExtension","uri","isActionAllowedInSignalingState","action","offer","answer","maybeAddCandidate","iceTransport","alreadyAdded","getRemoteCandidates","remoteCandidate","foundation","ip","port","priority","addRemoteCandidate","makeError","NotSupportedError","InvalidAccessError","OperationError","addTrackToStreamAndFireEvent","MediaStreamTrackEvent","fireAddTrack","trackEvent","setTimeout","_dispatchEvent","_eventTarget","document","createDocumentFragment","canTrickleIceCandidates","needNegotiation","localStreams","remoteStreams","_localDescription","_remoteDescription","iceGatheringState","usingBundle","bundlePolicy","rtcpMuxPolicy","iceTransportPolicy","_iceGatherers","iceCandidatePoolSize","gatherPolicy","_config","transceivers","_sdpSessionId","generateSessionId","_sdpSessionVersion","_dtlsRole","_isClosed","[object Object]","onicecandidate","onaddstream","ontrack","onremovestream","onsignalingstatechange","oniceconnectionstatechange","onconnectionstatechange","onicegatheringstatechange","onnegotiationneeded","ondatachannel","_emitGatheringStateChange","_createTransceiver","doNotAdd","hasBundleTransport","recvEncodingParameters","associatedRemoteMediaStreams","wantReceive","transports","_createIceAndDtlsTransports","_maybeFireNegotiationNeeded","clonedStream","clone","clonedTrack","_createIceGatherer","bufferedCandidateEvents","bufferCandidates","end","state","_gather","onlocalcandidate","evt","cand","component","ufrag","serializedCandidate","writeCandidate","getMediaSections","getDescription","complete","every","RTCIceTransport","onicestatechange","_updateIceConnectionState","_updateConnectionState","RTCDtlsTransport","ondtlsstatechange","onerror","_disposeIceAndDtlsTransports","_transceive","recv","params","encodings","rtcp","cname","compound","rtcpParameters","receive","sessionpart","parseRtpParameters","isIceLite","isRejected","rejected","remoteIceParameters","getIceParameters","remoteDtlsParameters","getDtlsParameters","role","start","_updateSignalingState","receiverList","iceOptions","lines","splitLines","getKind","getDirection","remoteMsid","parseMsid","getMid","generateIdentifier","parseRtpEncodingParameters","parseRtcpParameters","isComplete","cands","setTransport","setRemoteCandidates","getCapabilities","codec","isNewTrack","nativeTrack","removeTrackFromStreamAndFireEvent","sid","item","close","newState","states","new","closed","connected","disconnected","failed","connecting","numAudioTracks","numVideoTracks","writeSessionBoilerplate","remoteCodec","hdrExt","rHdrExt","getLocalCandidates","mediaSectionsInOffer","localTrack","reducedSize","candidateString","senderOrReceiver","promises","all","allStats","results","ortcObjectName","nativeGetstats","nativeStats","mapStats","methods","17","random","blob","part","parts","substring","address","relatedAddress","relatedPort","tcpType","parseIceOptions","parseRtpMap","parsed","channels","writeRtpMap","parseExtmap","writeExtmap","headerExtension","preferredId","parseFmtp","kv","writeFmtp","param","parseRtcpFb","writeRtcpFb","parseSsrcMedia","sp","colon","attribute","parseSsrcGroup","semantics","ssrcs","parseFingerprint","algorithm","fingerprints","setupType","fp","password","mline","rtpmapline","fmtps","maxptime","extension","encodingParameters","hasRed","hasUlpfec","primarySsrc","secondarySsrc","flows","encParam","codecPayloadType","fec","mechanism","bandwidth","maxBitrate","remoteSsrc","rsize","mux","spec","planB","msidParts","sessId","sessVer","sessUser","sessionId","fmt","parseOLine","username","sessionVersion","netType","addressType","isValidSDP","msGetUserMedia","fn","domManip","q","h","l","_wrap","tmpl","parent","nodes","calls","nest","w","wrap","x","html","v","update","extend","_ctnt","m","createElement","innerHTML","makeArray","childNodes","Function","tag","_default","test","k","$1","$2","isArray","nodeType","getElementsByTagName","getAttribute","parentNode","removeAttribute","pop","_","template","wrapped","innerText","textContent","outerHTML","appendChild","cloneNode","insertBefore","remove","each","appendTo","prependTo","insertAfter","replaceAll","pushStack","tmplItem","afterManip","encode","open","if","else","=","!","jQuery","mediaStreamTrack","callback","interval","getStatsLooper","getStatsWrapper","getStatsParser","stack","peer","search","nomore","getStatsResult","datachannel","ended","speed","bytesSent","helper","audioBytesSent","videoBytesSent","InstallTrigger","isSafari","res","items","that","browserFakeUserAgent","documentElement","captureStream","mozCaptureStream","getContext","play","pause","drawImage","toDataURL","HTMLVideoElement","location","href","hash","screen","URL","createObjectURL","revokeObjectURL","systemNetworkType","connection","encryption","availableBandwidth","framerateMean","bitrateMean","bytesReceived","latency","packetsLost","systemBandwidth","sentPerSecond","encodedPerSecond","videoBytestSent","connectionType","systemIpAddress","local","candidateType","transport","ipAddress","networkType","remote","resolutions","internal","candidates","checkIfOfferer","isOfferer","googInitiator","googCertificate","googFingerprintAlgorithm","fingerprintAlgorithm","checkAudioTracks","mediaType","sendrecvType","isRemote","googCodecName","kilobytes","prevBytesSent","bytes","toFixed","prevBytesReceived","googTrackId","googCurrentDelayMs","prevGoogCurrentDelayMs","prevPacketsLost","checkVideoTracks","googFrameHeightReceived","googFrameWidthReceived","googFrameHeightSent","googFrameWidthSent","prevFramerateMean","prevBitrateMean","bweforvideo","availableSendBandwidth","googAvailableSendBandwidth","googActualEncBitrate","googAvailableReceiveBandwidth","googRetransmitBitrate","googTargetEncBitrate","googBucketDelay","googTransmitBitrate","candidatePair","googActiveConnection","cid","googLocalAddress","googRemoteAddress","googTransportType","localCandidate","localCandidateId","remoteCandidateId","selected","nominated","mozLocalTransport","mozRemoteTransport","availableOutgoingBitrate","prevAvailableOutgoingBitrate","availableIncomingBitrate","prevAvailableIncomingBitrate","LOCAL_candidateType","LOCAL_transport","LOCAL_ipAddress","LOCAL_networkType","portNumber","REMOTE_candidateType","REMOTE_transport","REMOTE_ipAddress","REMOTE_networkType","dataSentReceived","remoteSource","frameWidth","frameHeight","SSRC","Helper","ace","getAvatarUrl","userId","pad","getPadId","Date","getTime","scrollDownToLastChatText","$element","$","animate","scrollTop","scrollHeight","duration","queue","getUserFromId","anonymousUser","colorId","collabClient","getConnectedUsers","user","slugify","text","$body_ace_outer","contents","createShareLink","headerId","headerText","origin","pathname","wrtcStore","enable","userInRoom","currentOpenRoom","socketState","localstream","components","init","room","wrtc","rooms","wrtcPubsub","events","on","eventName","off","emit","_len","_key","inlineAvatar","ROOM","clientVars","webrtc","displayInlineAvatar","inlineAvatarLimit","offsetTop","findAceHeaderElement","offset","top","avatarBox","append","$videoInlineAvatarIcons","userInList","userName","hide","show","_append","list","el","$roomBox","$textBox","$videoBox","attr","src","imageUrl","title","shadowRoot","querySelector","style","display","videoChat","userLeave","info","WRTC","attemptToReconnect","flow","status","requestUser","roomInfo","VIDEO","TEXT","USERS","headerCount","users","actions","btn","classList","add","setAttribute","newAction","headerTile","data-id","getHeaderRoomY","outerHeight","paddingTop","css","aceOuterPadding","ceil","$el","exist","left","outerWidth","paddingLeft","getHeaderRoomX","$inlineIcon","context","hElements","notifyNewUserJoined","msg","videoIcon","btnJoin","headerTitle","userCount","roomCounter","VIDEOCHATLIMIT","authorClass","charCodeAt","minutes","time","getMinutes","hours","getHours","timeStr","headId","addTextChatMessage","appendUserList","empty","getUserId","stopStreaming","getValidUrl","newUrl","decodeURIComponent","randomString","padInner","getFirstColumnOfSelection","rep","firstLineOfSelection","selStart","getLastColumnOfSelection","lastLineOfSelection","lastColumnOfSelection","nextLine","startLineOffset","offsetOfIndex","getLength","selEnd","hasHeaderOnLine","lineNumber","firstColumn","lastColumn","attributeManager","foundHeadOnLine","column","object","getAttributesOnLine","headingTagId","getSelectionHtml","getSelection","sel","rangeCount","container","len","getRangeAt","cloneContents","selection","createRange","htmlText","hasHeaderOnSelection","hasVideoHeader","documentAttributeManager","selectionOfMultipleLine","hasMultipleLineSelected","foundLineWithHeader","hasHeaderOnMultipleLineSelection","hasMultipleLine","addTextOnClipboard","aces","inner","removeSelection","callWithAce","ace_hasHeaderOnSelection","rawHtml","class","selectionMultipleLine","hTag","content","selectionOneLine","originalEvent","clipboardData","setData","raw","multiLine","preventDefault","execCommand","pastOnSelection","hasWrtcObject","getData","objectMediaData","range","insertNode","collapse","removeAllRanges","addRange","CodecsHandler","preferCodec","codecName","videoCodecNumbers","vp8LineNumber","vp9LineNumber","h264LineNumber","preferCodecHelper","ignore","preferCodecNumber","newLine","videoCodecNumbersOriginal","newOrder","codecNumber","findLine","sdpLines","startLine","endLine","realEndLine","findLineInRange","getCodecPayloadType","sdpLine","pattern","removeVPX","disableNACK","prioritize","codecMimeType","getParameters","mimeType","unshift","setParameters","removeNonG722","setApplicationSpecificBandwidth","isScreen","setBAS","setVideoBitrates","xgoogle_min_bitrate","xgoogle_max_bitrate","videoCodec","vp8Index","vp8Payload","rtxIndex","rtxPayload","rtxFmtpLineIndex","appendrtxNext","_setVideoBitrates","setOpusAttributes","opusIndex","opusPayload","opusFmtpLineIndex","appendOpusNext","stereo","maxaveragebitrate","maxplaybackrate","cbr","useinbandfec","usedtx","_setOpusAttributes","preferVP9","forceStereoAudio","fmtpLineIndex","extractSdp","padutils","textChat","socket","padId","currentRoom","$joinBtn","createAndAppendMessage","tim","escapeHtmlWithClickableLinks","data-authorid","author","eventTextChatInput","keyCode","which","textMessage","incomMsg","deactivateModal","$TextChatWrapper","removeClass","removeAttr","$btn","data-action","toggle","activateModal","headTitle","addClass","headingId","addUserToRoom","$headingRoom","present","data-text","removeUserFromRoom","$textChatUserList","postAceInit","hook","webSocket","docId","chatBox","innerHeight","transform","userJoin","userData","$joinButton","padparticipators","appendTextChatModalToBody","textChatModal","networkInterval","pingos","startTime","LMin","LMax","avg","LineAvg","colors","normal","warning","danger","interavCheck","deactivate","clearInterval","videoBtn","opacity","data-active","removeListener","setInterval","now","activate","active","hasClass","createSession","userInfo","gateway_userJoin","_userData","gateway_userLeave","showUserMediaError","reachedVideoRoomSize","showAlert","isBulkUpdate","gritter","sticky","class_name","bulkUpdate","videoId","color","reloadSession","reloadCurrentSession","videoSettings","localStorage","getItem","microphone","speaker","camera","audioInputSection","audioOutputSection","videoSection","audioInputElement","audioOutputElement","videoElement","deviceInfo","option","WrtcRoom","tryToJoinByQueryString","scroll2Header","scrollIntoView","behavior","closeTextChat","trigger","roomBtnHandler","handleObj","hasHref","joinChatRoom","leaveChatRoom","shareRoomsLink","ep_profile_list","about","homepage","background-position","background-image","background-repeat","background-size","background-color","showUserProfileModal","joinByQueryString","urlParams","URLSearchParams","inComePadName","currentPadName","link","$temp","select","detail","aceSetAuthorStyle","border-color","videoChatLimit","$AceOuter","userPresent","toggleClass","position","$box","activeEventListener","adoptHeaderYRoom","$padOuter","$headerId","$headingEl","appendVideoIcon","createAgain","roomExist","$elRoomExist","children","aceInnerOffset","newY","newX","prevAll","positionTop","positionLeft","box","syncVideoAvatart","reconnected","videoSizes","large","small","audioInputSelect","videoSelect","audioOutputSelect","DtlsSrtpKeyAgreement","sdpConstraints","OfferToReceiveAudio","OfferToReceiveVideo","remoteStream","enlargedVideos","Set","localVideoElement","sizes","_pad","audioVideoInputChange","changeAudioDestination","hangupAll","payload","to","receiveMessage","appendVideoModalToBody","$wrtcVideoModal","prepend","$parent","videoBox","userID","$this","isActive","$modal","bytesToSize","floor","toPrecision","statistic","send.codecs","$btnInfo","siblings","gState","hangup","handleClientMessage_RTC_MESSAGE","reason","sendErrorStat","hostname","toggleMuted","audioTrack","toggleVideo","videoTrack","setStream","isLocal","videoContainer","max-height","loadedmetadata","addInterface","autoplay","muted","attachMediaStream","$video","$mute","click","videoEnabled","$disableVideo","videoEnlarged","$largeVideo","delete","videoSize","$networkLatancy","statName","sendMessage","socketIdTo","from","createPeerConnection","cleanupSdp","logError","_headerId","notify","webrtcDetectedBrowser","prop","cons1","cons2","merged","mergeConstraints","attachSinkId","element","sinkId","setSinkId","errorMessage","selectedIndex","audioDestination","audioSource","videoSource","audioOutput","mediaConstraints","setItem","srcObject","mozSrcObject","minVideo","maxVideo"],"mappings":"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","file":"wrtc.heading.mini.js","sourcesContent":["(function (f) { if (typeof exports === 'object' && typeof module !== 'undefined') { module.exports = f(); } else if (typeof define === 'function' && define.amd) { define([], f); } else { let g; if (typeof window !== 'undefined') { g = window; } else if (typeof global !== 'undefined') { g = global; } else if (typeof self !== 'undefined') { g = self; } else { g = this; }g.adapter = f(); } })(() => {\n  let define, module, exports; return (function () { function r(e, n, t) { function o(i, f) { if (!n[i]) { if (!e[i]) { const c = 'function' === typeof require && require; if (!f && c) return c(i, !0); if (u) return u(i, !0); const a = new Error(`Cannot find module '${i}'`); throw a.code = 'MODULE_NOT_FOUND', a; } const p = n[i] = {exports: {}}; e[i][0].call(p.exports, (r) => { const n = e[i][1][r]; return o(n || r); }, p, p.exports, r, e, n, t); } return n[i].exports; } for (var u = 'function' === typeof require && require, i = 0; i < t.length; i++)o(t[i]); return o; } return r; })()({1: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n\n    'use strict';\n\n    const _adapter_factory = require('./adapter_factory.js');\n\n    const adapter = (0, _adapter_factory.adapterFactory)({window});\n    module.exports = adapter; // this is the difference from adapter_core.\n  }, {'./adapter_factory.js': 2}], 2: [function (require, module, exports) {\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n    exports.adapterFactory = adapterFactory;\n\n    const _utils = require('./utils');\n\n    const utils = _interopRequireWildcard(_utils);\n\n    const _chrome_shim = require('./chrome/chrome_shim');\n\n    const chromeShim = _interopRequireWildcard(_chrome_shim);\n\n    const _edge_shim = require('./edge/edge_shim');\n\n    const edgeShim = _interopRequireWildcard(_edge_shim);\n\n    const _firefox_shim = require('./firefox/firefox_shim');\n\n    const firefoxShim = _interopRequireWildcard(_firefox_shim);\n\n    const _safari_shim = require('./safari/safari_shim');\n\n    const safariShim = _interopRequireWildcard(_safari_shim);\n\n    const _common_shim = require('./common_shim');\n\n    const commonShim = _interopRequireWildcard(_common_shim);\n\n    function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { const newObj = {}; if (obj != null) { for (const key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n    // Shimming starts here.\n    /*\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    function adapterFactory() {\n      const _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      const window = _ref.window;\n\n      const options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n        shimChrome: true,\n        shimFirefox: true,\n        shimEdge: true,\n        shimSafari: true,\n      };\n\n      // Utils.\n      const logging = utils.log;\n      const browserDetails = utils.detectBrowser(window);\n\n      const adapter = {\n        browserDetails,\n        commonShim,\n        extractVersion: utils.extractVersion,\n        disableLog: utils.disableLog,\n        disableWarnings: utils.disableWarnings,\n      };\n\n      // Shim browser if found.\n      switch (browserDetails.browser) {\n        case 'chrome':\n          if (!chromeShim || !chromeShim.shimPeerConnection || !options.shimChrome) {\n            logging('Chrome shim is not included in this adapter release.');\n            return adapter;\n          }\n          logging('adapter.js shimming chrome.');\n          // Export to the adapter global object visible in the browser.\n          adapter.browserShim = chromeShim;\n\n          chromeShim.shimGetUserMedia(window);\n          chromeShim.shimMediaStream(window);\n          chromeShim.shimPeerConnection(window);\n          chromeShim.shimOnTrack(window);\n          chromeShim.shimAddTrackRemoveTrack(window);\n          chromeShim.shimGetSendersWithDtmf(window);\n          chromeShim.shimGetStats(window);\n          chromeShim.shimSenderReceiverGetStats(window);\n          chromeShim.fixNegotiationNeeded(window);\n\n          commonShim.shimRTCIceCandidate(window);\n          commonShim.shimConnectionState(window);\n          commonShim.shimMaxMessageSize(window);\n          commonShim.shimSendThrowTypeError(window);\n          commonShim.removeAllowExtmapMixed(window);\n          break;\n        case 'firefox':\n          if (!firefoxShim || !firefoxShim.shimPeerConnection || !options.shimFirefox) {\n            logging('Firefox shim is not included in this adapter release.');\n            return adapter;\n          }\n          logging('adapter.js shimming firefox.');\n          // Export to the adapter global object visible in the browser.\n          adapter.browserShim = firefoxShim;\n\n          firefoxShim.shimGetUserMedia(window);\n          firefoxShim.shimPeerConnection(window);\n          firefoxShim.shimOnTrack(window);\n          firefoxShim.shimRemoveStream(window);\n          firefoxShim.shimSenderGetStats(window);\n          firefoxShim.shimReceiverGetStats(window);\n          firefoxShim.shimRTCDataChannel(window);\n\n          commonShim.shimRTCIceCandidate(window);\n          commonShim.shimConnectionState(window);\n          commonShim.shimMaxMessageSize(window);\n          commonShim.shimSendThrowTypeError(window);\n          break;\n        case 'edge':\n          if (!edgeShim || !edgeShim.shimPeerConnection || !options.shimEdge) {\n            logging('MS edge shim is not included in this adapter release.');\n            return adapter;\n          }\n          logging('adapter.js shimming edge.');\n          // Export to the adapter global object visible in the browser.\n          adapter.browserShim = edgeShim;\n\n          edgeShim.shimGetUserMedia(window);\n          edgeShim.shimGetDisplayMedia(window);\n          edgeShim.shimPeerConnection(window);\n          edgeShim.shimReplaceTrack(window);\n\n          // the edge shim implements the full RTCIceCandidate object.\n\n          commonShim.shimMaxMessageSize(window);\n          commonShim.shimSendThrowTypeError(window);\n          break;\n        case 'safari':\n          if (!safariShim || !options.shimSafari) {\n            logging('Safari shim is not included in this adapter release.');\n            return adapter;\n          }\n          logging('adapter.js shimming safari.');\n          // Export to the adapter global object visible in the browser.\n          adapter.browserShim = safariShim;\n\n          safariShim.shimRTCIceServerUrls(window);\n          safariShim.shimCreateOfferLegacy(window);\n          safariShim.shimCallbacksAPI(window);\n          safariShim.shimLocalStreamsAPI(window);\n          safariShim.shimRemoteStreamsAPI(window);\n          safariShim.shimTrackEventTransceiver(window);\n          safariShim.shimGetUserMedia(window);\n\n          commonShim.shimRTCIceCandidate(window);\n          commonShim.shimMaxMessageSize(window);\n          commonShim.shimSendThrowTypeError(window);\n          commonShim.removeAllowExtmapMixed(window);\n          break;\n        default:\n          logging('Unsupported browser!');\n          break;\n      }\n\n      return adapter;\n    }\n\n  // Browser shims.\n  }, {'./chrome/chrome_shim': 3, './common_shim': 6, './edge/edge_shim': 7, './firefox/firefox_shim': 11, './safari/safari_shim': 14, './utils': 15}], 3: [function (require, module, exports) {\n    /*\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n    exports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\n    const _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj; };\n\n    const _getusermedia = require('./getusermedia');\n\n    Object.defineProperty(exports, 'shimGetUserMedia', {\n      enumerable: true,\n      get: function get() {\n        return _getusermedia.shimGetUserMedia;\n      },\n    });\n\n    const _getdisplaymedia = require('./getdisplaymedia');\n\n    Object.defineProperty(exports, 'shimGetDisplayMedia', {\n      enumerable: true,\n      get: function get() {\n        return _getdisplaymedia.shimGetDisplayMedia;\n      },\n    });\n    exports.shimMediaStream = shimMediaStream;\n    exports.shimOnTrack = shimOnTrack;\n    exports.shimGetSendersWithDtmf = shimGetSendersWithDtmf;\n    exports.shimGetStats = shimGetStats;\n    exports.shimSenderReceiverGetStats = shimSenderReceiverGetStats;\n    exports.shimAddTrackRemoveTrackWithNative = shimAddTrackRemoveTrackWithNative;\n    exports.shimAddTrackRemoveTrack = shimAddTrackRemoveTrack;\n    exports.shimPeerConnection = shimPeerConnection;\n    exports.fixNegotiationNeeded = fixNegotiationNeeded;\n\n    const _utils = require('../utils.js');\n\n    const utils = _interopRequireWildcard(_utils);\n\n    function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { const newObj = {}; if (obj != null) { for (const key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n    function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, {value, enumerable: true, configurable: true, writable: true}); } else { obj[key] = value; } return obj; }\n\n    function shimMediaStream(window) {\n      window.MediaStream = window.MediaStream || window.webkitMediaStream;\n    }\n\n    function shimOnTrack(window) {\n      if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && !('ontrack' in window.RTCPeerConnection.prototype)) {\n        Object.defineProperty(window.RTCPeerConnection.prototype, 'ontrack', {\n          get: function get() {\n            return this._ontrack;\n          },\n          set: function set(f) {\n            if (this._ontrack) {\n              this.removeEventListener('track', this._ontrack);\n            }\n            this.addEventListener('track', this._ontrack = f);\n          },\n\n          enumerable: true,\n          configurable: true,\n        });\n        const origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n        window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\n          const _this = this;\n\n          if (!this._ontrackpoly) {\n            this._ontrackpoly = function (e) {\n            // onaddstream does not fire when a track is added to an existing\n            // stream. But stream.onaddtrack is implemented so we use that.\n              e.stream.addEventListener('addtrack', (te) => {\n                let receiver = void 0;\n                if (window.RTCPeerConnection.prototype.getReceivers) {\n                  receiver = _this.getReceivers().find((r) => r.track && r.track.id === te.track.id);\n                } else {\n                  receiver = {track: te.track};\n                }\n\n                const event = new Event('track');\n                event.track = te.track;\n                event.receiver = receiver;\n                event.transceiver = {receiver};\n                event.streams = [e.stream];\n                _this.dispatchEvent(event);\n              });\n              e.stream.getTracks().forEach((track) => {\n                let receiver = void 0;\n                if (window.RTCPeerConnection.prototype.getReceivers) {\n                  receiver = _this.getReceivers().find((r) => r.track && r.track.id === track.id);\n                } else {\n                  receiver = {track};\n                }\n                const event = new Event('track');\n                event.track = track;\n                event.receiver = receiver;\n                event.transceiver = {receiver};\n                event.streams = [e.stream];\n                _this.dispatchEvent(event);\n              });\n            };\n            this.addEventListener('addstream', this._ontrackpoly);\n          }\n          return origSetRemoteDescription.apply(this, arguments);\n        };\n      } else {\n      // even if RTCRtpTransceiver is in window, it is only used and\n      // emitted in unified-plan. Unfortunately this means we need\n      // to unconditionally wrap the event.\n        utils.wrapPeerConnectionEvent(window, 'track', (e) => {\n          if (!e.transceiver) {\n            Object.defineProperty(e, 'transceiver', {value: {receiver: e.receiver}});\n          }\n          return e;\n        });\n      }\n    }\n\n    function shimGetSendersWithDtmf(window) {\n    // Overrides addTrack/removeTrack, depends on shimAddTrackRemoveTrack.\n      if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && !('getSenders' in window.RTCPeerConnection.prototype) && 'createDTMFSender' in window.RTCPeerConnection.prototype) {\n        const shimSenderWithDtmf = function shimSenderWithDtmf(pc, track) {\n          return {\n            track,\n            get dtmf() {\n              if (this._dtmf === undefined) {\n                if (track.kind === 'audio') {\n                  this._dtmf = pc.createDTMFSender(track);\n                } else {\n                  this._dtmf = null;\n                }\n              }\n              return this._dtmf;\n            },\n            _pc: pc,\n          };\n        };\n\n        // augment addTrack when getSenders is not available.\n        if (!window.RTCPeerConnection.prototype.getSenders) {\n          window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n            this._senders = this._senders || [];\n            return this._senders.slice(); // return a copy of the internal state.\n          };\n          const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n          window.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\n            let sender = origAddTrack.apply(this, arguments);\n            if (!sender) {\n              sender = shimSenderWithDtmf(this, track);\n              this._senders.push(sender);\n            }\n            return sender;\n          };\n\n          const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n          window.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\n            origRemoveTrack.apply(this, arguments);\n            const idx = this._senders.indexOf(sender);\n            if (idx !== -1) {\n              this._senders.splice(idx, 1);\n            }\n          };\n        }\n        const origAddStream = window.RTCPeerConnection.prototype.addStream;\n        window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n          const _this2 = this;\n\n          this._senders = this._senders || [];\n          origAddStream.apply(this, [stream]);\n          stream.getTracks().forEach((track) => {\n            _this2._senders.push(shimSenderWithDtmf(_this2, track));\n          });\n        };\n\n        const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n        window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n          const _this3 = this;\n\n          this._senders = this._senders || [];\n          origRemoveStream.apply(this, [stream]);\n\n          stream.getTracks().forEach((track) => {\n            const sender = _this3._senders.find((s) => s.track === track);\n            if (sender) {\n            // remove sender\n              _this3._senders.splice(_this3._senders.indexOf(sender), 1);\n            }\n          });\n        };\n      } else if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && 'getSenders' in window.RTCPeerConnection.prototype && 'createDTMFSender' in window.RTCPeerConnection.prototype && window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n        const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n        window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n          const _this4 = this;\n\n          const senders = origGetSenders.apply(this, []);\n          senders.forEach((sender) => sender._pc = _this4);\n          return senders;\n        };\n\n        Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n          get: function get() {\n            if (this._dtmf === undefined) {\n              if (this.track.kind === 'audio') {\n                this._dtmf = this._pc.createDTMFSender(this.track);\n              } else {\n                this._dtmf = null;\n              }\n            }\n            return this._dtmf;\n          },\n        });\n      }\n    }\n\n    function shimGetStats(window) {\n      if (!window.RTCPeerConnection) {\n        return;\n      }\n\n      const origGetStats = window.RTCPeerConnection.prototype.getStats;\n      window.RTCPeerConnection.prototype.getStats = function getStats() {\n        const _this5 = this;\n\n        const _arguments = Array.prototype.slice.call(arguments);\n        const selector = _arguments[0];\n        const onSucc = _arguments[1];\n        const onErr = _arguments[2];\n\n        // If selector is a function then we are in the old style stats so just\n        // pass back the original getStats format to avoid breaking old users.\n\n\n        if (arguments.length > 0 && typeof selector === 'function') {\n          return origGetStats.apply(this, arguments);\n        }\n\n        // When spec-style getStats is supported, return those when called with\n        // either no arguments or the selector argument is null.\n        if (origGetStats.length === 0 && (arguments.length === 0 || typeof selector !== 'function')) {\n          return origGetStats.apply(this, []);\n        }\n\n        const fixChromeStats_ = function fixChromeStats_(response) {\n          const standardReport = {};\n          const reports = response.result();\n          reports.forEach((report) => {\n            const standardStats = {\n              id: report.id,\n              timestamp: report.timestamp,\n              type: {\n                localcandidate: 'local-candidate',\n                remotecandidate: 'remote-candidate',\n              }[report.type] || report.type,\n            };\n            report.names().forEach((name) => {\n              standardStats[name] = report.stat(name);\n            });\n            standardReport[standardStats.id] = standardStats;\n          });\n\n          return standardReport;\n        };\n\n        // shim getStats with maplike support\n        const makeMapStats = function makeMapStats(stats) {\n          return new Map(Object.keys(stats).map((key) => [key, stats[key]]));\n        };\n\n        if (arguments.length >= 2) {\n          const successCallbackWrapper_ = function successCallbackWrapper_(response) {\n            onSucc(makeMapStats(fixChromeStats_(response)));\n          };\n\n          return origGetStats.apply(this, [successCallbackWrapper_, selector]);\n        }\n\n        // promise-support\n        return new Promise((resolve, reject) => {\n          origGetStats.apply(_this5, [function (response) {\n            resolve(makeMapStats(fixChromeStats_(response)));\n          }, reject]);\n        }).then(onSucc, onErr);\n      };\n    }\n\n    function shimSenderReceiverGetStats(window) {\n      if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender && window.RTCRtpReceiver)) {\n        return;\n      }\n\n      // shim sender stats.\n      if (!('getStats' in window.RTCRtpSender.prototype)) {\n        const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n        if (origGetSenders) {\n          window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n            const _this6 = this;\n\n            const senders = origGetSenders.apply(this, []);\n            senders.forEach((sender) => sender._pc = _this6);\n            return senders;\n          };\n        }\n\n        const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n        if (origAddTrack) {\n          window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n            const sender = origAddTrack.apply(this, arguments);\n            sender._pc = this;\n            return sender;\n          };\n        }\n        window.RTCRtpSender.prototype.getStats = function getStats() {\n          const sender = this;\n          return this._pc.getStats().then((result) => (\n            /* Note: this will include stats of all senders that\n\t\t\t\t\t\t *   send a track with the same id as sender.track as\n\t\t\t\t\t\t *   it is not possible to identify the RTCRtpSender.\n\t\t\t\t\t\t */\n            utils.filterStats(result, sender.track, true)\n          ));\n        };\n      }\n\n      // shim receiver stats.\n      if (!('getStats' in window.RTCRtpReceiver.prototype)) {\n        const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n        if (origGetReceivers) {\n          window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n            const _this7 = this;\n\n            const receivers = origGetReceivers.apply(this, []);\n            receivers.forEach((receiver) => receiver._pc = _this7);\n            return receivers;\n          };\n        }\n        utils.wrapPeerConnectionEvent(window, 'track', (e) => {\n          e.receiver._pc = e.srcElement;\n          return e;\n        });\n        window.RTCRtpReceiver.prototype.getStats = function getStats() {\n          const receiver = this;\n          return this._pc.getStats().then((result) => utils.filterStats(result, receiver.track, false));\n        };\n      }\n\n      if (!('getStats' in window.RTCRtpSender.prototype && 'getStats' in window.RTCRtpReceiver.prototype)) {\n        return;\n      }\n\n      // shim RTCPeerConnection.getStats(track).\n      const origGetStats = window.RTCPeerConnection.prototype.getStats;\n      window.RTCPeerConnection.prototype.getStats = function getStats() {\n        if (arguments.length > 0 && arguments[0] instanceof window.MediaStreamTrack) {\n          const track = arguments[0];\n          let sender = void 0;\n          let receiver = void 0;\n          let err = void 0;\n          this.getSenders().forEach((s) => {\n            if (s.track === track) {\n              if (sender) {\n                err = true;\n              } else {\n                sender = s;\n              }\n            }\n          });\n          this.getReceivers().forEach((r) => {\n            if (r.track === track) {\n              if (receiver) {\n                err = true;\n              } else {\n                receiver = r;\n              }\n            }\n            return r.track === track;\n          });\n          if (err || sender && receiver) {\n            return Promise.reject(new DOMException('There are more than one sender or receiver for the track.', 'InvalidAccessError'));\n          } else if (sender) {\n            return sender.getStats();\n          } else if (receiver) {\n            return receiver.getStats();\n          }\n          return Promise.reject(new DOMException('There is no sender or receiver for the track.', 'InvalidAccessError'));\n        }\n        return origGetStats.apply(this, arguments);\n      };\n    }\n\n    function shimAddTrackRemoveTrackWithNative(window) {\n    // shim addTrack/removeTrack with native variants in order to make\n    // the interactions with legacy getLocalStreams behave as in other browsers.\n    // Keeps a mapping stream.id => [stream, rtpsenders...]\n      window.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\n        const _this8 = this;\n\n        this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n        return Object.keys(this._shimmedLocalStreams).map((streamId) => _this8._shimmedLocalStreams[streamId][0]);\n      };\n\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      window.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\n        if (!stream) {\n          return origAddTrack.apply(this, arguments);\n        }\n        this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n        const sender = origAddTrack.apply(this, arguments);\n        if (!this._shimmedLocalStreams[stream.id]) {\n          this._shimmedLocalStreams[stream.id] = [stream, sender];\n        } else if (this._shimmedLocalStreams[stream.id].indexOf(sender) === -1) {\n          this._shimmedLocalStreams[stream.id].push(sender);\n        }\n        return sender;\n      };\n\n      const origAddStream = window.RTCPeerConnection.prototype.addStream;\n      window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n        const _this9 = this;\n\n        this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n\n        stream.getTracks().forEach((track) => {\n          const alreadyExists = _this9.getSenders().find((s) => s.track === track);\n          if (alreadyExists) {\n            throw new DOMException('Track already exists.', 'InvalidAccessError');\n          }\n        });\n        const existingSenders = this.getSenders();\n        origAddStream.apply(this, arguments);\n        const newSenders = this.getSenders().filter((newSender) => existingSenders.indexOf(newSender) === -1);\n        this._shimmedLocalStreams[stream.id] = [stream].concat(newSenders);\n      };\n\n      const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n      window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n        this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n        delete this._shimmedLocalStreams[stream.id];\n        return origRemoveStream.apply(this, arguments);\n      };\n\n      const origRemoveTrack = window.RTCPeerConnection.prototype.removeTrack;\n      window.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\n        const _this10 = this;\n\n        this._shimmedLocalStreams = this._shimmedLocalStreams || {};\n        if (sender) {\n          Object.keys(this._shimmedLocalStreams).forEach((streamId) => {\n            const idx = _this10._shimmedLocalStreams[streamId].indexOf(sender);\n            if (idx !== -1) {\n              _this10._shimmedLocalStreams[streamId].splice(idx, 1);\n            }\n            if (_this10._shimmedLocalStreams[streamId].length === 1) {\n              delete _this10._shimmedLocalStreams[streamId];\n            }\n          });\n        }\n        return origRemoveTrack.apply(this, arguments);\n      };\n    }\n\n    function shimAddTrackRemoveTrack(window) {\n      if (!window.RTCPeerConnection) {\n        return;\n      }\n      const browserDetails = utils.detectBrowser(window);\n      // shim addTrack and removeTrack.\n      if (window.RTCPeerConnection.prototype.addTrack && browserDetails.version >= 65) {\n        return shimAddTrackRemoveTrackWithNative(window);\n      }\n\n      // also shim pc.getLocalStreams when addTrack is shimmed\n      // to return the original streams.\n      const origGetLocalStreams = window.RTCPeerConnection.prototype.getLocalStreams;\n      window.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\n        const _this11 = this;\n\n        const nativeStreams = origGetLocalStreams.apply(this);\n        this._reverseStreams = this._reverseStreams || {};\n        return nativeStreams.map((stream) => _this11._reverseStreams[stream.id]);\n      };\n\n      const origAddStream = window.RTCPeerConnection.prototype.addStream;\n      window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n        const _this12 = this;\n\n        this._streams = this._streams || {};\n        this._reverseStreams = this._reverseStreams || {};\n\n        stream.getTracks().forEach((track) => {\n          const alreadyExists = _this12.getSenders().find((s) => s.track === track);\n          if (alreadyExists) {\n            throw new DOMException('Track already exists.', 'InvalidAccessError');\n          }\n        });\n        // Add identity mapping for consistency with addTrack.\n        // Unless this is being used with a stream from addTrack.\n        if (!this._reverseStreams[stream.id]) {\n          const newStream = new window.MediaStream(stream.getTracks());\n          this._streams[stream.id] = newStream;\n          this._reverseStreams[newStream.id] = stream;\n          stream = newStream;\n        }\n        origAddStream.apply(this, [stream]);\n      };\n\n      const origRemoveStream = window.RTCPeerConnection.prototype.removeStream;\n      window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n        this._streams = this._streams || {};\n        this._reverseStreams = this._reverseStreams || {};\n\n        origRemoveStream.apply(this, [this._streams[stream.id] || stream]);\n        delete this._reverseStreams[this._streams[stream.id] ? this._streams[stream.id].id : stream.id];\n        delete this._streams[stream.id];\n      };\n\n      window.RTCPeerConnection.prototype.addTrack = function addTrack(track, stream) {\n        const _this13 = this;\n\n        if (this.signalingState === 'closed') {\n          throw new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\n        }\n        const streams = [].slice.call(arguments, 1);\n        if (streams.length !== 1 || !streams[0].getTracks().find((t) => t === track)) {\n        // this is not fully correct but all we can manage without\n        // [[associated MediaStreams]] internal slot.\n          throw new DOMException('The adapter.js addTrack polyfill only supports a single ' + ' stream which is associated with the specified track.', 'NotSupportedError');\n        }\n\n        const alreadyExists = this.getSenders().find((s) => s.track === track);\n        if (alreadyExists) {\n          throw new DOMException('Track already exists.', 'InvalidAccessError');\n        }\n\n        this._streams = this._streams || {};\n        this._reverseStreams = this._reverseStreams || {};\n        const oldStream = this._streams[stream.id];\n        if (oldStream) {\n        // this is using odd Chrome behaviour, use with caution:\n        // https://bugs.chromium.org/p/webrtc/issues/detail?id=7815\n        // Note: we rely on the high-level addTrack/dtmf shim to\n        // create the sender with a dtmf sender.\n          oldStream.addTrack(track);\n\n          // Trigger ONN async.\n          Promise.resolve().then(() => {\n            _this13.dispatchEvent(new Event('negotiationneeded'));\n          });\n        } else {\n          const newStream = new window.MediaStream([track]);\n          this._streams[stream.id] = newStream;\n          this._reverseStreams[newStream.id] = stream;\n          this.addStream(newStream);\n        }\n        return this.getSenders().find((s) => s.track === track);\n      };\n\n      // replace the internal stream id with the external one and\n      // vice versa.\n      function replaceInternalStreamId(pc, description) {\n        let sdp = description.sdp;\n        Object.keys(pc._reverseStreams || []).forEach((internalId) => {\n          const externalStream = pc._reverseStreams[internalId];\n          const internalStream = pc._streams[externalStream.id];\n          sdp = sdp.replace(new RegExp(internalStream.id, 'g'), externalStream.id);\n        });\n        return new RTCSessionDescription({\n          type: description.type,\n          sdp,\n        });\n      }\n      function replaceExternalStreamId(pc, description) {\n        let sdp = description.sdp;\n        Object.keys(pc._reverseStreams || []).forEach((internalId) => {\n          const externalStream = pc._reverseStreams[internalId];\n          const internalStream = pc._streams[externalStream.id];\n          sdp = sdp.replace(new RegExp(externalStream.id, 'g'), internalStream.id);\n        });\n        return new RTCSessionDescription({\n          type: description.type,\n          sdp,\n        });\n      }\n      ['createOffer', 'createAnswer'].forEach((method) => {\n        const nativeMethod = window.RTCPeerConnection.prototype[method];\n        const methodObj = _defineProperty({}, method, function () {\n          const _this14 = this;\n\n          const args = arguments;\n          const isLegacyCall = arguments.length && typeof arguments[0] === 'function';\n          if (isLegacyCall) {\n            return nativeMethod.apply(this, [function (description) {\n              const desc = replaceInternalStreamId(_this14, description);\n              args[0].apply(null, [desc]);\n            }, function (err) {\n              if (args[1]) {\n                args[1].apply(null, err);\n              }\n            }, arguments[2]]);\n          }\n          return nativeMethod.apply(this, arguments).then((description) => replaceInternalStreamId(_this14, description));\n        });\n        window.RTCPeerConnection.prototype[method] = methodObj[method];\n      });\n\n      const origSetLocalDescription = window.RTCPeerConnection.prototype.setLocalDescription;\n      window.RTCPeerConnection.prototype.setLocalDescription = function setLocalDescription() {\n        if (!arguments.length || !arguments[0].type) {\n          return origSetLocalDescription.apply(this, arguments);\n        }\n        arguments[0] = replaceExternalStreamId(this, arguments[0]);\n        return origSetLocalDescription.apply(this, arguments);\n      };\n\n      // TODO: mangle getStats: https://w3c.github.io/webrtc-stats/#dom-rtcmediastreamstats-streamidentifier\n\n      const origLocalDescription = Object.getOwnPropertyDescriptor(window.RTCPeerConnection.prototype, 'localDescription');\n      Object.defineProperty(window.RTCPeerConnection.prototype, 'localDescription', {\n        get: function get() {\n          const description = origLocalDescription.get.apply(this);\n          if (description.type === '') {\n            return description;\n          }\n          return replaceInternalStreamId(this, description);\n        },\n      });\n\n      window.RTCPeerConnection.prototype.removeTrack = function removeTrack(sender) {\n        const _this15 = this;\n\n        if (this.signalingState === 'closed') {\n          throw new DOMException('The RTCPeerConnection\\'s signalingState is \\'closed\\'.', 'InvalidStateError');\n        }\n        // We can not yet check for sender instanceof RTCRtpSender\n        // since we shim RTPSender. So we check if sender._pc is set.\n        if (!sender._pc) {\n          throw new DOMException('Argument 1 of RTCPeerConnection.removeTrack ' + 'does not implement interface RTCRtpSender.', 'TypeError');\n        }\n        const isLocal = sender._pc === this;\n        if (!isLocal) {\n          throw new DOMException('Sender was not created by this connection.', 'InvalidAccessError');\n        }\n\n        // Search for the native stream the senders track belongs to.\n        this._streams = this._streams || {};\n        let stream = void 0;\n        Object.keys(this._streams).forEach((streamid) => {\n          const hasTrack = _this15._streams[streamid].getTracks().find((track) => sender.track === track);\n          if (hasTrack) {\n            stream = _this15._streams[streamid];\n          }\n        });\n\n        if (stream) {\n          if (stream.getTracks().length === 1) {\n          // if this is the last track of the stream, remove the stream. This\n          // takes care of any shimmed _senders.\n            this.removeStream(this._reverseStreams[stream.id]);\n          } else {\n          // relying on the same odd chrome behaviour as above.\n            stream.removeTrack(sender.track);\n          }\n          this.dispatchEvent(new Event('negotiationneeded'));\n        }\n      };\n    }\n\n    function shimPeerConnection(window) {\n      const browserDetails = utils.detectBrowser(window);\n\n      if (!window.RTCPeerConnection && window.webkitRTCPeerConnection) {\n      // very basic support for old versions.\n        window.RTCPeerConnection = window.webkitRTCPeerConnection;\n      }\n      if (!window.RTCPeerConnection) {\n        return;\n      }\n\n      // shim implicit creation of RTCSessionDescription/RTCIceCandidate\n      if (browserDetails.version < 53) {\n        ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach((method) => {\n          const nativeMethod = window.RTCPeerConnection.prototype[method];\n          const methodObj = _defineProperty({}, method, function () {\n            arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          });\n          window.RTCPeerConnection.prototype[method] = methodObj[method];\n        });\n      }\n\n      // support for addIceCandidate(null or undefined)\n      const nativeAddIceCandidate = window.RTCPeerConnection.prototype.addIceCandidate;\n      window.RTCPeerConnection.prototype.addIceCandidate = function addIceCandidate() {\n        if (!arguments[0]) {\n          if (arguments[1]) {\n            arguments[1].apply(null);\n          }\n          return Promise.resolve();\n        }\n        // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n        // in older versions. Native support planned for Chrome M77.\n        if (browserDetails.version < 78 && arguments[0] && arguments[0].candidate === '') {\n          return Promise.resolve();\n        }\n        return nativeAddIceCandidate.apply(this, arguments);\n      };\n    }\n\n    function fixNegotiationNeeded(window) {\n      utils.wrapPeerConnectionEvent(window, 'negotiationneeded', (e) => {\n        const pc = e.target;\n        if (pc.signalingState !== 'stable') {\n          return;\n        }\n        return e;\n      });\n    }\n  }, {'../utils.js': 15, './getdisplaymedia': 4, './getusermedia': 5}], 4: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n    exports.shimGetDisplayMedia = shimGetDisplayMedia;\n    function shimGetDisplayMedia(window, getSourceId) {\n      if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n        return;\n      }\n      if (!window.navigator.mediaDevices) {\n        return;\n      }\n      // getSourceId is a function that returns a promise resolving with\n      // the sourceId of the screen/window/tab to be shared.\n      if (typeof getSourceId !== 'function') {\n        console.error('shimGetDisplayMedia: getSourceId argument is not ' + 'a function');\n        return;\n      }\n      window.navigator.mediaDevices.getDisplayMedia = function getDisplayMedia(constraints) {\n        return getSourceId(constraints).then((sourceId) => {\n          const widthSpecified = constraints.video && constraints.video.width;\n          const heightSpecified = constraints.video && constraints.video.height;\n          const frameRateSpecified = constraints.video && constraints.video.frameRate;\n          constraints.video = {\n            mandatory: {\n              chromeMediaSource: 'desktop',\n              chromeMediaSourceId: sourceId,\n              maxFrameRate: frameRateSpecified || 3,\n            },\n          };\n          if (widthSpecified) {\n            constraints.video.mandatory.maxWidth = widthSpecified;\n          }\n          if (heightSpecified) {\n            constraints.video.mandatory.maxHeight = heightSpecified;\n          }\n          return window.navigator.mediaDevices.getUserMedia(constraints);\n        });\n      };\n    }\n  }, {}], 5: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n\n    const _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj; };\n\n    exports.shimGetUserMedia = shimGetUserMedia;\n\n    const _utils = require('../utils.js');\n\n    const utils = _interopRequireWildcard(_utils);\n\n    function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { const newObj = {}; if (obj != null) { for (const key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n    const logging = utils.log;\n\n    function shimGetUserMedia(window) {\n      const navigator = window && window.navigator;\n\n      if (!navigator.mediaDevices) {\n        return;\n      }\n\n      const browserDetails = utils.detectBrowser(window);\n\n      const constraintsToChrome_ = function constraintsToChrome_(c) {\n        if ((typeof c === 'undefined' ? 'undefined' : _typeof(c)) !== 'object' || c.mandatory || c.optional) {\n          return c;\n        }\n        const cc = {};\n        Object.keys(c).forEach((key) => {\n          if (key === 'require' || key === 'advanced' || key === 'mediaSource') {\n            return;\n          }\n          const r = _typeof(c[key]) === 'object' ? c[key] : {ideal: c[key]};\n          if (r.exact !== undefined && typeof r.exact === 'number') {\n            r.min = r.max = r.exact;\n          }\n          const oldname_ = function oldname_(prefix, name) {\n            if (prefix) {\n              return prefix + name.charAt(0).toUpperCase() + name.slice(1);\n            }\n            return name === 'deviceId' ? 'sourceId' : name;\n          };\n          if (r.ideal !== undefined) {\n            cc.optional = cc.optional || [];\n            let oc = {};\n            if (typeof r.ideal === 'number') {\n              oc[oldname_('min', key)] = r.ideal;\n              cc.optional.push(oc);\n              oc = {};\n              oc[oldname_('max', key)] = r.ideal;\n              cc.optional.push(oc);\n            } else {\n              oc[oldname_('', key)] = r.ideal;\n              cc.optional.push(oc);\n            }\n          }\n          if (r.exact !== undefined && typeof r.exact !== 'number') {\n            cc.mandatory = cc.mandatory || {};\n            cc.mandatory[oldname_('', key)] = r.exact;\n          } else {\n            ['min', 'max'].forEach((mix) => {\n              if (r[mix] !== undefined) {\n                cc.mandatory = cc.mandatory || {};\n                cc.mandatory[oldname_(mix, key)] = r[mix];\n              }\n            });\n          }\n        });\n        if (c.advanced) {\n          cc.optional = (cc.optional || []).concat(c.advanced);\n        }\n        return cc;\n      };\n\n      const shimConstraints_ = function shimConstraints_(constraints, func) {\n        if (browserDetails.version >= 61) {\n          return func(constraints);\n        }\n        constraints = JSON.parse(JSON.stringify(constraints));\n        if (constraints && _typeof(constraints.audio) === 'object') {\n          const remap = function remap(obj, a, b) {\n            if (a in obj && !(b in obj)) {\n              obj[b] = obj[a];\n              delete obj[a];\n            }\n          };\n          constraints = JSON.parse(JSON.stringify(constraints));\n          remap(constraints.audio, 'autoGainControl', 'googAutoGainControl');\n          remap(constraints.audio, 'noiseSuppression', 'googNoiseSuppression');\n          constraints.audio = constraintsToChrome_(constraints.audio);\n        }\n        if (constraints && _typeof(constraints.video) === 'object') {\n        // Shim facingMode for mobile & surface pro.\n          let face = constraints.video.facingMode;\n          face = face && ((typeof face === 'undefined' ? 'undefined' : _typeof(face)) === 'object' ? face : {ideal: face});\n          const getSupportedFacingModeLies = browserDetails.version < 66;\n\n          if (face && (face.exact === 'user' || face.exact === 'environment' || face.ideal === 'user' || face.ideal === 'environment') && !(navigator.mediaDevices.getSupportedConstraints && navigator.mediaDevices.getSupportedConstraints().facingMode && !getSupportedFacingModeLies)) {\n            delete constraints.video.facingMode;\n            let matches = void 0;\n            if (face.exact === 'environment' || face.ideal === 'environment') {\n              matches = ['back', 'rear'];\n            } else if (face.exact === 'user' || face.ideal === 'user') {\n              matches = ['front'];\n            }\n            if (matches) {\n            // Look for matches in label, or use last cam for back (typical).\n              return navigator.mediaDevices.enumerateDevices().then((devices) => {\n                devices = devices.filter((d) => d.kind === 'videoinput');\n                let dev = devices.find((d) => matches.some((match) => d.label.toLowerCase().includes(match)));\n                if (!dev && devices.length && matches.includes('back')) {\n                  dev = devices[devices.length - 1]; // more likely the back cam\n                }\n                if (dev) {\n                  constraints.video.deviceId = face.exact ? {exact: dev.deviceId} : {ideal: dev.deviceId};\n                }\n                constraints.video = constraintsToChrome_(constraints.video);\n                logging(`chrome: ${JSON.stringify(constraints)}`);\n                return func(constraints);\n              });\n            }\n          }\n          constraints.video = constraintsToChrome_(constraints.video);\n        }\n        logging(`chrome: ${JSON.stringify(constraints)}`);\n        return func(constraints);\n      };\n\n      const shimError_ = function shimError_(e) {\n        if (browserDetails.version >= 64) {\n          return e;\n        }\n        return {\n          name: {\n            PermissionDeniedError: 'NotAllowedError',\n            PermissionDismissedError: 'NotAllowedError',\n            InvalidStateError: 'NotAllowedError',\n            DevicesNotFoundError: 'NotFoundError',\n            ConstraintNotSatisfiedError: 'OverconstrainedError',\n            TrackStartError: 'NotReadableError',\n            MediaDeviceFailedDueToShutdown: 'NotAllowedError',\n            MediaDeviceKillSwitchOn: 'NotAllowedError',\n            TabCaptureError: 'AbortError',\n            ScreenCaptureError: 'AbortError',\n            DeviceCaptureError: 'AbortError',\n          }[e.name] || e.name,\n          message: e.message,\n          constraint: e.constraint || e.constraintName,\n          toString: function toString() {\n            return this.name + (this.message && ': ') + this.message;\n          },\n        };\n      };\n\n      const getUserMedia_ = function getUserMedia_(constraints, onSuccess, onError) {\n        shimConstraints_(constraints, (c) => {\n          navigator.webkitGetUserMedia(c, onSuccess, (e) => {\n            if (onError) {\n              onError(shimError_(e));\n            }\n          });\n        });\n      };\n      navigator.getUserMedia = getUserMedia_.bind(navigator);\n\n      // Even though Chrome 45 has navigator.mediaDevices and a getUserMedia\n      // function which returns a Promise, it does not accept spec-style\n      // constraints.\n      if (navigator.mediaDevices.getUserMedia) {\n        const origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n        navigator.mediaDevices.getUserMedia = function (cs) {\n          return shimConstraints_(cs, (c) => origGetUserMedia(c).then((stream) => {\n            if (c.audio && !stream.getAudioTracks().length || c.video && !stream.getVideoTracks().length) {\n              stream.getTracks().forEach((track) => {\n                track.stop();\n              });\n              throw new DOMException('', 'NotFoundError');\n            }\n            return stream;\n          }, (e) => Promise.reject(shimError_(e))));\n        };\n      }\n    }\n  }, {'../utils.js': 15}], 6: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n\n    const _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj; };\n\n    exports.shimRTCIceCandidate = shimRTCIceCandidate;\n    exports.shimMaxMessageSize = shimMaxMessageSize;\n    exports.shimSendThrowTypeError = shimSendThrowTypeError;\n    exports.shimConnectionState = shimConnectionState;\n    exports.removeAllowExtmapMixed = removeAllowExtmapMixed;\n\n    const _sdp = require('sdp');\n\n    const _sdp2 = _interopRequireDefault(_sdp);\n\n    const _utils = require('./utils');\n\n    const utils = _interopRequireWildcard(_utils);\n\n    function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { const newObj = {}; if (obj != null) { for (const key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n    function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : {default: obj}; }\n\n    function shimRTCIceCandidate(window) {\n    // foundation is arbitrarily chosen as an indicator for full support for\n    // https://w3c.github.io/webrtc-pc/#rtcicecandidate-interface\n      if (!window.RTCIceCandidate || window.RTCIceCandidate && 'foundation' in window.RTCIceCandidate.prototype) {\n        return;\n      }\n\n      const NativeRTCIceCandidate = window.RTCIceCandidate;\n      window.RTCIceCandidate = function RTCIceCandidate(args) {\n      // Remove the a= which shouldn't be part of the candidate string.\n        if ((typeof args === 'undefined' ? 'undefined' : _typeof(args)) === 'object' && args.candidate && args.candidate.indexOf('a=') === 0) {\n          args = JSON.parse(JSON.stringify(args));\n          args.candidate = args.candidate.substr(2);\n        }\n\n        if (args.candidate && args.candidate.length) {\n        // Augment the native candidate with the parsed fields.\n          const nativeCandidate = new NativeRTCIceCandidate(args);\n          const parsedCandidate = _sdp2.default.parseCandidate(args.candidate);\n          const augmentedCandidate = Object.assign(nativeCandidate, parsedCandidate);\n\n          // Add a serializer that does not serialize the extra attributes.\n          augmentedCandidate.toJSON = function toJSON() {\n            return {\n              candidate: augmentedCandidate.candidate,\n              sdpMid: augmentedCandidate.sdpMid,\n              sdpMLineIndex: augmentedCandidate.sdpMLineIndex,\n              usernameFragment: augmentedCandidate.usernameFragment,\n            };\n          };\n          return augmentedCandidate;\n        }\n        return new NativeRTCIceCandidate(args);\n      };\n      window.RTCIceCandidate.prototype = NativeRTCIceCandidate.prototype;\n\n      // Hook up the augmented candidate in onicecandidate and\n      // addEventListener('icecandidate', ...)\n      utils.wrapPeerConnectionEvent(window, 'icecandidate', (e) => {\n        if (e.candidate) {\n          Object.defineProperty(e, 'candidate', {\n            value: new window.RTCIceCandidate(e.candidate),\n            writable: 'false',\n          });\n        }\n        return e;\n      });\n    }\n\n    function shimMaxMessageSize(window) {\n      if (!window.RTCPeerConnection) {\n        return;\n      }\n      const browserDetails = utils.detectBrowser(window);\n\n      if (!('sctp' in window.RTCPeerConnection.prototype)) {\n        Object.defineProperty(window.RTCPeerConnection.prototype, 'sctp', {\n          get: function get() {\n            return typeof this._sctp === 'undefined' ? null : this._sctp;\n          },\n        });\n      }\n\n      const sctpInDescription = function sctpInDescription(description) {\n        if (!description || !description.sdp) {\n          return false;\n        }\n        const sections = _sdp2.default.splitSections(description.sdp);\n        sections.shift();\n        return sections.some((mediaSection) => {\n          const mLine = _sdp2.default.parseMLine(mediaSection);\n          return mLine && mLine.kind === 'application' && mLine.protocol.indexOf('SCTP') !== -1;\n        });\n      };\n\n      const getRemoteFirefoxVersion = function getRemoteFirefoxVersion(description) {\n      // TODO: Is there a better solution for detecting Firefox?\n        const match = description.sdp.match(/mozilla...THIS_IS_SDPARTA-(\\d+)/);\n        if (match === null || match.length < 2) {\n          return -1;\n        }\n        const version = parseInt(match[1], 10);\n        // Test for NaN (yes, this is ugly)\n        return version !== version ? -1 : version;\n      };\n\n      const getCanSendMaxMessageSize = function getCanSendMaxMessageSize(remoteIsFirefox) {\n      // Every implementation we know can send at least 64 KiB.\n      // Note: Although Chrome is technically able to send up to 256 KiB, the\n      //       data does not reach the other peer reliably.\n      //       See: https://bugs.chromium.org/p/webrtc/issues/detail?id=8419\n        let canSendMaxMessageSize = 65536;\n        if (browserDetails.browser === 'firefox') {\n          if (browserDetails.version < 57) {\n            if (remoteIsFirefox === -1) {\n            // FF < 57 will send in 16 KiB chunks using the deprecated PPID\n            // fragmentation.\n              canSendMaxMessageSize = 16384;\n            } else {\n            // However, other FF (and RAWRTC) can reassemble PPID-fragmented\n            // messages. Thus, supporting ~2 GiB when sending.\n              canSendMaxMessageSize = 2147483637;\n            }\n          } else if (browserDetails.version < 60) {\n          // Currently, all FF >= 57 will reset the remote maximum message size\n          // to the default value when a data channel is created at a later\n          // stage. :(\n          // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n            canSendMaxMessageSize = browserDetails.version === 57 ? 65535 : 65536;\n          } else {\n          // FF >= 60 supports sending ~2 GiB\n            canSendMaxMessageSize = 2147483637;\n          }\n        }\n        return canSendMaxMessageSize;\n      };\n\n      const getMaxMessageSize = function getMaxMessageSize(description, remoteIsFirefox) {\n      // Note: 65536 bytes is the default value from the SDP spec. Also,\n      //       every implementation we know supports receiving 65536 bytes.\n        let maxMessageSize = 65536;\n\n        // FF 57 has a slightly incorrect default remote max message size, so\n        // we need to adjust it here to avoid a failure when sending.\n        // See: https://bugzilla.mozilla.org/show_bug.cgi?id=1425697\n        if (browserDetails.browser === 'firefox' && browserDetails.version === 57) {\n          maxMessageSize = 65535;\n        }\n\n        const match = _sdp2.default.matchPrefix(description.sdp, 'a=max-message-size:');\n        if (match.length > 0) {\n          maxMessageSize = parseInt(match[0].substr(19), 10);\n        } else if (browserDetails.browser === 'firefox' && remoteIsFirefox !== -1) {\n        // If the maximum message size is not present in the remote SDP and\n        // both local and remote are Firefox, the remote peer can receive\n        // ~2 GiB.\n          maxMessageSize = 2147483637;\n        }\n        return maxMessageSize;\n      };\n\n      const origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n      window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\n        this._sctp = null;\n        // Chrome decided to not expose .sctp in plan-b mode.\n        // As usual, adapter.js has to do an 'ugly worakaround'\n        // to cover up the mess.\n        if (browserDetails.browser === 'chrome' && browserDetails.version >= 76) {\n          const _getConfiguration = this.getConfiguration();\n          const sdpSemantics = _getConfiguration.sdpSemantics;\n\n          if (sdpSemantics === 'plan-b') {\n            Object.defineProperty(this, 'sctp', {\n              get: function get() {\n                return typeof this._sctp === 'undefined' ? null : this._sctp;\n              },\n\n              enumerable: true,\n              configurable: true,\n            });\n          }\n        }\n\n        if (sctpInDescription(arguments[0])) {\n        // Check if the remote is FF.\n          const isFirefox = getRemoteFirefoxVersion(arguments[0]);\n\n          // Get the maximum message size the local peer is capable of sending\n          const canSendMMS = getCanSendMaxMessageSize(isFirefox);\n\n          // Get the maximum message size of the remote peer.\n          const remoteMMS = getMaxMessageSize(arguments[0], isFirefox);\n\n          // Determine final maximum message size\n          let maxMessageSize = void 0;\n          if (canSendMMS === 0 && remoteMMS === 0) {\n            maxMessageSize = Number.POSITIVE_INFINITY;\n          } else if (canSendMMS === 0 || remoteMMS === 0) {\n            maxMessageSize = Math.max(canSendMMS, remoteMMS);\n          } else {\n            maxMessageSize = Math.min(canSendMMS, remoteMMS);\n          }\n\n          // Create a dummy RTCSctpTransport object and the 'maxMessageSize'\n          // attribute.\n          const sctp = {};\n          Object.defineProperty(sctp, 'maxMessageSize', {\n            get: function get() {\n              return maxMessageSize;\n            },\n          });\n          this._sctp = sctp;\n        }\n\n        return origSetRemoteDescription.apply(this, arguments);\n      };\n    }\n\n    function shimSendThrowTypeError(window) {\n      if (!(window.RTCPeerConnection && 'createDataChannel' in window.RTCPeerConnection.prototype)) {\n        return;\n      }\n\n      // Note: Although Firefox >= 57 has a native implementation, the maximum\n      //       message size can be reset for all data channels at a later stage.\n      //       See: https://bugzilla.mozilla.org/show_bug.cgi?id=1426831\n\n      function wrapDcSend(dc, pc) {\n        const origDataChannelSend = dc.send;\n        dc.send = function send() {\n          const data = arguments[0];\n          const length = data.length || data.size || data.byteLength;\n          if (dc.readyState === 'open' && pc.sctp && length > pc.sctp.maxMessageSize) {\n            throw new TypeError(`Message too large (can send a maximum of ${pc.sctp.maxMessageSize} bytes)`);\n          }\n          return origDataChannelSend.apply(dc, arguments);\n        };\n      }\n      const origCreateDataChannel = window.RTCPeerConnection.prototype.createDataChannel;\n      window.RTCPeerConnection.prototype.createDataChannel = function createDataChannel() {\n        const dataChannel = origCreateDataChannel.apply(this, arguments);\n        wrapDcSend(dataChannel, this);\n        return dataChannel;\n      };\n      utils.wrapPeerConnectionEvent(window, 'datachannel', (e) => {\n        wrapDcSend(e.channel, e.target);\n        return e;\n      });\n    }\n\n    /* shims RTCConnectionState by pretending it is the same as iceConnectionState.\n\t * See https://bugs.chromium.org/p/webrtc/issues/detail?id=6145#c12\n\t * for why this is a valid hack in Chrome. In Firefox it is slightly incorrect\n\t * since DTLS failures would be hidden. See\n\t * https://bugzilla.mozilla.org/show_bug.cgi?id=1265827\n\t * for the Firefox tracking bug.\n\t */\n    function shimConnectionState(window) {\n      if (!window.RTCPeerConnection || 'connectionState' in window.RTCPeerConnection.prototype) {\n        return;\n      }\n      const proto = window.RTCPeerConnection.prototype;\n      Object.defineProperty(proto, 'connectionState', {\n        get: function get() {\n          return {\n            completed: 'connected',\n            checking: 'connecting',\n          }[this.iceConnectionState] || this.iceConnectionState;\n        },\n\n        enumerable: true,\n        configurable: true,\n      });\n      Object.defineProperty(proto, 'onconnectionstatechange', {\n        get: function get() {\n          return this._onconnectionstatechange || null;\n        },\n        set: function set(cb) {\n          if (this._onconnectionstatechange) {\n            this.removeEventListener('connectionstatechange', this._onconnectionstatechange);\n            delete this._onconnectionstatechange;\n          }\n          if (cb) {\n            this.addEventListener('connectionstatechange', this._onconnectionstatechange = cb);\n          }\n        },\n\n        enumerable: true,\n        configurable: true,\n      });\n\n      ['setLocalDescription', 'setRemoteDescription'].forEach((method) => {\n        const origMethod = proto[method];\n        proto[method] = function () {\n          if (!this._connectionstatechangepoly) {\n            this._connectionstatechangepoly = function (e) {\n              const pc = e.target;\n              if (pc._lastConnectionState !== pc.connectionState) {\n                pc._lastConnectionState = pc.connectionState;\n                const newEvent = new Event('connectionstatechange', e);\n                pc.dispatchEvent(newEvent);\n              }\n              return e;\n            };\n            this.addEventListener('iceconnectionstatechange', this._connectionstatechangepoly);\n          }\n          return origMethod.apply(this, arguments);\n        };\n      });\n    }\n\n    function removeAllowExtmapMixed(window) {\n    /* remove a=extmap-allow-mixed for Chrome < M71 */\n      if (!window.RTCPeerConnection) {\n        return;\n      }\n      const browserDetails = utils.detectBrowser(window);\n      if (browserDetails.browser === 'chrome' && browserDetails.version >= 71) {\n        return;\n      }\n      const nativeSRD = window.RTCPeerConnection.prototype.setRemoteDescription;\n      window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription(desc) {\n        if (desc && desc.sdp && desc.sdp.indexOf('\\na=extmap-allow-mixed') !== -1) {\n          desc.sdp = desc.sdp.split('\\n').filter((line) => line.trim() !== 'a=extmap-allow-mixed').join('\\n');\n        }\n        return nativeSRD.apply(this, arguments);\n      };\n    }\n  }, {'./utils': 15, 'sdp': 17}], 7: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n    exports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\n    const _getusermedia = require('./getusermedia');\n\n    Object.defineProperty(exports, 'shimGetUserMedia', {\n      enumerable: true,\n      get: function get() {\n        return _getusermedia.shimGetUserMedia;\n      },\n    });\n\n    const _getdisplaymedia = require('./getdisplaymedia');\n\n    Object.defineProperty(exports, 'shimGetDisplayMedia', {\n      enumerable: true,\n      get: function get() {\n        return _getdisplaymedia.shimGetDisplayMedia;\n      },\n    });\n    exports.shimPeerConnection = shimPeerConnection;\n    exports.shimReplaceTrack = shimReplaceTrack;\n\n    const _utils = require('../utils');\n\n    const utils = _interopRequireWildcard(_utils);\n\n    const _filtericeservers = require('./filtericeservers');\n\n    const _rtcpeerconnectionShim = require('rtcpeerconnection-shim');\n\n    const _rtcpeerconnectionShim2 = _interopRequireDefault(_rtcpeerconnectionShim);\n\n    function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : {default: obj}; }\n\n    function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { const newObj = {}; if (obj != null) { for (const key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n    function shimPeerConnection(window) {\n      const browserDetails = utils.detectBrowser(window);\n\n      if (window.RTCIceGatherer) {\n        if (!window.RTCIceCandidate) {\n          window.RTCIceCandidate = function RTCIceCandidate(args) {\n            return args;\n          };\n        }\n        if (!window.RTCSessionDescription) {\n          window.RTCSessionDescription = function RTCSessionDescription(args) {\n            return args;\n          };\n        }\n        // this adds an additional event listener to MediaStrackTrack that signals\n        // when a tracks enabled property was changed. Workaround for a bug in\n        // addStream, see below. No longer required in 15025+\n        if (browserDetails.version < 15025) {\n          const origMSTEnabled = Object.getOwnPropertyDescriptor(window.MediaStreamTrack.prototype, 'enabled');\n          Object.defineProperty(window.MediaStreamTrack.prototype, 'enabled', {\n            set: function set(value) {\n              origMSTEnabled.set.call(this, value);\n              const ev = new Event('enabled');\n              ev.enabled = value;\n              this.dispatchEvent(ev);\n            },\n          });\n        }\n      }\n\n      // ORTC defines the DTMF sender a bit different.\n      // https://github.com/w3c/ortc/issues/714\n      if (window.RTCRtpSender && !('dtmf' in window.RTCRtpSender.prototype)) {\n        Object.defineProperty(window.RTCRtpSender.prototype, 'dtmf', {\n          get: function get() {\n            if (this._dtmf === undefined) {\n              if (this.track.kind === 'audio') {\n                this._dtmf = new window.RTCDtmfSender(this);\n              } else if (this.track.kind === 'video') {\n                this._dtmf = null;\n              }\n            }\n            return this._dtmf;\n          },\n        });\n      }\n      // Edge currently only implements the RTCDtmfSender, not the\n      // RTCDTMFSender alias. See http://draft.ortc.org/#rtcdtmfsender2*\n      if (window.RTCDtmfSender && !window.RTCDTMFSender) {\n        window.RTCDTMFSender = window.RTCDtmfSender;\n      }\n\n      const RTCPeerConnectionShim = (0, _rtcpeerconnectionShim2.default)(window, browserDetails.version);\n      window.RTCPeerConnection = function RTCPeerConnection(config) {\n        if (config && config.iceServers) {\n          config.iceServers = (0, _filtericeservers.filterIceServers)(config.iceServers, browserDetails.version);\n          utils.log('ICE servers after filtering:', config.iceServers);\n        }\n        return new RTCPeerConnectionShim(config);\n      };\n      window.RTCPeerConnection.prototype = RTCPeerConnectionShim.prototype;\n    }\n\n    function shimReplaceTrack(window) {\n    // ORTC has replaceTrack -- https://github.com/w3c/ortc/issues/614\n      if (window.RTCRtpSender && !('replaceTrack' in window.RTCRtpSender.prototype)) {\n        window.RTCRtpSender.prototype.replaceTrack = window.RTCRtpSender.prototype.setTrack;\n      }\n    }\n  }, {'../utils': 15, './filtericeservers': 8, './getdisplaymedia': 9, './getusermedia': 10, 'rtcpeerconnection-shim': 16}], 8: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n    exports.filterIceServers = filterIceServers;\n\n    const _utils = require('../utils');\n\n    const utils = _interopRequireWildcard(_utils);\n\n    function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { const newObj = {}; if (obj != null) { for (const key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n    // Edge does not like\n    // 1) stun: filtered after 14393 unless ?transport=udp is present\n    // 2) turn: that does not have all of turn:host:port?transport=udp\n    // 3) turn: with ipv6 addresses\n    // 4) turn: occurring muliple times\n    function filterIceServers(iceServers, edgeVersion) {\n      let hasTurn = false;\n      iceServers = JSON.parse(JSON.stringify(iceServers));\n      return iceServers.filter((server) => {\n        if (server && (server.urls || server.url)) {\n          let urls = server.urls || server.url;\n          if (server.url && !server.urls) {\n            utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n          }\n          const isString = typeof urls === 'string';\n          if (isString) {\n            urls = [urls];\n          }\n          urls = urls.filter((url) => {\n          // filter STUN unconditionally.\n            if (url.indexOf('stun:') === 0) {\n              return false;\n            }\n\n            const validTurn = url.startsWith('turn') && !url.startsWith('turn:[') && url.includes('transport=udp');\n            if (validTurn && !hasTurn) {\n              hasTurn = true;\n              return true;\n            }\n            return validTurn && !hasTurn;\n          });\n\n          delete server.url;\n          server.urls = isString ? urls[0] : urls;\n          return !!urls.length;\n        }\n      });\n    }\n  }, {'../utils': 15}], 9: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n    exports.shimGetDisplayMedia = shimGetDisplayMedia;\n    function shimGetDisplayMedia(window) {\n      if (!('getDisplayMedia' in window.navigator)) {\n        return;\n      }\n      if (!window.navigator.mediaDevices) {\n        return;\n      }\n      if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n        return;\n      }\n      window.navigator.mediaDevices.getDisplayMedia = window.navigator.getDisplayMedia.bind(window.navigator);\n    }\n  }, {}], 10: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n    exports.shimGetUserMedia = shimGetUserMedia;\n    function shimGetUserMedia(window) {\n      const navigator = window && window.navigator;\n\n      const shimError_ = function shimError_(e) {\n        return {\n          name: {PermissionDeniedError: 'NotAllowedError'}[e.name] || e.name,\n          message: e.message,\n          constraint: e.constraint,\n          toString: function toString() {\n            return this.name;\n          },\n        };\n      };\n\n      // getUserMedia error shim.\n      const origGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n      navigator.mediaDevices.getUserMedia = function (c) {\n        return origGetUserMedia(c).catch((e) => Promise.reject(shimError_(e)));\n      };\n    }\n  }, {}], 11: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n    exports.shimGetDisplayMedia = exports.shimGetUserMedia = undefined;\n\n    const _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj; };\n\n    const _getusermedia = require('./getusermedia');\n\n    Object.defineProperty(exports, 'shimGetUserMedia', {\n      enumerable: true,\n      get: function get() {\n        return _getusermedia.shimGetUserMedia;\n      },\n    });\n\n    const _getdisplaymedia = require('./getdisplaymedia');\n\n    Object.defineProperty(exports, 'shimGetDisplayMedia', {\n      enumerable: true,\n      get: function get() {\n        return _getdisplaymedia.shimGetDisplayMedia;\n      },\n    });\n    exports.shimOnTrack = shimOnTrack;\n    exports.shimPeerConnection = shimPeerConnection;\n    exports.shimSenderGetStats = shimSenderGetStats;\n    exports.shimReceiverGetStats = shimReceiverGetStats;\n    exports.shimRemoveStream = shimRemoveStream;\n    exports.shimRTCDataChannel = shimRTCDataChannel;\n\n    const _utils = require('../utils');\n\n    const utils = _interopRequireWildcard(_utils);\n\n    function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { const newObj = {}; if (obj != null) { for (const key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n    function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, {value, enumerable: true, configurable: true, writable: true}); } else { obj[key] = value; } return obj; }\n\n    function shimOnTrack(window) {\n      if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\n        Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n          get: function get() {\n            return {receiver: this.receiver};\n          },\n        });\n      }\n    }\n\n    function shimPeerConnection(window) {\n      const browserDetails = utils.detectBrowser(window);\n\n      if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !(window.RTCPeerConnection || window.mozRTCPeerConnection)) {\n        return; // probably media.peerconnection.enabled=false in about:config\n      }\n      if (!window.RTCPeerConnection && window.mozRTCPeerConnection) {\n      // very basic support for old versions.\n        window.RTCPeerConnection = window.mozRTCPeerConnection;\n      }\n\n      if (browserDetails.version < 53) {\n      // shim away need for obsolete RTCIceCandidate/RTCSessionDescription.\n        ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'].forEach((method) => {\n          const nativeMethod = window.RTCPeerConnection.prototype[method];\n          const methodObj = _defineProperty({}, method, function () {\n            arguments[0] = new (method === 'addIceCandidate' ? window.RTCIceCandidate : window.RTCSessionDescription)(arguments[0]);\n            return nativeMethod.apply(this, arguments);\n          });\n          window.RTCPeerConnection.prototype[method] = methodObj[method];\n        });\n      }\n\n      // support for addIceCandidate(null or undefined)\n      const nativeAddIceCandidate = window.RTCPeerConnection.prototype.addIceCandidate;\n      window.RTCPeerConnection.prototype.addIceCandidate = function addIceCandidate() {\n        if (!arguments[0]) {\n          if (arguments[1]) {\n            arguments[1].apply(null);\n          }\n          return Promise.resolve();\n        }\n        // Firefox 68+ emits and processes {candidate: \"\", ...}, ignore\n        // in older versions.\n        if (browserDetails.version < 68 && arguments[0] && arguments[0].candidate === '') {\n          return Promise.resolve();\n        }\n        return nativeAddIceCandidate.apply(this, arguments);\n      };\n\n      const modernStatsTypes = {\n        inboundrtp: 'inbound-rtp',\n        outboundrtp: 'outbound-rtp',\n        candidatepair: 'candidate-pair',\n        localcandidate: 'local-candidate',\n        remotecandidate: 'remote-candidate',\n      };\n\n      const nativeGetStats = window.RTCPeerConnection.prototype.getStats;\n      window.RTCPeerConnection.prototype.getStats = function getStats() {\n        const _arguments = Array.prototype.slice.call(arguments);\n        const selector = _arguments[0];\n        const onSucc = _arguments[1];\n        const onErr = _arguments[2];\n\n        return nativeGetStats.apply(this, [selector || null]).then((stats) => {\n          if (browserDetails.version < 53 && !onSucc) {\n          // Shim only promise getStats with spec-hyphens in type names\n          // Leave callback version alone; misc old uses of forEach before Map\n            try {\n              stats.forEach((stat) => {\n                stat.type = modernStatsTypes[stat.type] || stat.type;\n              });\n            } catch (e) {\n              if (e.name !== 'TypeError') {\n                throw e;\n              }\n              // Avoid TypeError: \"type\" is read-only, in old versions. 34-43ish\n              stats.forEach((stat, i) => {\n                stats.set(i, Object.assign({}, stat, {\n                  type: modernStatsTypes[stat.type] || stat.type,\n                }));\n              });\n            }\n          }\n          return stats;\n        }).then(onSucc, onErr);\n      };\n    }\n\n    function shimSenderGetStats(window) {\n      if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n        return;\n      }\n      if (window.RTCRtpSender && 'getStats' in window.RTCRtpSender.prototype) {\n        return;\n      }\n      const origGetSenders = window.RTCPeerConnection.prototype.getSenders;\n      if (origGetSenders) {\n        window.RTCPeerConnection.prototype.getSenders = function getSenders() {\n          const _this = this;\n\n          const senders = origGetSenders.apply(this, []);\n          senders.forEach((sender) => sender._pc = _this);\n          return senders;\n        };\n      }\n\n      const origAddTrack = window.RTCPeerConnection.prototype.addTrack;\n      if (origAddTrack) {\n        window.RTCPeerConnection.prototype.addTrack = function addTrack() {\n          const sender = origAddTrack.apply(this, arguments);\n          sender._pc = this;\n          return sender;\n        };\n      }\n      window.RTCRtpSender.prototype.getStats = function getStats() {\n        return this.track ? this._pc.getStats(this.track) : Promise.resolve(new Map());\n      };\n    }\n\n    function shimReceiverGetStats(window) {\n      if (!((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCPeerConnection && window.RTCRtpSender)) {\n        return;\n      }\n      if (window.RTCRtpSender && 'getStats' in window.RTCRtpReceiver.prototype) {\n        return;\n      }\n      const origGetReceivers = window.RTCPeerConnection.prototype.getReceivers;\n      if (origGetReceivers) {\n        window.RTCPeerConnection.prototype.getReceivers = function getReceivers() {\n          const _this2 = this;\n\n          const receivers = origGetReceivers.apply(this, []);\n          receivers.forEach((receiver) => receiver._pc = _this2);\n          return receivers;\n        };\n      }\n      utils.wrapPeerConnectionEvent(window, 'track', (e) => {\n        e.receiver._pc = e.srcElement;\n        return e;\n      });\n      window.RTCRtpReceiver.prototype.getStats = function getStats() {\n        return this._pc.getStats(this.track);\n      };\n    }\n\n    function shimRemoveStream(window) {\n      if (!window.RTCPeerConnection || 'removeStream' in window.RTCPeerConnection.prototype) {\n        return;\n      }\n      window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n        const _this3 = this;\n\n        utils.deprecated('removeStream', 'removeTrack');\n        this.getSenders().forEach((sender) => {\n          if (sender.track && stream.getTracks().includes(sender.track)) {\n            _this3.removeTrack(sender);\n          }\n        });\n      };\n    }\n\n    function shimRTCDataChannel(window) {\n    // rename DataChannel to RTCDataChannel (native fix in FF60):\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=1173851\n      if (window.DataChannel && !window.RTCDataChannel) {\n        window.RTCDataChannel = window.DataChannel;\n      }\n    }\n  }, {'../utils': 15, './getdisplaymedia': 12, './getusermedia': 13}], 12: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2018 The adapter.js project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n    exports.shimGetDisplayMedia = shimGetDisplayMedia;\n    function shimGetDisplayMedia(window, preferredMediaSource) {\n      if (window.navigator.mediaDevices && 'getDisplayMedia' in window.navigator.mediaDevices) {\n        return;\n      }\n      if (!window.navigator.mediaDevices) {\n        return;\n      }\n      window.navigator.mediaDevices.getDisplayMedia = function getDisplayMedia(constraints) {\n        if (!(constraints && constraints.video)) {\n          const err = new DOMException('getDisplayMedia without video ' + 'constraints is undefined');\n          err.name = 'NotFoundError';\n          // from https://heycam.github.io/webidl/#idl-DOMException-error-names\n          err.code = 8;\n          return Promise.reject(err);\n        }\n        if (constraints.video === true) {\n          constraints.video = {mediaSource: preferredMediaSource};\n        } else {\n          constraints.video.mediaSource = preferredMediaSource;\n        }\n        return window.navigator.mediaDevices.getUserMedia(constraints);\n      };\n    }\n  }, {}], 13: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n\n    const _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj; };\n\n    exports.shimGetUserMedia = shimGetUserMedia;\n\n    const _utils = require('../utils');\n\n    const utils = _interopRequireWildcard(_utils);\n\n    function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { const newObj = {}; if (obj != null) { for (const key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n    function shimGetUserMedia(window) {\n      const browserDetails = utils.detectBrowser(window);\n      const navigator = window && window.navigator;\n      const MediaStreamTrack = window && window.MediaStreamTrack;\n\n      navigator.getUserMedia = function (constraints, onSuccess, onError) {\n      // Replace Firefox 44+'s deprecation warning with unprefixed version.\n        utils.deprecated('navigator.getUserMedia', 'navigator.mediaDevices.getUserMedia');\n        navigator.mediaDevices.getUserMedia(constraints).then(onSuccess, onError);\n      };\n\n      if (!(browserDetails.version > 55 && 'autoGainControl' in navigator.mediaDevices.getSupportedConstraints())) {\n        const remap = function remap(obj, a, b) {\n          if (a in obj && !(b in obj)) {\n            obj[b] = obj[a];\n            delete obj[a];\n          }\n        };\n\n        const nativeGetUserMedia = navigator.mediaDevices.getUserMedia.bind(navigator.mediaDevices);\n        navigator.mediaDevices.getUserMedia = function (c) {\n          if ((typeof c === 'undefined' ? 'undefined' : _typeof(c)) === 'object' && _typeof(c.audio) === 'object') {\n            c = JSON.parse(JSON.stringify(c));\n            remap(c.audio, 'autoGainControl', 'mozAutoGainControl');\n            remap(c.audio, 'noiseSuppression', 'mozNoiseSuppression');\n          }\n          return nativeGetUserMedia(c);\n        };\n\n        if (MediaStreamTrack && MediaStreamTrack.prototype.getSettings) {\n          const nativeGetSettings = MediaStreamTrack.prototype.getSettings;\n          MediaStreamTrack.prototype.getSettings = function () {\n            const obj = nativeGetSettings.apply(this, arguments);\n            remap(obj, 'mozAutoGainControl', 'autoGainControl');\n            remap(obj, 'mozNoiseSuppression', 'noiseSuppression');\n            return obj;\n          };\n        }\n\n        if (MediaStreamTrack && MediaStreamTrack.prototype.applyConstraints) {\n          const nativeApplyConstraints = MediaStreamTrack.prototype.applyConstraints;\n          MediaStreamTrack.prototype.applyConstraints = function (c) {\n            if (this.kind === 'audio' && (typeof c === 'undefined' ? 'undefined' : _typeof(c)) === 'object') {\n              c = JSON.parse(JSON.stringify(c));\n              remap(c, 'autoGainControl', 'mozAutoGainControl');\n              remap(c, 'noiseSuppression', 'mozNoiseSuppression');\n            }\n            return nativeApplyConstraints.apply(this, [c]);\n          };\n        }\n      }\n    }\n  }, {'../utils': 15}], 14: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n\n    const _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj; };\n\n    exports.shimLocalStreamsAPI = shimLocalStreamsAPI;\n    exports.shimRemoteStreamsAPI = shimRemoteStreamsAPI;\n    exports.shimCallbacksAPI = shimCallbacksAPI;\n    exports.shimGetUserMedia = shimGetUserMedia;\n    exports.shimConstraints = shimConstraints;\n    exports.shimRTCIceServerUrls = shimRTCIceServerUrls;\n    exports.shimTrackEventTransceiver = shimTrackEventTransceiver;\n    exports.shimCreateOfferLegacy = shimCreateOfferLegacy;\n\n    const _utils = require('../utils');\n\n    const utils = _interopRequireWildcard(_utils);\n\n    function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { const newObj = {}; if (obj != null) { for (const key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n    function shimLocalStreamsAPI(window) {\n      if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n        return;\n      }\n      if (!('getLocalStreams' in window.RTCPeerConnection.prototype)) {\n        window.RTCPeerConnection.prototype.getLocalStreams = function getLocalStreams() {\n          if (!this._localStreams) {\n            this._localStreams = [];\n          }\n          return this._localStreams;\n        };\n      }\n      if (!('addStream' in window.RTCPeerConnection.prototype)) {\n        const _addTrack = window.RTCPeerConnection.prototype.addTrack;\n        window.RTCPeerConnection.prototype.addStream = function addStream(stream) {\n          const _this = this;\n\n          if (!this._localStreams) {\n            this._localStreams = [];\n          }\n          if (!this._localStreams.includes(stream)) {\n            this._localStreams.push(stream);\n          }\n          // Try to emulate Chrome's behaviour of adding in audio-video order.\n          // Safari orders by track id.\n          stream.getAudioTracks().forEach((track) => _addTrack.call(_this, track, stream));\n          stream.getVideoTracks().forEach((track) => _addTrack.call(_this, track, stream));\n        };\n\n        window.RTCPeerConnection.prototype.addTrack = function addTrack(track) {\n          const stream = arguments[1];\n          if (stream) {\n            if (!this._localStreams) {\n              this._localStreams = [stream];\n            } else if (!this._localStreams.includes(stream)) {\n              this._localStreams.push(stream);\n            }\n          }\n          return _addTrack.apply(this, arguments);\n        };\n      }\n      if (!('removeStream' in window.RTCPeerConnection.prototype)) {\n        window.RTCPeerConnection.prototype.removeStream = function removeStream(stream) {\n          const _this2 = this;\n\n          if (!this._localStreams) {\n            this._localStreams = [];\n          }\n          const index = this._localStreams.indexOf(stream);\n          if (index === -1) {\n            return;\n          }\n          this._localStreams.splice(index, 1);\n          const tracks = stream.getTracks();\n          this.getSenders().forEach((sender) => {\n            if (tracks.includes(sender.track)) {\n              _this2.removeTrack(sender);\n            }\n          });\n        };\n      }\n    }\n\n    function shimRemoteStreamsAPI(window) {\n      if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n        return;\n      }\n      if (!('getRemoteStreams' in window.RTCPeerConnection.prototype)) {\n        window.RTCPeerConnection.prototype.getRemoteStreams = function getRemoteStreams() {\n          return this._remoteStreams ? this._remoteStreams : [];\n        };\n      }\n      if (!('onaddstream' in window.RTCPeerConnection.prototype)) {\n        Object.defineProperty(window.RTCPeerConnection.prototype, 'onaddstream', {\n          get: function get() {\n            return this._onaddstream;\n          },\n          set: function set(f) {\n            const _this3 = this;\n\n            if (this._onaddstream) {\n              this.removeEventListener('addstream', this._onaddstream);\n              this.removeEventListener('track', this._onaddstreampoly);\n            }\n            this.addEventListener('addstream', this._onaddstream = f);\n            this.addEventListener('track', this._onaddstreampoly = function (e) {\n              e.streams.forEach((stream) => {\n                if (!_this3._remoteStreams) {\n                  _this3._remoteStreams = [];\n                }\n                if (_this3._remoteStreams.includes(stream)) {\n                  return;\n                }\n                _this3._remoteStreams.push(stream);\n                const event = new Event('addstream');\n                event.stream = stream;\n                _this3.dispatchEvent(event);\n              });\n            });\n          },\n        });\n        const origSetRemoteDescription = window.RTCPeerConnection.prototype.setRemoteDescription;\n        window.RTCPeerConnection.prototype.setRemoteDescription = function setRemoteDescription() {\n          const pc = this;\n          if (!this._onaddstreampoly) {\n            this.addEventListener('track', this._onaddstreampoly = function (e) {\n              e.streams.forEach((stream) => {\n                if (!pc._remoteStreams) {\n                  pc._remoteStreams = [];\n                }\n                if (pc._remoteStreams.indexOf(stream) >= 0) {\n                  return;\n                }\n                pc._remoteStreams.push(stream);\n                const event = new Event('addstream');\n                event.stream = stream;\n                pc.dispatchEvent(event);\n              });\n            });\n          }\n          return origSetRemoteDescription.apply(pc, arguments);\n        };\n      }\n    }\n\n    function shimCallbacksAPI(window) {\n      if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) !== 'object' || !window.RTCPeerConnection) {\n        return;\n      }\n      const prototype = window.RTCPeerConnection.prototype;\n      const origCreateOffer = prototype.createOffer;\n      const origCreateAnswer = prototype.createAnswer;\n      const setLocalDescription = prototype.setLocalDescription;\n      const setRemoteDescription = prototype.setRemoteDescription;\n      const addIceCandidate = prototype.addIceCandidate;\n\n      prototype.createOffer = function createOffer(successCallback, failureCallback) {\n        const options = arguments.length >= 2 ? arguments[2] : arguments[0];\n        const promise = origCreateOffer.apply(this, [options]);\n        if (!failureCallback) {\n          return promise;\n        }\n        promise.then(successCallback, failureCallback);\n        return Promise.resolve();\n      };\n\n      prototype.createAnswer = function createAnswer(successCallback, failureCallback) {\n        const options = arguments.length >= 2 ? arguments[2] : arguments[0];\n        const promise = origCreateAnswer.apply(this, [options]);\n        if (!failureCallback) {\n          return promise;\n        }\n        promise.then(successCallback, failureCallback);\n        return Promise.resolve();\n      };\n\n      let withCallback = function withCallback(description, successCallback, failureCallback) {\n        const promise = setLocalDescription.apply(this, [description]);\n        if (!failureCallback) {\n          return promise;\n        }\n        promise.then(successCallback, failureCallback);\n        return Promise.resolve();\n      };\n      prototype.setLocalDescription = withCallback;\n\n      withCallback = function withCallback(description, successCallback, failureCallback) {\n        const promise = setRemoteDescription.apply(this, [description]);\n        if (!failureCallback) {\n          return promise;\n        }\n        promise.then(successCallback, failureCallback);\n        return Promise.resolve();\n      };\n      prototype.setRemoteDescription = withCallback;\n\n      withCallback = function withCallback(candidate, successCallback, failureCallback) {\n        const promise = addIceCandidate.apply(this, [candidate]);\n        if (!failureCallback) {\n          return promise;\n        }\n        promise.then(successCallback, failureCallback);\n        return Promise.resolve();\n      };\n      prototype.addIceCandidate = withCallback;\n    }\n\n    function shimGetUserMedia(window) {\n      const navigator = window && window.navigator;\n\n      if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n      // shim not needed in Safari 12.1\n        const mediaDevices = navigator.mediaDevices;\n        const _getUserMedia = mediaDevices.getUserMedia.bind(mediaDevices);\n        navigator.mediaDevices.getUserMedia = function (constraints) {\n          return _getUserMedia(shimConstraints(constraints));\n        };\n      }\n\n      if (!navigator.getUserMedia && navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n        navigator.getUserMedia = function getUserMedia(constraints, cb, errcb) {\n          navigator.mediaDevices.getUserMedia(constraints).then(cb, errcb);\n        }.bind(navigator);\n      }\n    }\n\n    function shimConstraints(constraints) {\n      if (constraints && constraints.video !== undefined) {\n        return Object.assign({}, constraints, {video: utils.compactObject(constraints.video)});\n      }\n\n      return constraints;\n    }\n\n    function shimRTCIceServerUrls(window) {\n    // migrate from non-spec RTCIceServer.url to RTCIceServer.urls\n      const OrigPeerConnection = window.RTCPeerConnection;\n      window.RTCPeerConnection = function RTCPeerConnection(pcConfig, pcConstraints) {\n        if (pcConfig && pcConfig.iceServers) {\n          const newIceServers = [];\n          for (let i = 0; i < pcConfig.iceServers.length; i++) {\n            let server = pcConfig.iceServers[i];\n            if (!server.hasOwnProperty('urls') && server.hasOwnProperty('url')) {\n              utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n              server = JSON.parse(JSON.stringify(server));\n              server.urls = server.url;\n              delete server.url;\n              newIceServers.push(server);\n            } else {\n              newIceServers.push(pcConfig.iceServers[i]);\n            }\n          }\n          pcConfig.iceServers = newIceServers;\n        }\n        return new OrigPeerConnection(pcConfig, pcConstraints);\n      };\n      window.RTCPeerConnection.prototype = OrigPeerConnection.prototype;\n      // wrap static methods. Currently just generateCertificate.\n      if ('generateCertificate' in window.RTCPeerConnection) {\n        Object.defineProperty(window.RTCPeerConnection, 'generateCertificate', {\n          get: function get() {\n            return OrigPeerConnection.generateCertificate;\n          },\n        });\n      }\n    }\n\n    function shimTrackEventTransceiver(window) {\n    // Add event.transceiver member over deprecated event.receiver\n      if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object' && window.RTCTrackEvent && 'receiver' in window.RTCTrackEvent.prototype && !('transceiver' in window.RTCTrackEvent.prototype)) {\n        Object.defineProperty(window.RTCTrackEvent.prototype, 'transceiver', {\n          get: function get() {\n            return {receiver: this.receiver};\n          },\n        });\n      }\n    }\n\n    function shimCreateOfferLegacy(window) {\n      const origCreateOffer = window.RTCPeerConnection.prototype.createOffer;\n      window.RTCPeerConnection.prototype.createOffer = function createOffer(offerOptions) {\n        if (offerOptions) {\n          if (typeof offerOptions.offerToReceiveAudio !== 'undefined') {\n          // support bit values\n            offerOptions.offerToReceiveAudio = !!offerOptions.offerToReceiveAudio;\n          }\n          const audioTransceiver = this.getTransceivers().find((transceiver) => transceiver.receiver.track.kind === 'audio');\n          if (offerOptions.offerToReceiveAudio === false && audioTransceiver) {\n            if (audioTransceiver.direction === 'sendrecv') {\n              if (audioTransceiver.setDirection) {\n                audioTransceiver.setDirection('sendonly');\n              } else {\n                audioTransceiver.direction = 'sendonly';\n              }\n            } else if (audioTransceiver.direction === 'recvonly') {\n              if (audioTransceiver.setDirection) {\n                audioTransceiver.setDirection('inactive');\n              } else {\n                audioTransceiver.direction = 'inactive';\n              }\n            }\n          } else if (offerOptions.offerToReceiveAudio === true && !audioTransceiver) {\n            this.addTransceiver('audio');\n          }\n\n          if (typeof offerOptions.offerToReceiveVideo !== 'undefined') {\n          // support bit values\n            offerOptions.offerToReceiveVideo = !!offerOptions.offerToReceiveVideo;\n          }\n          const videoTransceiver = this.getTransceivers().find((transceiver) => transceiver.receiver.track.kind === 'video');\n          if (offerOptions.offerToReceiveVideo === false && videoTransceiver) {\n            if (videoTransceiver.direction === 'sendrecv') {\n              if (videoTransceiver.setDirection) {\n                videoTransceiver.setDirection('sendonly');\n              } else {\n                videoTransceiver.direction = 'sendonly';\n              }\n            } else if (videoTransceiver.direction === 'recvonly') {\n              if (videoTransceiver.setDirection) {\n                videoTransceiver.setDirection('inactive');\n              } else {\n                videoTransceiver.direction = 'inactive';\n              }\n            }\n          } else if (offerOptions.offerToReceiveVideo === true && !videoTransceiver) {\n            this.addTransceiver('video');\n          }\n        }\n        return origCreateOffer.apply(this, arguments);\n      };\n    }\n  }, {'../utils': 15}], 15: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2016 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n    /* eslint-env node */\n    'use strict';\n\n    Object.defineProperty(exports, '__esModule', {\n      value: true,\n    });\n\n    const _typeof = typeof Symbol === 'function' && typeof Symbol.iterator === 'symbol' ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === 'function' && obj.constructor === Symbol && obj !== Symbol.prototype ? 'symbol' : typeof obj; };\n\n    exports.extractVersion = extractVersion;\n    exports.wrapPeerConnectionEvent = wrapPeerConnectionEvent;\n    exports.disableLog = disableLog;\n    exports.disableWarnings = disableWarnings;\n    exports.log = log;\n    exports.deprecated = deprecated;\n    exports.detectBrowser = detectBrowser;\n    exports.compactObject = compactObject;\n    exports.walkStats = walkStats;\n    exports.filterStats = filterStats;\n\n    function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, {value, enumerable: true, configurable: true, writable: true}); } else { obj[key] = value; } return obj; }\n\n    let logDisabled_ = true;\n    let deprecationWarnings_ = true;\n\n    /**\n\t * Extract browser version out of the provided user agent string.\n\t *\n\t * @param {!string} uastring userAgent string.\n\t * @param {!string} expr Regular expression used as match criteria.\n\t * @param {!number} pos position in the version string to be returned.\n\t * @return {!number} browser version.\n\t */\n    function extractVersion(uastring, expr, pos) {\n      const match = uastring.match(expr);\n      return match && match.length >= pos && parseInt(match[pos], 10);\n    }\n\n    // Wraps the peerconnection event eventNameToWrap in a function\n    // which returns the modified event object (or false to prevent\n    // the event).\n    function wrapPeerConnectionEvent(window, eventNameToWrap, wrapper) {\n      if (!window.RTCPeerConnection) {\n        return;\n      }\n      const proto = window.RTCPeerConnection.prototype;\n      const nativeAddEventListener = proto.addEventListener;\n      proto.addEventListener = function (nativeEventName, cb) {\n        if (nativeEventName !== eventNameToWrap) {\n          return nativeAddEventListener.apply(this, arguments);\n        }\n        const wrappedCallback = function wrappedCallback(e) {\n          const modifiedEvent = wrapper(e);\n          if (modifiedEvent) {\n            cb(modifiedEvent);\n          }\n        };\n        this._eventMap = this._eventMap || {};\n        this._eventMap[cb] = wrappedCallback;\n        return nativeAddEventListener.apply(this, [nativeEventName, wrappedCallback]);\n      };\n\n      const nativeRemoveEventListener = proto.removeEventListener;\n      proto.removeEventListener = function (nativeEventName, cb) {\n        if (nativeEventName !== eventNameToWrap || !this._eventMap || !this._eventMap[cb]) {\n          return nativeRemoveEventListener.apply(this, arguments);\n        }\n        const unwrappedCb = this._eventMap[cb];\n        delete this._eventMap[cb];\n        return nativeRemoveEventListener.apply(this, [nativeEventName, unwrappedCb]);\n      };\n\n      Object.defineProperty(proto, `on${eventNameToWrap}`, {\n        get: function get() {\n          return this[`_on${eventNameToWrap}`];\n        },\n        set: function set(cb) {\n          if (this[`_on${eventNameToWrap}`]) {\n            this.removeEventListener(eventNameToWrap, this[`_on${eventNameToWrap}`]);\n            delete this[`_on${eventNameToWrap}`];\n          }\n          if (cb) {\n            this.addEventListener(eventNameToWrap, this[`_on${eventNameToWrap}`] = cb);\n          }\n        },\n\n        enumerable: true,\n        configurable: true,\n      });\n    }\n\n    function disableLog(bool) {\n      if (typeof bool !== 'boolean') {\n        return new Error(`Argument type: ${typeof bool === 'undefined' ? 'undefined' : _typeof(bool)}. Please use a boolean.`);\n      }\n      logDisabled_ = bool;\n      return bool ? 'adapter.js logging disabled' : 'adapter.js logging enabled';\n    }\n\n    /**\n\t * Disable or enable deprecation warnings\n\t * @param {!boolean} bool set to true to disable warnings.\n\t */\n    function disableWarnings(bool) {\n      if (typeof bool !== 'boolean') {\n        return new Error(`Argument type: ${typeof bool === 'undefined' ? 'undefined' : _typeof(bool)}. Please use a boolean.`);\n      }\n      deprecationWarnings_ = !bool;\n      return `adapter.js deprecation warnings ${bool ? 'disabled' : 'enabled'}`;\n    }\n\n    function log() {\n      if ((typeof window === 'undefined' ? 'undefined' : _typeof(window)) === 'object') {\n        if (logDisabled_) {\n          return;\n        }\n        if (typeof console !== 'undefined' && typeof console.log === 'function') {\n          console.log.apply(console, arguments);\n        }\n      }\n    }\n\n    /**\n\t * Shows a deprecation warning suggesting the modern and spec-compatible API.\n\t */\n    function deprecated(oldMethod, newMethod) {\n      if (!deprecationWarnings_) {\n        return;\n      }\n      console.warn(`${oldMethod} is deprecated, please use ${newMethod} instead.`);\n    }\n\n    /**\n\t * Browser detector.\n\t *\n\t * @return {object} result containing browser and version\n\t *     properties.\n\t */\n    function detectBrowser(window) {\n      const navigator = window.navigator;\n\n      // Returned result object.\n\n      const result = {browser: null, version: null};\n\n      // Fail early if it's not a browser\n      if (typeof window === 'undefined' || !window.navigator) {\n        result.browser = 'Not a browser.';\n        return result;\n      }\n\n      if (navigator.mozGetUserMedia) {\n      // Firefox.\n        result.browser = 'firefox';\n        result.version = extractVersion(navigator.userAgent, /Firefox\\/(\\d+)\\./, 1);\n      } else if (navigator.webkitGetUserMedia || window.isSecureContext === false && window.webkitRTCPeerConnection && !window.RTCIceGatherer) {\n      // Chrome, Chromium, Webview, Opera.\n      // Version matches Chrome/WebRTC version.\n      // Chrome 74 removed webkitGetUserMedia on http as well so we need the\n      // more complicated fallback to webkitRTCPeerConnection.\n        result.browser = 'chrome';\n        result.version = extractVersion(navigator.userAgent, /Chrom(e|ium)\\/(\\d+)\\./, 2);\n      } else if (navigator.mediaDevices && navigator.userAgent.match(/Edge\\/(\\d+).(\\d+)$/)) {\n      // Edge.\n        result.browser = 'edge';\n        result.version = extractVersion(navigator.userAgent, /Edge\\/(\\d+).(\\d+)$/, 2);\n      } else if (window.RTCPeerConnection && navigator.userAgent.match(/AppleWebKit\\/(\\d+)\\./)) {\n      // Safari.\n        result.browser = 'safari';\n        result.version = extractVersion(navigator.userAgent, /AppleWebKit\\/(\\d+)\\./, 1);\n        result.supportsUnifiedPlan = window.RTCRtpTransceiver && 'currentDirection' in window.RTCRtpTransceiver.prototype;\n      } else {\n      // Default fallthrough: not supported.\n        result.browser = 'Not a supported browser.';\n        return result;\n      }\n\n      return result;\n    }\n\n    /**\n\t * Checks if something is an object.\n\t *\n\t * @param {*} val The something you want to check.\n\t * @return true if val is an object, false otherwise.\n\t */\n    function isObject(val) {\n      return Object.prototype.toString.call(val) === '[object Object]';\n    }\n\n    /**\n\t * Remove all empty objects and undefined values\n\t * from a nested object -- an enhanced and vanilla version\n\t * of Lodash's `compact`.\n\t */\n    function compactObject(data) {\n      if (!isObject(data)) {\n        return data;\n      }\n\n      return Object.keys(data).reduce((accumulator, key) => {\n        const isObj = isObject(data[key]);\n        const value = isObj ? compactObject(data[key]) : data[key];\n        const isEmptyObject = isObj && !Object.keys(value).length;\n        if (value === undefined || isEmptyObject) {\n          return accumulator;\n        }\n        return Object.assign(accumulator, _defineProperty({}, key, value));\n      }, {});\n    }\n\n    /* iterates the stats graph recursively. */\n    function walkStats(stats, base, resultSet) {\n      if (!base || resultSet.has(base.id)) {\n        return;\n      }\n      resultSet.set(base.id, base);\n      Object.keys(base).forEach((name) => {\n        if (name.endsWith('Id')) {\n          walkStats(stats, stats.get(base[name]), resultSet);\n        } else if (name.endsWith('Ids')) {\n          base[name].forEach((id) => {\n            walkStats(stats, stats.get(id), resultSet);\n          });\n        }\n      });\n    }\n\n    /* filter getStats for a sender/receiver track. */\n    function filterStats(result, track, outbound) {\n      const streamStatsType = outbound ? 'outbound-rtp' : 'inbound-rtp';\n      const filteredResult = new Map();\n      if (track === null) {\n        return filteredResult;\n      }\n      const trackStats = [];\n      result.forEach((value) => {\n        if (value.type === 'track' && value.trackIdentifier === track.id) {\n          trackStats.push(value);\n        }\n      });\n      trackStats.forEach((trackStat) => {\n        result.forEach((stats) => {\n          if (stats.type === streamStatsType && stats.trackId === trackStat.id) {\n            walkStats(result, stats, filteredResult);\n          }\n        });\n      });\n      return filteredResult;\n    }\n  }, {}], 16: [function (require, module, exports) {\n  /*\n\t *  Copyright (c) 2017 The WebRTC project authors. All Rights Reserved.\n\t *\n\t *  Use of this source code is governed by a BSD-style license\n\t *  that can be found in the LICENSE file in the root of the source\n\t *  tree.\n\t */\n\t /* eslint-env node */\n    'use strict';\n\n    const SDPUtils = require('sdp');\n\n    function fixStatsType(stat) {\n      return {\n        inboundrtp: 'inbound-rtp',\n        outboundrtp: 'outbound-rtp',\n        candidatepair: 'candidate-pair',\n        localcandidate: 'local-candidate',\n        remotecandidate: 'remote-candidate',\n      }[stat.type] || stat.type;\n    }\n\n    function writeMediaSection(transceiver, caps, type, stream, dtlsRole) {\n      let sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n      // Map ICE parameters (ufrag, pwd) to SDP.\n      sdp += SDPUtils.writeIceParameters(\n          transceiver.iceGatherer.getLocalParameters());\n\n      // Map DTLS parameters to SDP.\n      sdp += SDPUtils.writeDtlsParameters(\n          transceiver.dtlsTransport.getLocalParameters(),\n          type === 'offer' ? 'actpass' : dtlsRole || 'active');\n\n      sdp += `a=mid:${transceiver.mid}\\r\\n`;\n\n      if (transceiver.rtpSender && transceiver.rtpReceiver) {\n        sdp += 'a=sendrecv\\r\\n';\n      } else if (transceiver.rtpSender) {\n        sdp += 'a=sendonly\\r\\n';\n      } else if (transceiver.rtpReceiver) {\n        sdp += 'a=recvonly\\r\\n';\n      } else {\n        sdp += 'a=inactive\\r\\n';\n      }\n\n      if (transceiver.rtpSender) {\n        const trackId = transceiver.rtpSender._initialTrackId ||\n\t\t\t\t\ttransceiver.rtpSender.track.id;\n        transceiver.rtpSender._initialTrackId = trackId;\n        // spec.\n        const msid = `msid:${stream ? stream.id : '-'} ${\n          trackId}\\r\\n`;\n        sdp += `a=${msid}`;\n        // for Chrome. Legacy should no longer be required.\n        sdp += `a=ssrc:${transceiver.sendEncodingParameters[0].ssrc\n        } ${msid}`;\n\n        // RTX\n        if (transceiver.sendEncodingParameters[0].rtx) {\n          sdp += `a=ssrc:${transceiver.sendEncodingParameters[0].rtx.ssrc\n          } ${msid}`;\n          sdp += `a=ssrc-group:FID ${\n            transceiver.sendEncodingParameters[0].ssrc} ${\n            transceiver.sendEncodingParameters[0].rtx.ssrc\n          }\\r\\n`;\n        }\n      }\n      // FIXME: this should be written by writeRtpDescription.\n      sdp += `a=ssrc:${transceiver.sendEncodingParameters[0].ssrc\n      } cname:${SDPUtils.localCName}\\r\\n`;\n      if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n        sdp += `a=ssrc:${transceiver.sendEncodingParameters[0].rtx.ssrc\n        } cname:${SDPUtils.localCName}\\r\\n`;\n      }\n      return sdp;\n    }\n\n    // Edge does not like\n    // 1) stun: filtered after 14393 unless ?transport=udp is present\n    // 2) turn: that does not have all of turn:host:port?transport=udp\n    // 3) turn: with ipv6 addresses\n    // 4) turn: occurring muliple times\n    function filterIceServers(iceServers, edgeVersion) {\n      let hasTurn = false;\n      iceServers = JSON.parse(JSON.stringify(iceServers));\n      return iceServers.filter((server) => {\n        if (server && (server.urls || server.url)) {\n          let urls = server.urls || server.url;\n          if (server.url && !server.urls) {\n            console.warn('RTCIceServer.url is deprecated! Use urls instead.');\n          }\n          const isString = typeof urls === 'string';\n          if (isString) {\n            urls = [urls];\n          }\n          urls = urls.filter((url) => {\n            const validTurn = url.indexOf('turn:') === 0 &&\n\t\t\t\t\t\t\turl.indexOf('transport=udp') !== -1 &&\n\t\t\t\t\t\t\turl.indexOf('turn:[') === -1 &&\n\t\t\t\t\t\t\t!hasTurn;\n\n            if (validTurn) {\n              hasTurn = true;\n              return true;\n            }\n            return url.indexOf('stun:') === 0 && edgeVersion >= 14393 &&\n\t\t\t\t\t\t\turl.indexOf('?transport=udp') === -1;\n          });\n\n          delete server.url;\n          server.urls = isString ? urls[0] : urls;\n          return !!urls.length;\n        }\n      });\n    }\n\n    // Determines the intersection of local and remote capabilities.\n    function getCommonCapabilities(localCapabilities, remoteCapabilities) {\n      const commonCapabilities = {\n        codecs: [],\n        headerExtensions: [],\n        fecMechanisms: [],\n      };\n\n      const findCodecByPayloadType = function (pt, codecs) {\n        pt = parseInt(pt, 10);\n        for (let i = 0; i < codecs.length; i++) {\n          if (codecs[i].payloadType === pt ||\n\t\t\t\t\t\tcodecs[i].preferredPayloadType === pt) {\n            return codecs[i];\n          }\n        }\n      };\n\n      const rtxCapabilityMatches = function (lRtx, rRtx, lCodecs, rCodecs) {\n        const lCodec = findCodecByPayloadType(lRtx.parameters.apt, lCodecs);\n        const rCodec = findCodecByPayloadType(rRtx.parameters.apt, rCodecs);\n        return lCodec && rCodec &&\n\t\t\t\t\tlCodec.name.toLowerCase() === rCodec.name.toLowerCase();\n      };\n\n      localCapabilities.codecs.forEach((lCodec) => {\n        for (let i = 0; i < remoteCapabilities.codecs.length; i++) {\n          let rCodec = remoteCapabilities.codecs[i];\n          if (lCodec.name.toLowerCase() === rCodec.name.toLowerCase() &&\n\t\t\t\t\t\tlCodec.clockRate === rCodec.clockRate) {\n            if (lCodec.name.toLowerCase() === 'rtx' &&\n\t\t\t\t\t\t\tlCodec.parameters && rCodec.parameters.apt) {\n            // for RTX we need to find the local rtx that has a apt\n            // which points to the same local codec as the remote one.\n              if (!rtxCapabilityMatches(lCodec, rCodec,\n                  localCapabilities.codecs, remoteCapabilities.codecs)) {\n                continue;\n              }\n            }\n            rCodec = JSON.parse(JSON.stringify(rCodec)); // deepcopy\n            // number of channels is the highest common number of channels\n            rCodec.numChannels = Math.min(lCodec.numChannels,\n                rCodec.numChannels);\n            // push rCodec so we reply with offerer payload type\n            commonCapabilities.codecs.push(rCodec);\n\n            // determine common feedback mechanisms\n            rCodec.rtcpFeedback = rCodec.rtcpFeedback.filter((fb) => {\n              for (let j = 0; j < lCodec.rtcpFeedback.length; j++) {\n                if (lCodec.rtcpFeedback[j].type === fb.type &&\n\t\t\t\t\t\t\t\t\tlCodec.rtcpFeedback[j].parameter === fb.parameter) {\n                  return true;\n                }\n              }\n              return false;\n            });\n            // FIXME: also need to determine .parameters\n            //  see https://github.com/openpeer/ortc/issues/569\n            break;\n          }\n        }\n      });\n\n      localCapabilities.headerExtensions.forEach((lHeaderExtension) => {\n        for (let i = 0; i < remoteCapabilities.headerExtensions.length;\n\t\t\t\t\t i++) {\n          const rHeaderExtension = remoteCapabilities.headerExtensions[i];\n          if (lHeaderExtension.uri === rHeaderExtension.uri) {\n            commonCapabilities.headerExtensions.push(rHeaderExtension);\n            break;\n          }\n        }\n      });\n\n      // FIXME: fecMechanisms\n      return commonCapabilities;\n    }\n\n    // is action=setLocalDescription with type allowed in signalingState\n    function isActionAllowedInSignalingState(action, type, signalingState) {\n      return {\n        offer: {\n          setLocalDescription: ['stable', 'have-local-offer'],\n          setRemoteDescription: ['stable', 'have-remote-offer'],\n        },\n        answer: {\n          setLocalDescription: ['have-remote-offer', 'have-local-pranswer'],\n          setRemoteDescription: ['have-local-offer', 'have-remote-pranswer'],\n        },\n      }[type][action].indexOf(signalingState) !== -1;\n    }\n\n    function maybeAddCandidate(iceTransport, candidate) {\n    // Edge's internal representation adds some fields therefore\n    // not all fieldѕ are taken into account.\n      const alreadyAdded = iceTransport.getRemoteCandidates()\n          .find((remoteCandidate) => candidate.foundation === remoteCandidate.foundation &&\n\t\t\t\t\t\t\tcandidate.ip === remoteCandidate.ip &&\n\t\t\t\t\t\t\tcandidate.port === remoteCandidate.port &&\n\t\t\t\t\t\t\tcandidate.priority === remoteCandidate.priority &&\n\t\t\t\t\t\t\tcandidate.protocol === remoteCandidate.protocol &&\n\t\t\t\t\t\t\tcandidate.type === remoteCandidate.type);\n      if (!alreadyAdded) {\n        iceTransport.addRemoteCandidate(candidate);\n      }\n      return !alreadyAdded;\n    }\n\n\n    function makeError(name, description) {\n      const e = new Error(description);\n      e.name = name;\n      // legacy error codes from https://heycam.github.io/webidl/#idl-DOMException-error-names\n      e.code = {\n        NotSupportedError: 9,\n        InvalidStateError: 11,\n        InvalidAccessError: 15,\n        TypeError: undefined,\n        OperationError: undefined,\n      }[name];\n      return e;\n    }\n\n    module.exports = function (window, edgeVersion) {\n    // https://w3c.github.io/mediacapture-main/#mediastream\n    // Helper function to add the track to the stream and\n    // dispatch the event ourselves.\n      function addTrackToStreamAndFireEvent(track, stream) {\n        stream.addTrack(track);\n        stream.dispatchEvent(new window.MediaStreamTrackEvent('addtrack',\n            {track}));\n      }\n\n      function removeTrackFromStreamAndFireEvent(track, stream) {\n        stream.removeTrack(track);\n        stream.dispatchEvent(new window.MediaStreamTrackEvent('removetrack',\n            {track}));\n      }\n\n      function fireAddTrack(pc, track, receiver, streams) {\n        const trackEvent = new Event('track');\n        trackEvent.track = track;\n        trackEvent.receiver = receiver;\n        trackEvent.transceiver = {receiver};\n        trackEvent.streams = streams;\n        window.setTimeout(() => {\n          pc._dispatchEvent('track', trackEvent);\n        });\n      }\n\n      const RTCPeerConnection = function (config) {\n        const pc = this;\n\n        const _eventTarget = document.createDocumentFragment();\n        ['addEventListener', 'removeEventListener', 'dispatchEvent']\n            .forEach((method) => {\n              pc[method] = _eventTarget[method].bind(_eventTarget);\n            });\n\n        this.canTrickleIceCandidates = null;\n\n        this.needNegotiation = false;\n\n        this.localStreams = [];\n        this.remoteStreams = [];\n\n        this._localDescription = null;\n        this._remoteDescription = null;\n\n        this.signalingState = 'stable';\n        this.iceConnectionState = 'new';\n        this.connectionState = 'new';\n        this.iceGatheringState = 'new';\n\n        config = JSON.parse(JSON.stringify(config || {}));\n\n        this.usingBundle = config.bundlePolicy === 'max-bundle';\n        if (config.rtcpMuxPolicy === 'negotiate') {\n          throw (makeError('NotSupportedError',\n              'rtcpMuxPolicy \\'negotiate\\' is not supported'));\n        } else if (!config.rtcpMuxPolicy) {\n          config.rtcpMuxPolicy = 'require';\n        }\n\n        switch (config.iceTransportPolicy) {\n          case 'all':\n          case 'relay':\n            break;\n          default:\n            config.iceTransportPolicy = 'all';\n            break;\n        }\n\n        switch (config.bundlePolicy) {\n          case 'balanced':\n          case 'max-compat':\n          case 'max-bundle':\n            break;\n          default:\n            config.bundlePolicy = 'balanced';\n            break;\n        }\n\n        config.iceServers = filterIceServers(config.iceServers || [], edgeVersion);\n\n        this._iceGatherers = [];\n        if (config.iceCandidatePoolSize) {\n          for (let i = config.iceCandidatePoolSize; i > 0; i--) {\n            this._iceGatherers.push(new window.RTCIceGatherer({\n              iceServers: config.iceServers,\n              gatherPolicy: config.iceTransportPolicy,\n            }));\n          }\n        } else {\n          config.iceCandidatePoolSize = 0;\n        }\n\n        this._config = config;\n\n        // per-track iceGathers, iceTransports, dtlsTransports, rtpSenders, ...\n        // everything that is needed to describe a SDP m-line.\n        this.transceivers = [];\n\n        this._sdpSessionId = SDPUtils.generateSessionId();\n        this._sdpSessionVersion = 0;\n\n        this._dtlsRole = undefined; // role for a=setup to use in answers.\n\n        this._isClosed = false;\n      };\n\n      Object.defineProperty(RTCPeerConnection.prototype, 'localDescription', {\n        configurable: true,\n        get() {\n          return this._localDescription;\n        },\n      });\n      Object.defineProperty(RTCPeerConnection.prototype, 'remoteDescription', {\n        configurable: true,\n        get() {\n          return this._remoteDescription;\n        },\n      });\n\n      // set up event handlers on prototype\n      RTCPeerConnection.prototype.onicecandidate = null;\n      RTCPeerConnection.prototype.onaddstream = null;\n      RTCPeerConnection.prototype.ontrack = null;\n      RTCPeerConnection.prototype.onremovestream = null;\n      RTCPeerConnection.prototype.onsignalingstatechange = null;\n      RTCPeerConnection.prototype.oniceconnectionstatechange = null;\n      RTCPeerConnection.prototype.onconnectionstatechange = null;\n      RTCPeerConnection.prototype.onicegatheringstatechange = null;\n      RTCPeerConnection.prototype.onnegotiationneeded = null;\n      RTCPeerConnection.prototype.ondatachannel = null;\n\n      RTCPeerConnection.prototype._dispatchEvent = function (name, event) {\n        if (this._isClosed) {\n          return;\n        }\n        this.dispatchEvent(event);\n        if (typeof this[`on${name}`] === 'function') {\n          this[`on${name}`](event);\n        }\n      };\n\n      RTCPeerConnection.prototype._emitGatheringStateChange = function () {\n        const event = new Event('icegatheringstatechange');\n        this._dispatchEvent('icegatheringstatechange', event);\n      };\n\n      RTCPeerConnection.prototype.getConfiguration = function () {\n        return this._config;\n      };\n\n      RTCPeerConnection.prototype.getLocalStreams = function () {\n        return this.localStreams;\n      };\n\n      RTCPeerConnection.prototype.getRemoteStreams = function () {\n        return this.remoteStreams;\n      };\n\n      // internal helper to create a transceiver object.\n      // (which is not yet the same as the WebRTC 1.0 transceiver)\n      RTCPeerConnection.prototype._createTransceiver = function (kind, doNotAdd) {\n        const hasBundleTransport = this.transceivers.length > 0;\n        const transceiver = {\n          track: null,\n          iceGatherer: null,\n          iceTransport: null,\n          dtlsTransport: null,\n          localCapabilities: null,\n          remoteCapabilities: null,\n          rtpSender: null,\n          rtpReceiver: null,\n          kind,\n          mid: null,\n          sendEncodingParameters: null,\n          recvEncodingParameters: null,\n          stream: null,\n          associatedRemoteMediaStreams: [],\n          wantReceive: true,\n        };\n        if (this.usingBundle && hasBundleTransport) {\n          transceiver.iceTransport = this.transceivers[0].iceTransport;\n          transceiver.dtlsTransport = this.transceivers[0].dtlsTransport;\n        } else {\n          const transports = this._createIceAndDtlsTransports();\n          transceiver.iceTransport = transports.iceTransport;\n          transceiver.dtlsTransport = transports.dtlsTransport;\n        }\n        if (!doNotAdd) {\n          this.transceivers.push(transceiver);\n        }\n        return transceiver;\n      };\n\n      RTCPeerConnection.prototype.addTrack = function (track, stream) {\n        if (this._isClosed) {\n          throw makeError('InvalidStateError',\n              'Attempted to call addTrack on a closed peerconnection.');\n        }\n\n        const alreadyExists = this.transceivers.find((s) => s.track === track);\n\n        if (alreadyExists) {\n          throw makeError('InvalidAccessError', 'Track already exists.');\n        }\n\n        let transceiver;\n        for (let i = 0; i < this.transceivers.length; i++) {\n          if (!this.transceivers[i].track &&\n\t\t\t\t\t\tthis.transceivers[i].kind === track.kind) {\n            transceiver = this.transceivers[i];\n          }\n        }\n        if (!transceiver) {\n          transceiver = this._createTransceiver(track.kind);\n        }\n\n        this._maybeFireNegotiationNeeded();\n\n        if (this.localStreams.indexOf(stream) === -1) {\n          this.localStreams.push(stream);\n        }\n\n        transceiver.track = track;\n        transceiver.stream = stream;\n        transceiver.rtpSender = new window.RTCRtpSender(track,\n            transceiver.dtlsTransport);\n        return transceiver.rtpSender;\n      };\n\n      RTCPeerConnection.prototype.addStream = function (stream) {\n        const pc = this;\n        if (edgeVersion >= 15025) {\n          stream.getTracks().forEach((track) => {\n            pc.addTrack(track, stream);\n          });\n        } else {\n        // Clone is necessary for local demos mostly, attaching directly\n        // to two different senders does not work (build 10547).\n        // Fixed in 15025 (or earlier)\n          const clonedStream = stream.clone();\n          stream.getTracks().forEach((track, idx) => {\n            const clonedTrack = clonedStream.getTracks()[idx];\n            track.addEventListener('enabled', (event) => {\n              clonedTrack.enabled = event.enabled;\n            });\n          });\n          clonedStream.getTracks().forEach((track) => {\n            pc.addTrack(track, clonedStream);\n          });\n        }\n      };\n\n      RTCPeerConnection.prototype.removeTrack = function (sender) {\n        if (this._isClosed) {\n          throw makeError('InvalidStateError',\n              'Attempted to call removeTrack on a closed peerconnection.');\n        }\n\n        if (!(sender instanceof window.RTCRtpSender)) {\n          throw new TypeError('Argument 1 of RTCPeerConnection.removeTrack ' +\n\t\t\t\t\t\t'does not implement interface RTCRtpSender.');\n        }\n\n        const transceiver = this.transceivers.find((t) => t.rtpSender === sender);\n\n        if (!transceiver) {\n          throw makeError('InvalidAccessError',\n              'Sender was not created by this connection.');\n        }\n        const stream = transceiver.stream;\n\n        transceiver.rtpSender.stop();\n        transceiver.rtpSender = null;\n        transceiver.track = null;\n        transceiver.stream = null;\n\n        // remove the stream from the set of local streams\n        const localStreams = this.transceivers.map((t) => t.stream);\n        if (localStreams.indexOf(stream) === -1 &&\n\t\t\t\t\tthis.localStreams.indexOf(stream) > -1) {\n          this.localStreams.splice(this.localStreams.indexOf(stream), 1);\n        }\n\n        this._maybeFireNegotiationNeeded();\n      };\n\n      RTCPeerConnection.prototype.removeStream = function (stream) {\n        const pc = this;\n        stream.getTracks().forEach((track) => {\n          const sender = pc.getSenders().find((s) => s.track === track);\n          if (sender) {\n            pc.removeTrack(sender);\n          }\n        });\n      };\n\n      RTCPeerConnection.prototype.getSenders = function () {\n        return this.transceivers.filter((transceiver) => !!transceiver.rtpSender)\n            .map((transceiver) => transceiver.rtpSender);\n      };\n\n      RTCPeerConnection.prototype.getReceivers = function () {\n        return this.transceivers.filter((transceiver) => !!transceiver.rtpReceiver)\n            .map((transceiver) => transceiver.rtpReceiver);\n      };\n\n\n      RTCPeerConnection.prototype._createIceGatherer = function (sdpMLineIndex,\n          usingBundle) {\n        const pc = this;\n        if (usingBundle && sdpMLineIndex > 0) {\n          return this.transceivers[0].iceGatherer;\n        } else if (this._iceGatherers.length) {\n          return this._iceGatherers.shift();\n        }\n        const iceGatherer = new window.RTCIceGatherer({\n          iceServers: this._config.iceServers,\n          gatherPolicy: this._config.iceTransportPolicy,\n        });\n        Object.defineProperty(iceGatherer, 'state',\n            {value: 'new', writable: true}\n        );\n\n        this.transceivers[sdpMLineIndex].bufferedCandidateEvents = [];\n        this.transceivers[sdpMLineIndex].bufferCandidates = function (event) {\n          const end = !event.candidate || Object.keys(event.candidate).length === 0;\n          // polyfill since RTCIceGatherer.state is not implemented in\n          // Edge 10547 yet.\n          iceGatherer.state = end ? 'completed' : 'gathering';\n          if (pc.transceivers[sdpMLineIndex].bufferedCandidateEvents !== null) {\n            pc.transceivers[sdpMLineIndex].bufferedCandidateEvents.push(event);\n          }\n        };\n        iceGatherer.addEventListener('localcandidate',\n            this.transceivers[sdpMLineIndex].bufferCandidates);\n        return iceGatherer;\n      };\n\n      // start gathering from an RTCIceGatherer.\n      RTCPeerConnection.prototype._gather = function (mid, sdpMLineIndex) {\n        const pc = this;\n        const iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n        if (iceGatherer.onlocalcandidate) {\n          return;\n        }\n        const bufferedCandidateEvents =\n\t\t\t\tthis.transceivers[sdpMLineIndex].bufferedCandidateEvents;\n        this.transceivers[sdpMLineIndex].bufferedCandidateEvents = null;\n        iceGatherer.removeEventListener('localcandidate',\n            this.transceivers[sdpMLineIndex].bufferCandidates);\n        iceGatherer.onlocalcandidate = function (evt) {\n          if (pc.usingBundle && sdpMLineIndex > 0) {\n          // if we know that we use bundle we can drop candidates with\n          // ѕdpMLineIndex > 0. If we don't do this then our state gets\n          // confused since we dispose the extra ice gatherer.\n            return;\n          }\n          const event = new Event('icecandidate');\n          event.candidate = {sdpMid: mid, sdpMLineIndex};\n\n          const cand = evt.candidate;\n          // Edge emits an empty object for RTCIceCandidateComplete‥\n          const end = !cand || Object.keys(cand).length === 0;\n          if (end) {\n          // polyfill since RTCIceGatherer.state is not implemented in\n          // Edge 10547 yet.\n            if (iceGatherer.state === 'new' || iceGatherer.state === 'gathering') {\n              iceGatherer.state = 'completed';\n            }\n          } else {\n            if (iceGatherer.state === 'new') {\n              iceGatherer.state = 'gathering';\n            }\n            // RTCIceCandidate doesn't have a component, needs to be added\n            cand.component = 1;\n            // also the usernameFragment. TODO: update SDP to take both variants.\n            cand.ufrag = iceGatherer.getLocalParameters().usernameFragment;\n\n            const serializedCandidate = SDPUtils.writeCandidate(cand);\n            event.candidate = Object.assign(event.candidate,\n                SDPUtils.parseCandidate(serializedCandidate));\n\n            event.candidate.candidate = serializedCandidate;\n            event.candidate.toJSON = function () {\n              return {\n                candidate: event.candidate.candidate,\n                sdpMid: event.candidate.sdpMid,\n                sdpMLineIndex: event.candidate.sdpMLineIndex,\n                usernameFragment: event.candidate.usernameFragment,\n              };\n            };\n          }\n\n          // update local description.\n          const sections = SDPUtils.getMediaSections(pc._localDescription.sdp);\n          if (!end) {\n            sections[event.candidate.sdpMLineIndex] +=\n\t\t\t\t\t\t\t`a=${event.candidate.candidate}\\r\\n`;\n          } else {\n            sections[event.candidate.sdpMLineIndex] +=\n\t\t\t\t\t\t\t'a=end-of-candidates\\r\\n';\n          }\n          pc._localDescription.sdp =\n\t\t\t\t\t\tSDPUtils.getDescription(pc._localDescription.sdp) +\n\t\t\t\t\t\tsections.join('');\n          const complete = pc.transceivers.every((transceiver) => transceiver.iceGatherer &&\n\t\t\t\t\t\t\ttransceiver.iceGatherer.state === 'completed');\n\n          if (pc.iceGatheringState !== 'gathering') {\n            pc.iceGatheringState = 'gathering';\n            pc._emitGatheringStateChange();\n          }\n\n          // Emit candidate. Also emit null candidate when all gatherers are\n          // complete.\n          if (!end) {\n            pc._dispatchEvent('icecandidate', event);\n          }\n          if (complete) {\n            pc._dispatchEvent('icecandidate', new Event('icecandidate'));\n            pc.iceGatheringState = 'complete';\n            pc._emitGatheringStateChange();\n          }\n        };\n\n        // emit already gathered candidates.\n        window.setTimeout(() => {\n          bufferedCandidateEvents.forEach((e) => {\n            iceGatherer.onlocalcandidate(e);\n          });\n        }, 0);\n      };\n\n      // Create ICE transport and DTLS transport.\n      RTCPeerConnection.prototype._createIceAndDtlsTransports = function () {\n        const pc = this;\n        const iceTransport = new window.RTCIceTransport(null);\n        iceTransport.onicestatechange = function () {\n          pc._updateIceConnectionState();\n          pc._updateConnectionState();\n        };\n\n        const dtlsTransport = new window.RTCDtlsTransport(iceTransport);\n        dtlsTransport.ondtlsstatechange = function () {\n          pc._updateConnectionState();\n        };\n        dtlsTransport.onerror = function () {\n        // onerror does not set state to failed by itself.\n          Object.defineProperty(dtlsTransport, 'state',\n              {value: 'failed', writable: true});\n          pc._updateConnectionState();\n        };\n\n        return {\n          iceTransport,\n          dtlsTransport,\n        };\n      };\n\n      // Destroy ICE gatherer, ICE transport and DTLS transport.\n      // Without triggering the callbacks.\n      RTCPeerConnection.prototype._disposeIceAndDtlsTransports = function (\n          sdpMLineIndex) {\n        const iceGatherer = this.transceivers[sdpMLineIndex].iceGatherer;\n        if (iceGatherer) {\n          delete iceGatherer.onlocalcandidate;\n          delete this.transceivers[sdpMLineIndex].iceGatherer;\n        }\n        const iceTransport = this.transceivers[sdpMLineIndex].iceTransport;\n        if (iceTransport) {\n          delete iceTransport.onicestatechange;\n          delete this.transceivers[sdpMLineIndex].iceTransport;\n        }\n        const dtlsTransport = this.transceivers[sdpMLineIndex].dtlsTransport;\n        if (dtlsTransport) {\n          delete dtlsTransport.ondtlsstatechange;\n          delete dtlsTransport.onerror;\n          delete this.transceivers[sdpMLineIndex].dtlsTransport;\n        }\n      };\n\n      // Start the RTP Sender and Receiver for a transceiver.\n      RTCPeerConnection.prototype._transceive = function (transceiver,\n          send, recv) {\n        const params = getCommonCapabilities(transceiver.localCapabilities,\n            transceiver.remoteCapabilities);\n        if (send && transceiver.rtpSender) {\n          params.encodings = transceiver.sendEncodingParameters;\n          params.rtcp = {\n            cname: SDPUtils.localCName,\n            compound: transceiver.rtcpParameters.compound,\n          };\n          if (transceiver.recvEncodingParameters.length) {\n            params.rtcp.ssrc = transceiver.recvEncodingParameters[0].ssrc;\n          }\n          transceiver.rtpSender.send(params);\n        }\n        if (recv && transceiver.rtpReceiver && params.codecs.length > 0) {\n        // remove RTX field in Edge 14942\n          if (transceiver.kind === 'video' &&\n\t\t\t\t\t\ttransceiver.recvEncodingParameters &&\n\t\t\t\t\t\tedgeVersion < 15019) {\n            transceiver.recvEncodingParameters.forEach((p) => {\n              delete p.rtx;\n            });\n          }\n          if (transceiver.recvEncodingParameters.length) {\n            params.encodings = transceiver.recvEncodingParameters;\n          } else {\n            params.encodings = [{}];\n          }\n          params.rtcp = {\n            compound: transceiver.rtcpParameters.compound,\n          };\n          if (transceiver.rtcpParameters.cname) {\n            params.rtcp.cname = transceiver.rtcpParameters.cname;\n          }\n          if (transceiver.sendEncodingParameters.length) {\n            params.rtcp.ssrc = transceiver.sendEncodingParameters[0].ssrc;\n          }\n          transceiver.rtpReceiver.receive(params);\n        }\n      };\n\n      RTCPeerConnection.prototype.setLocalDescription = function (description) {\n        const pc = this;\n\n        // Note: pranswer is not supported.\n        if (['offer', 'answer'].indexOf(description.type) === -1) {\n          return Promise.reject(makeError('TypeError',\n              `Unsupported type \"${description.type}\"`));\n        }\n\n        if (!isActionAllowedInSignalingState('setLocalDescription',\n            description.type, pc.signalingState) || pc._isClosed) {\n          return Promise.reject(makeError('InvalidStateError',\n              `Can not set local ${description.type\n              } in state ${pc.signalingState}`));\n        }\n\n        let sections;\n        let sessionpart;\n        if (description.type === 'offer') {\n        // VERY limited support for SDP munging. Limited to:\n        // * changing the order of codecs\n          sections = SDPUtils.splitSections(description.sdp);\n          sessionpart = sections.shift();\n          sections.forEach((mediaSection, sdpMLineIndex) => {\n            const caps = SDPUtils.parseRtpParameters(mediaSection);\n            pc.transceivers[sdpMLineIndex].localCapabilities = caps;\n          });\n\n          pc.transceivers.forEach((transceiver, sdpMLineIndex) => {\n            pc._gather(transceiver.mid, sdpMLineIndex);\n          });\n        } else if (description.type === 'answer') {\n          sections = SDPUtils.splitSections(pc._remoteDescription.sdp);\n          sessionpart = sections.shift();\n          const isIceLite = SDPUtils.matchPrefix(sessionpart,\n              'a=ice-lite').length > 0;\n          sections.forEach((mediaSection, sdpMLineIndex) => {\n            const transceiver = pc.transceivers[sdpMLineIndex];\n            const iceGatherer = transceiver.iceGatherer;\n            const iceTransport = transceiver.iceTransport;\n            const dtlsTransport = transceiver.dtlsTransport;\n            const localCapabilities = transceiver.localCapabilities;\n            const remoteCapabilities = transceiver.remoteCapabilities;\n\n            // treat bundle-only as not-rejected.\n            const rejected = SDPUtils.isRejected(mediaSection) &&\n\t\t\t\t\t\t\tSDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n\n            if (!rejected && !transceiver.rejected) {\n              const remoteIceParameters = SDPUtils.getIceParameters(\n                  mediaSection, sessionpart);\n              const remoteDtlsParameters = SDPUtils.getDtlsParameters(\n                  mediaSection, sessionpart);\n              if (isIceLite) {\n                remoteDtlsParameters.role = 'server';\n              }\n\n              if (!pc.usingBundle || sdpMLineIndex === 0) {\n                pc._gather(transceiver.mid, sdpMLineIndex);\n                if (iceTransport.state === 'new') {\n                  iceTransport.start(iceGatherer, remoteIceParameters,\n                      isIceLite ? 'controlling' : 'controlled');\n                }\n                if (dtlsTransport.state === 'new') {\n                  dtlsTransport.start(remoteDtlsParameters);\n                }\n              }\n\n              // Calculate intersection of capabilities.\n              const params = getCommonCapabilities(localCapabilities,\n                  remoteCapabilities);\n\n              // Start the RTCRtpSender. The RTCRtpReceiver for this\n              // transceiver has already been started in setRemoteDescription.\n              pc._transceive(transceiver,\n                  params.codecs.length > 0,\n                  false);\n            }\n          });\n        }\n\n        pc._localDescription = {\n          type: description.type,\n          sdp: description.sdp,\n        };\n        if (description.type === 'offer') {\n          pc._updateSignalingState('have-local-offer');\n        } else {\n          pc._updateSignalingState('stable');\n        }\n\n        return Promise.resolve();\n      };\n\n      RTCPeerConnection.prototype.setRemoteDescription = function (description) {\n        const pc = this;\n\n        // Note: pranswer is not supported.\n        if (['offer', 'answer'].indexOf(description.type) === -1) {\n          return Promise.reject(makeError('TypeError',\n              `Unsupported type \"${description.type}\"`));\n        }\n\n        if (!isActionAllowedInSignalingState('setRemoteDescription',\n            description.type, pc.signalingState) || pc._isClosed) {\n          return Promise.reject(makeError('InvalidStateError',\n              `Can not set remote ${description.type\n              } in state ${pc.signalingState}`));\n        }\n\n        const streams = {};\n        pc.remoteStreams.forEach((stream) => {\n          streams[stream.id] = stream;\n        });\n        const receiverList = [];\n        const sections = SDPUtils.splitSections(description.sdp);\n        const sessionpart = sections.shift();\n        const isIceLite = SDPUtils.matchPrefix(sessionpart,\n            'a=ice-lite').length > 0;\n        const usingBundle = SDPUtils.matchPrefix(sessionpart,\n            'a=group:BUNDLE ').length > 0;\n        pc.usingBundle = usingBundle;\n        const iceOptions = SDPUtils.matchPrefix(sessionpart,\n            'a=ice-options:')[0];\n        if (iceOptions) {\n          pc.canTrickleIceCandidates = iceOptions.substr(14).split(' ')\n              .indexOf('trickle') >= 0;\n        } else {\n          pc.canTrickleIceCandidates = false;\n        }\n\n        sections.forEach((mediaSection, sdpMLineIndex) => {\n          const lines = SDPUtils.splitLines(mediaSection);\n          const kind = SDPUtils.getKind(mediaSection);\n          // treat bundle-only as not-rejected.\n          const rejected = SDPUtils.isRejected(mediaSection) &&\n\t\t\t\t\t\tSDPUtils.matchPrefix(mediaSection, 'a=bundle-only').length === 0;\n          const protocol = lines[0].substr(2).split(' ')[2];\n\n          const direction = SDPUtils.getDirection(mediaSection, sessionpart);\n          const remoteMsid = SDPUtils.parseMsid(mediaSection);\n\n          const mid = SDPUtils.getMid(mediaSection) || SDPUtils.generateIdentifier();\n\n          // Reject datachannels which are not implemented yet.\n          if (rejected || (kind === 'application' && (protocol === 'DTLS/SCTP' ||\n\t\t\t\t\t\tprotocol === 'UDP/DTLS/SCTP'))) {\n          // TODO: this is dangerous in the case where a non-rejected m-line\n          //     becomes rejected.\n            pc.transceivers[sdpMLineIndex] = {\n              mid,\n              kind,\n              protocol,\n              rejected: true,\n            };\n            return;\n          }\n\n          if (!rejected && pc.transceivers[sdpMLineIndex] &&\n\t\t\t\t\t\tpc.transceivers[sdpMLineIndex].rejected) {\n          // recycle a rejected transceiver.\n            pc.transceivers[sdpMLineIndex] = pc._createTransceiver(kind, true);\n          }\n\n          let transceiver;\n          let iceGatherer;\n          let iceTransport;\n          let dtlsTransport;\n          let rtpReceiver;\n          let sendEncodingParameters;\n          let recvEncodingParameters;\n          let localCapabilities;\n\n          let track;\n          // FIXME: ensure the mediaSection has rtcp-mux set.\n          const remoteCapabilities = SDPUtils.parseRtpParameters(mediaSection);\n          let remoteIceParameters;\n          let remoteDtlsParameters;\n          if (!rejected) {\n            remoteIceParameters = SDPUtils.getIceParameters(mediaSection,\n                sessionpart);\n            remoteDtlsParameters = SDPUtils.getDtlsParameters(mediaSection,\n                sessionpart);\n            remoteDtlsParameters.role = 'client';\n          }\n          recvEncodingParameters =\n\t\t\t\t\t\tSDPUtils.parseRtpEncodingParameters(mediaSection);\n\n          const rtcpParameters = SDPUtils.parseRtcpParameters(mediaSection);\n\n          const isComplete = SDPUtils.matchPrefix(mediaSection,\n              'a=end-of-candidates', sessionpart).length > 0;\n          const cands = SDPUtils.matchPrefix(mediaSection, 'a=candidate:')\n              .map((cand) => SDPUtils.parseCandidate(cand))\n              .filter((cand) => cand.component === 1);\n\n          // Check if we can use BUNDLE and dispose transports.\n          if ((description.type === 'offer' || description.type === 'answer') &&\n\t\t\t\t\t\t!rejected && usingBundle && sdpMLineIndex > 0 &&\n\t\t\t\t\t\tpc.transceivers[sdpMLineIndex]) {\n            pc._disposeIceAndDtlsTransports(sdpMLineIndex);\n            pc.transceivers[sdpMLineIndex].iceGatherer =\n\t\t\t\t\t\t\tpc.transceivers[0].iceGatherer;\n            pc.transceivers[sdpMLineIndex].iceTransport =\n\t\t\t\t\t\t\tpc.transceivers[0].iceTransport;\n            pc.transceivers[sdpMLineIndex].dtlsTransport =\n\t\t\t\t\t\t\tpc.transceivers[0].dtlsTransport;\n            if (pc.transceivers[sdpMLineIndex].rtpSender) {\n              pc.transceivers[sdpMLineIndex].rtpSender.setTransport(\n                  pc.transceivers[0].dtlsTransport);\n            }\n            if (pc.transceivers[sdpMLineIndex].rtpReceiver) {\n              pc.transceivers[sdpMLineIndex].rtpReceiver.setTransport(\n                  pc.transceivers[0].dtlsTransport);\n            }\n          }\n          if (description.type === 'offer' && !rejected) {\n            transceiver = pc.transceivers[sdpMLineIndex] ||\n\t\t\t\t\t\t\tpc._createTransceiver(kind);\n            transceiver.mid = mid;\n\n            if (!transceiver.iceGatherer) {\n              transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n                  usingBundle);\n            }\n\n            if (cands.length && transceiver.iceTransport.state === 'new') {\n              if (isComplete && (!usingBundle || sdpMLineIndex === 0)) {\n                transceiver.iceTransport.setRemoteCandidates(cands);\n              } else {\n                cands.forEach((candidate) => {\n                  maybeAddCandidate(transceiver.iceTransport, candidate);\n                });\n              }\n            }\n\n            localCapabilities = window.RTCRtpReceiver.getCapabilities(kind);\n\n            // filter RTX until additional stuff needed for RTX is implemented\n            // in adapter.js\n            if (edgeVersion < 15019) {\n              localCapabilities.codecs = localCapabilities.codecs.filter(\n                  (codec) => codec.name !== 'rtx');\n            }\n\n            sendEncodingParameters = transceiver.sendEncodingParameters || [{\n              ssrc: (2 * sdpMLineIndex + 2) * 1001,\n            }];\n\n            // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n            let isNewTrack = false;\n            if (direction === 'sendrecv' || direction === 'sendonly') {\n              isNewTrack = !transceiver.rtpReceiver;\n              rtpReceiver = transceiver.rtpReceiver ||\n\t\t\t\t\t\t\t\tnew window.RTCRtpReceiver(transceiver.dtlsTransport, kind);\n\n              if (isNewTrack) {\n                let stream;\n                track = rtpReceiver.track;\n                // FIXME: does not work with Plan B.\n                if (remoteMsid && remoteMsid.stream === '-') {\n                // no-op. a stream id of '-' means: no associated stream.\n                } else if (remoteMsid) {\n                  if (!streams[remoteMsid.stream]) {\n                    streams[remoteMsid.stream] = new window.MediaStream();\n                    Object.defineProperty(streams[remoteMsid.stream], 'id', {\n                      get() {\n                        return remoteMsid.stream;\n                      },\n                    });\n                  }\n                  Object.defineProperty(track, 'id', {\n                    get() {\n                      return remoteMsid.track;\n                    },\n                  });\n                  stream = streams[remoteMsid.stream];\n                } else {\n                  if (!streams.default) {\n                    streams.default = new window.MediaStream();\n                  }\n                  stream = streams.default;\n                }\n                if (stream) {\n                  addTrackToStreamAndFireEvent(track, stream);\n                  transceiver.associatedRemoteMediaStreams.push(stream);\n                }\n                receiverList.push([track, rtpReceiver, stream]);\n              }\n            } else if (transceiver.rtpReceiver && transceiver.rtpReceiver.track) {\n              transceiver.associatedRemoteMediaStreams.forEach((s) => {\n                const nativeTrack = s.getTracks().find((t) => t.id === transceiver.rtpReceiver.track.id);\n                if (nativeTrack) {\n                  removeTrackFromStreamAndFireEvent(nativeTrack, s);\n                }\n              });\n              transceiver.associatedRemoteMediaStreams = [];\n            }\n\n            transceiver.localCapabilities = localCapabilities;\n            transceiver.remoteCapabilities = remoteCapabilities;\n            transceiver.rtpReceiver = rtpReceiver;\n            transceiver.rtcpParameters = rtcpParameters;\n            transceiver.sendEncodingParameters = sendEncodingParameters;\n            transceiver.recvEncodingParameters = recvEncodingParameters;\n\n            // Start the RTCRtpReceiver now. The RTPSender is started in\n            // setLocalDescription.\n            pc._transceive(pc.transceivers[sdpMLineIndex],\n                false,\n                isNewTrack);\n          } else if (description.type === 'answer' && !rejected) {\n            transceiver = pc.transceivers[sdpMLineIndex];\n            iceGatherer = transceiver.iceGatherer;\n            iceTransport = transceiver.iceTransport;\n            dtlsTransport = transceiver.dtlsTransport;\n            rtpReceiver = transceiver.rtpReceiver;\n            sendEncodingParameters = transceiver.sendEncodingParameters;\n            localCapabilities = transceiver.localCapabilities;\n\n            pc.transceivers[sdpMLineIndex].recvEncodingParameters =\n\t\t\t\t\t\t\trecvEncodingParameters;\n            pc.transceivers[sdpMLineIndex].remoteCapabilities =\n\t\t\t\t\t\t\tremoteCapabilities;\n            pc.transceivers[sdpMLineIndex].rtcpParameters = rtcpParameters;\n\n            if (cands.length && iceTransport.state === 'new') {\n              if ((isIceLite || isComplete) &&\n\t\t\t\t\t\t\t\t(!usingBundle || sdpMLineIndex === 0)) {\n                iceTransport.setRemoteCandidates(cands);\n              } else {\n                cands.forEach((candidate) => {\n                  maybeAddCandidate(transceiver.iceTransport, candidate);\n                });\n              }\n            }\n\n            if (!usingBundle || sdpMLineIndex === 0) {\n              if (iceTransport.state === 'new') {\n                iceTransport.start(iceGatherer, remoteIceParameters,\n                    'controlling');\n              }\n              if (dtlsTransport.state === 'new') {\n                dtlsTransport.start(remoteDtlsParameters);\n              }\n            }\n\n            // If the offer contained RTX but the answer did not,\n            // remove RTX from sendEncodingParameters.\n            const commonCapabilities = getCommonCapabilities(\n                transceiver.localCapabilities,\n                transceiver.remoteCapabilities);\n\n            const hasRtx = commonCapabilities.codecs.filter((c) => c.name.toLowerCase() === 'rtx').length;\n            if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n              delete transceiver.sendEncodingParameters[0].rtx;\n            }\n\n            pc._transceive(transceiver,\n                direction === 'sendrecv' || direction === 'recvonly',\n                direction === 'sendrecv' || direction === 'sendonly');\n\n            // TODO: rewrite to use http://w3c.github.io/webrtc-pc/#set-associated-remote-streams\n            if (rtpReceiver &&\n\t\t\t\t\t\t\t(direction === 'sendrecv' || direction === 'sendonly')) {\n              track = rtpReceiver.track;\n              if (remoteMsid) {\n                if (!streams[remoteMsid.stream]) {\n                  streams[remoteMsid.stream] = new window.MediaStream();\n                }\n                addTrackToStreamAndFireEvent(track, streams[remoteMsid.stream]);\n                receiverList.push([track, rtpReceiver, streams[remoteMsid.stream]]);\n              } else {\n                if (!streams.default) {\n                  streams.default = new window.MediaStream();\n                }\n                addTrackToStreamAndFireEvent(track, streams.default);\n                receiverList.push([track, rtpReceiver, streams.default]);\n              }\n            } else {\n            // FIXME: actually the receiver should be created later.\n              delete transceiver.rtpReceiver;\n            }\n          }\n        });\n\n        if (pc._dtlsRole === undefined) {\n          pc._dtlsRole = description.type === 'offer' ? 'active' : 'passive';\n        }\n\n        pc._remoteDescription = {\n          type: description.type,\n          sdp: description.sdp,\n        };\n        if (description.type === 'offer') {\n          pc._updateSignalingState('have-remote-offer');\n        } else {\n          pc._updateSignalingState('stable');\n        }\n        Object.keys(streams).forEach((sid) => {\n          const stream = streams[sid];\n          if (stream.getTracks().length) {\n            if (pc.remoteStreams.indexOf(stream) === -1) {\n              pc.remoteStreams.push(stream);\n              const event = new Event('addstream');\n              event.stream = stream;\n              window.setTimeout(() => {\n                pc._dispatchEvent('addstream', event);\n              });\n            }\n\n            receiverList.forEach((item) => {\n              const track = item[0];\n              const receiver = item[1];\n              if (stream.id !== item[2].id) {\n                return;\n              }\n              fireAddTrack(pc, track, receiver, [stream]);\n            });\n          }\n        });\n        receiverList.forEach((item) => {\n          if (item[2]) {\n            return;\n          }\n          fireAddTrack(pc, item[0], item[1], []);\n        });\n\n        // check whether addIceCandidate({}) was called within four seconds after\n        // setRemoteDescription.\n        window.setTimeout(() => {\n          if (!(pc && pc.transceivers)) {\n            return;\n          }\n          pc.transceivers.forEach((transceiver) => {\n            if (transceiver.iceTransport &&\n\t\t\t\t\t\t\ttransceiver.iceTransport.state === 'new' &&\n\t\t\t\t\t\t\ttransceiver.iceTransport.getRemoteCandidates().length > 0) {\n              console.warn('Timeout for addRemoteCandidate. Consider sending ' +\n\t\t\t\t\t\t\t\t'an end-of-candidates notification');\n              transceiver.iceTransport.addRemoteCandidate({});\n            }\n          });\n        }, 4000);\n\n        return Promise.resolve();\n      };\n\n      RTCPeerConnection.prototype.close = function () {\n        this.transceivers.forEach((transceiver) => {\n        /* not yet\n\t\t\t\tif (transceiver.iceGatherer) {\n\t\t\t\t\ttransceiver.iceGatherer.close();\n\t\t\t\t}\n\t\t\t\t*/\n          if (transceiver.iceTransport) {\n            transceiver.iceTransport.stop();\n          }\n          if (transceiver.dtlsTransport) {\n            transceiver.dtlsTransport.stop();\n          }\n          if (transceiver.rtpSender) {\n            transceiver.rtpSender.stop();\n          }\n          if (transceiver.rtpReceiver) {\n            transceiver.rtpReceiver.stop();\n          }\n        });\n        // FIXME: clean up tracks, local streams, remote streams, etc\n        this._isClosed = true;\n        this._updateSignalingState('closed');\n      };\n\n      // Update the signaling state.\n      RTCPeerConnection.prototype._updateSignalingState = function (newState) {\n        this.signalingState = newState;\n        const event = new Event('signalingstatechange');\n        this._dispatchEvent('signalingstatechange', event);\n      };\n\n      // Determine whether to fire the negotiationneeded event.\n      RTCPeerConnection.prototype._maybeFireNegotiationNeeded = function () {\n        const pc = this;\n        if (this.signalingState !== 'stable' || this.needNegotiation === true) {\n          return;\n        }\n        this.needNegotiation = true;\n        window.setTimeout(() => {\n          if (pc.needNegotiation) {\n            pc.needNegotiation = false;\n            const event = new Event('negotiationneeded');\n            pc._dispatchEvent('negotiationneeded', event);\n          }\n        }, 0);\n      };\n\n      // Update the ice connection state.\n      RTCPeerConnection.prototype._updateIceConnectionState = function () {\n        let newState;\n        const states = {\n          new: 0,\n          closed: 0,\n          checking: 0,\n          connected: 0,\n          completed: 0,\n          disconnected: 0,\n          failed: 0,\n        };\n        this.transceivers.forEach((transceiver) => {\n          if (transceiver.iceTransport && !transceiver.rejected) {\n            states[transceiver.iceTransport.state]++;\n          }\n        });\n\n        newState = 'new';\n        if (states.failed > 0) {\n          newState = 'failed';\n        } else if (states.checking > 0) {\n          newState = 'checking';\n        } else if (states.disconnected > 0) {\n          newState = 'disconnected';\n        } else if (states.new > 0) {\n          newState = 'new';\n        } else if (states.connected > 0) {\n          newState = 'connected';\n        } else if (states.completed > 0) {\n          newState = 'completed';\n        }\n\n        if (newState !== this.iceConnectionState) {\n          this.iceConnectionState = newState;\n          const event = new Event('iceconnectionstatechange');\n          this._dispatchEvent('iceconnectionstatechange', event);\n        }\n      };\n\n      // Update the connection state.\n      RTCPeerConnection.prototype._updateConnectionState = function () {\n        let newState;\n        const states = {\n          new: 0,\n          closed: 0,\n          connecting: 0,\n          connected: 0,\n          completed: 0,\n          disconnected: 0,\n          failed: 0,\n        };\n        this.transceivers.forEach((transceiver) => {\n          if (transceiver.iceTransport && transceiver.dtlsTransport &&\n\t\t\t\t\t\t!transceiver.rejected) {\n            states[transceiver.iceTransport.state]++;\n            states[transceiver.dtlsTransport.state]++;\n          }\n        });\n        // ICETransport.completed and connected are the same for this purpose.\n        states.connected += states.completed;\n\n        newState = 'new';\n        if (states.failed > 0) {\n          newState = 'failed';\n        } else if (states.connecting > 0) {\n          newState = 'connecting';\n        } else if (states.disconnected > 0) {\n          newState = 'disconnected';\n        } else if (states.new > 0) {\n          newState = 'new';\n        } else if (states.connected > 0) {\n          newState = 'connected';\n        }\n\n        if (newState !== this.connectionState) {\n          this.connectionState = newState;\n          const event = new Event('connectionstatechange');\n          this._dispatchEvent('connectionstatechange', event);\n        }\n      };\n\n      RTCPeerConnection.prototype.createOffer = function () {\n        const pc = this;\n\n        if (pc._isClosed) {\n          return Promise.reject(makeError('InvalidStateError',\n              'Can not call createOffer after close'));\n        }\n\n        let numAudioTracks = pc.transceivers.filter((t) => t.kind === 'audio').length;\n        let numVideoTracks = pc.transceivers.filter((t) => t.kind === 'video').length;\n\n        // Determine number of audio and video tracks we need to send/recv.\n        const offerOptions = arguments[0];\n        if (offerOptions) {\n        // Reject Chrome legacy constraints.\n          if (offerOptions.mandatory || offerOptions.optional) {\n            throw new TypeError(\n                'Legacy mandatory/optional constraints not supported.');\n          }\n          if (offerOptions.offerToReceiveAudio !== undefined) {\n            if (offerOptions.offerToReceiveAudio === true) {\n              numAudioTracks = 1;\n            } else if (offerOptions.offerToReceiveAudio === false) {\n              numAudioTracks = 0;\n            } else {\n              numAudioTracks = offerOptions.offerToReceiveAudio;\n            }\n          }\n          if (offerOptions.offerToReceiveVideo !== undefined) {\n            if (offerOptions.offerToReceiveVideo === true) {\n              numVideoTracks = 1;\n            } else if (offerOptions.offerToReceiveVideo === false) {\n              numVideoTracks = 0;\n            } else {\n              numVideoTracks = offerOptions.offerToReceiveVideo;\n            }\n          }\n        }\n\n        pc.transceivers.forEach((transceiver) => {\n          if (transceiver.kind === 'audio') {\n            numAudioTracks--;\n            if (numAudioTracks < 0) {\n              transceiver.wantReceive = false;\n            }\n          } else if (transceiver.kind === 'video') {\n            numVideoTracks--;\n            if (numVideoTracks < 0) {\n              transceiver.wantReceive = false;\n            }\n          }\n        });\n\n        // Create M-lines for recvonly streams.\n        while (numAudioTracks > 0 || numVideoTracks > 0) {\n          if (numAudioTracks > 0) {\n            pc._createTransceiver('audio');\n            numAudioTracks--;\n          }\n          if (numVideoTracks > 0) {\n            pc._createTransceiver('video');\n            numVideoTracks--;\n          }\n        }\n\n        let sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n            pc._sdpSessionVersion++);\n        pc.transceivers.forEach((transceiver, sdpMLineIndex) => {\n        // For each track, create an ice gatherer, ice transport,\n        // dtls transport, potentially rtpsender and rtpreceiver.\n          const track = transceiver.track;\n          const kind = transceiver.kind;\n          const mid = transceiver.mid || SDPUtils.generateIdentifier();\n          transceiver.mid = mid;\n\n          if (!transceiver.iceGatherer) {\n            transceiver.iceGatherer = pc._createIceGatherer(sdpMLineIndex,\n                pc.usingBundle);\n          }\n\n          const localCapabilities = window.RTCRtpSender.getCapabilities(kind);\n          // filter RTX until additional stuff needed for RTX is implemented\n          // in adapter.js\n          if (edgeVersion < 15019) {\n            localCapabilities.codecs = localCapabilities.codecs.filter(\n                (codec) => codec.name !== 'rtx');\n          }\n          localCapabilities.codecs.forEach((codec) => {\n          // work around https://bugs.chromium.org/p/webrtc/issues/detail?id=6552\n          // by adding level-asymmetry-allowed=1\n            if (codec.name === 'H264' &&\n\t\t\t\t\t\t\tcodec.parameters['level-asymmetry-allowed'] === undefined) {\n              codec.parameters['level-asymmetry-allowed'] = '1';\n            }\n\n            // for subsequent offers, we might have to re-use the payload\n            // type of the last offer.\n            if (transceiver.remoteCapabilities &&\n\t\t\t\t\t\t\ttransceiver.remoteCapabilities.codecs) {\n              transceiver.remoteCapabilities.codecs.forEach((remoteCodec) => {\n                if (codec.name.toLowerCase() === remoteCodec.name.toLowerCase() &&\n\t\t\t\t\t\t\t\t\tcodec.clockRate === remoteCodec.clockRate) {\n                  codec.preferredPayloadType = remoteCodec.payloadType;\n                }\n              });\n            }\n          });\n          localCapabilities.headerExtensions.forEach((hdrExt) => {\n            const remoteExtensions = transceiver.remoteCapabilities &&\n\t\t\t\t\t\t\ttransceiver.remoteCapabilities.headerExtensions || [];\n            remoteExtensions.forEach((rHdrExt) => {\n              if (hdrExt.uri === rHdrExt.uri) {\n                hdrExt.id = rHdrExt.id;\n              }\n            });\n          });\n\n          // generate an ssrc now, to be used later in rtpSender.send\n          const sendEncodingParameters = transceiver.sendEncodingParameters || [{\n            ssrc: (2 * sdpMLineIndex + 1) * 1001,\n          }];\n          if (track) {\n          // add RTX\n            if (edgeVersion >= 15019 && kind === 'video' &&\n\t\t\t\t\t\t\t!sendEncodingParameters[0].rtx) {\n              sendEncodingParameters[0].rtx = {\n                ssrc: sendEncodingParameters[0].ssrc + 1,\n              };\n            }\n          }\n\n          if (transceiver.wantReceive) {\n            transceiver.rtpReceiver = new window.RTCRtpReceiver(\n                transceiver.dtlsTransport, kind);\n          }\n\n          transceiver.localCapabilities = localCapabilities;\n          transceiver.sendEncodingParameters = sendEncodingParameters;\n        });\n\n        // always offer BUNDLE and dispose on return if not supported.\n        if (pc._config.bundlePolicy !== 'max-compat') {\n          sdp += `a=group:BUNDLE ${pc.transceivers.map((t) => t.mid).join(' ')}\\r\\n`;\n        }\n        sdp += 'a=ice-options:trickle\\r\\n';\n\n        pc.transceivers.forEach((transceiver, sdpMLineIndex) => {\n          sdp += writeMediaSection(transceiver, transceiver.localCapabilities,\n              'offer', transceiver.stream, pc._dtlsRole);\n          sdp += 'a=rtcp-rsize\\r\\n';\n\n          if (transceiver.iceGatherer && pc.iceGatheringState !== 'new' &&\n\t\t\t\t\t\t(sdpMLineIndex === 0 || !pc.usingBundle)) {\n            transceiver.iceGatherer.getLocalCandidates().forEach((cand) => {\n              cand.component = 1;\n              sdp += `a=${SDPUtils.writeCandidate(cand)}\\r\\n`;\n            });\n\n            if (transceiver.iceGatherer.state === 'completed') {\n              sdp += 'a=end-of-candidates\\r\\n';\n            }\n          }\n        });\n\n        const desc = new window.RTCSessionDescription({\n          type: 'offer',\n          sdp,\n        });\n        return Promise.resolve(desc);\n      };\n\n      RTCPeerConnection.prototype.createAnswer = function () {\n        const pc = this;\n\n        if (pc._isClosed) {\n          return Promise.reject(makeError('InvalidStateError',\n              'Can not call createAnswer after close'));\n        }\n\n        if (!(pc.signalingState === 'have-remote-offer' ||\n\t\t\t\t\tpc.signalingState === 'have-local-pranswer')) {\n          return Promise.reject(makeError('InvalidStateError',\n              `Can not call createAnswer in signalingState ${pc.signalingState}`));\n        }\n\n        let sdp = SDPUtils.writeSessionBoilerplate(pc._sdpSessionId,\n            pc._sdpSessionVersion++);\n        if (pc.usingBundle) {\n          sdp += `a=group:BUNDLE ${pc.transceivers.map((t) => t.mid).join(' ')}\\r\\n`;\n        }\n        sdp += 'a=ice-options:trickle\\r\\n';\n\n        const mediaSectionsInOffer = SDPUtils.getMediaSections(\n            pc._remoteDescription.sdp).length;\n        pc.transceivers.forEach((transceiver, sdpMLineIndex) => {\n          if (sdpMLineIndex + 1 > mediaSectionsInOffer) {\n            return;\n          }\n          if (transceiver.rejected) {\n            if (transceiver.kind === 'application') {\n              if (transceiver.protocol === 'DTLS/SCTP') { // legacy fmt\n                sdp += 'm=application 0 DTLS/SCTP 5000\\r\\n';\n              } else {\n                sdp += `m=application 0 ${transceiver.protocol\n                } webrtc-datachannel\\r\\n`;\n              }\n            } else if (transceiver.kind === 'audio') {\n              sdp += 'm=audio 0 UDP/TLS/RTP/SAVPF 0\\r\\n' +\n\t\t\t\t\t\t\t\t'a=rtpmap:0 PCMU/8000\\r\\n';\n            } else if (transceiver.kind === 'video') {\n              sdp += 'm=video 0 UDP/TLS/RTP/SAVPF 120\\r\\n' +\n\t\t\t\t\t\t\t\t'a=rtpmap:120 VP8/90000\\r\\n';\n            }\n            sdp += `${'c=IN IP4 0.0.0.0\\r\\n' +\n\t\t\t\t\t\t\t'a=inactive\\r\\n' +\n\t\t\t\t\t\t\t'a=mid:'}${transceiver.mid}\\r\\n`;\n            return;\n          }\n\n          // FIXME: look at direction.\n          if (transceiver.stream) {\n            let localTrack;\n            if (transceiver.kind === 'audio') {\n              localTrack = transceiver.stream.getAudioTracks()[0];\n            } else if (transceiver.kind === 'video') {\n              localTrack = transceiver.stream.getVideoTracks()[0];\n            }\n            if (localTrack) {\n            // add RTX\n              if (edgeVersion >= 15019 && transceiver.kind === 'video' &&\n\t\t\t\t\t\t\t\t!transceiver.sendEncodingParameters[0].rtx) {\n                transceiver.sendEncodingParameters[0].rtx = {\n                  ssrc: transceiver.sendEncodingParameters[0].ssrc + 1,\n                };\n              }\n            }\n          }\n\n          // Calculate intersection of capabilities.\n          const commonCapabilities = getCommonCapabilities(\n              transceiver.localCapabilities,\n              transceiver.remoteCapabilities);\n\n          const hasRtx = commonCapabilities.codecs.filter((c) => c.name.toLowerCase() === 'rtx').length;\n          if (!hasRtx && transceiver.sendEncodingParameters[0].rtx) {\n            delete transceiver.sendEncodingParameters[0].rtx;\n          }\n\n          sdp += writeMediaSection(transceiver, commonCapabilities,\n              'answer', transceiver.stream, pc._dtlsRole);\n          if (transceiver.rtcpParameters &&\n\t\t\t\t\t\ttransceiver.rtcpParameters.reducedSize) {\n            sdp += 'a=rtcp-rsize\\r\\n';\n          }\n        });\n\n        const desc = new window.RTCSessionDescription({\n          type: 'answer',\n          sdp,\n        });\n        return Promise.resolve(desc);\n      };\n\n      RTCPeerConnection.prototype.addIceCandidate = function (candidate) {\n        const pc = this;\n        let sections;\n        if (candidate && !(candidate.sdpMLineIndex !== undefined ||\n\t\t\t\t\tcandidate.sdpMid)) {\n          return Promise.reject(new TypeError('sdpMLineIndex or sdpMid required'));\n        }\n\n        // TODO: needs to go into ops queue.\n        return new Promise((resolve, reject) => {\n          if (!pc._remoteDescription) {\n            return reject(makeError('InvalidStateError',\n                'Can not add ICE candidate without a remote description'));\n          } else if (!candidate || candidate.candidate === '') {\n            for (let j = 0; j < pc.transceivers.length; j++) {\n              if (pc.transceivers[j].rejected) {\n                continue;\n              }\n              pc.transceivers[j].iceTransport.addRemoteCandidate({});\n              sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n              sections[j] += 'a=end-of-candidates\\r\\n';\n              pc._remoteDescription.sdp =\n\t\t\t\t\t\t\t\tSDPUtils.getDescription(pc._remoteDescription.sdp) +\n\t\t\t\t\t\t\t\tsections.join('');\n              if (pc.usingBundle) {\n                break;\n              }\n            }\n          } else {\n            let sdpMLineIndex = candidate.sdpMLineIndex;\n            if (candidate.sdpMid) {\n              for (let i = 0; i < pc.transceivers.length; i++) {\n                if (pc.transceivers[i].mid === candidate.sdpMid) {\n                  sdpMLineIndex = i;\n                  break;\n                }\n              }\n            }\n            const transceiver = pc.transceivers[sdpMLineIndex];\n            if (transceiver) {\n              if (transceiver.rejected) {\n                return resolve();\n              }\n              const cand = Object.keys(candidate.candidate).length > 0\n                ? SDPUtils.parseCandidate(candidate.candidate) : {};\n              // Ignore Chrome's invalid candidates since Edge does not like them.\n              if (cand.protocol === 'tcp' && (cand.port === 0 || cand.port === 9)) {\n                return resolve();\n              }\n              // Ignore RTCP candidates, we assume RTCP-MUX.\n              if (cand.component && cand.component !== 1) {\n                return resolve();\n              }\n              // when using bundle, avoid adding candidates to the wrong\n              // ice transport. And avoid adding candidates added in the SDP.\n              if (sdpMLineIndex === 0 || (sdpMLineIndex > 0 &&\n\t\t\t\t\t\t\t\ttransceiver.iceTransport !== pc.transceivers[0].iceTransport)) {\n                if (!maybeAddCandidate(transceiver.iceTransport, cand)) {\n                  return reject(makeError('OperationError',\n                      'Can not add ICE candidate'));\n                }\n              }\n\n              // update the remoteDescription.\n              let candidateString = candidate.candidate.trim();\n              if (candidateString.indexOf('a=') === 0) {\n                candidateString = candidateString.substr(2);\n              }\n              sections = SDPUtils.getMediaSections(pc._remoteDescription.sdp);\n              sections[sdpMLineIndex] += `a=${\n                cand.type ? candidateString : 'end-of-candidates'\n\t\t\t\t\t\t\t\t }\\r\\n`;\n              pc._remoteDescription.sdp =\n\t\t\t\t\t\t\t\tSDPUtils.getDescription(pc._remoteDescription.sdp) +\n\t\t\t\t\t\t\t\tsections.join('');\n            } else {\n              return reject(makeError('OperationError',\n                  'Can not add ICE candidate'));\n            }\n          }\n          resolve();\n        });\n      };\n\n      RTCPeerConnection.prototype.getStats = function (selector) {\n        if (selector && selector instanceof window.MediaStreamTrack) {\n          let senderOrReceiver = null;\n          this.transceivers.forEach((transceiver) => {\n            if (transceiver.rtpSender &&\n\t\t\t\t\t\t\ttransceiver.rtpSender.track === selector) {\n              senderOrReceiver = transceiver.rtpSender;\n            } else if (transceiver.rtpReceiver &&\n\t\t\t\t\t\t\ttransceiver.rtpReceiver.track === selector) {\n              senderOrReceiver = transceiver.rtpReceiver;\n            }\n          });\n          if (!senderOrReceiver) {\n            throw makeError('InvalidAccessError', 'Invalid selector.');\n          }\n          return senderOrReceiver.getStats();\n        }\n\n        const promises = [];\n        this.transceivers.forEach((transceiver) => {\n          ['rtpSender',\n            'rtpReceiver',\n            'iceGatherer',\n            'iceTransport',\n            'dtlsTransport'].forEach((method) => {\n            if (transceiver[method]) {\n              promises.push(transceiver[method].getStats());\n            }\n          });\n        });\n        return Promise.all(promises).then((allStats) => {\n          const results = new Map();\n          allStats.forEach((stats) => {\n            stats.forEach((stat) => {\n              results.set(stat.id, stat);\n            });\n          });\n          return results;\n        });\n      };\n\n      // fix low-level stat names and return Map instead of object.\n      const ortcObjects = ['RTCRtpSender',\n        'RTCRtpReceiver',\n        'RTCIceGatherer',\n        'RTCIceTransport',\n        'RTCDtlsTransport'];\n      ortcObjects.forEach((ortcObjectName) => {\n        const obj = window[ortcObjectName];\n        if (obj && obj.prototype && obj.prototype.getStats) {\n          const nativeGetstats = obj.prototype.getStats;\n          obj.prototype.getStats = function () {\n            return nativeGetstats.apply(this)\n                .then((nativeStats) => {\n                  const mapStats = new Map();\n                  Object.keys(nativeStats).forEach((id) => {\n                    nativeStats[id].type = fixStatsType(nativeStats[id]);\n                    mapStats.set(id, nativeStats[id]);\n                  });\n                  return mapStats;\n                });\n          };\n        }\n      });\n\n      // legacy callback shims. Should be moved to adapter.js some days.\n      let methods = ['createOffer', 'createAnswer'];\n      methods.forEach((method) => {\n        const nativeMethod = RTCPeerConnection.prototype[method];\n        RTCPeerConnection.prototype[method] = function () {\n          const args = arguments;\n          if (typeof args[0] === 'function' ||\n\t\t\t\t\t\ttypeof args[1] === 'function') { // legacy\n            return nativeMethod.apply(this, [arguments[2]])\n                .then((description) => {\n                  if (typeof args[0] === 'function') {\n                    args[0].apply(null, [description]);\n                  }\n                }, (error) => {\n                  if (typeof args[1] === 'function') {\n                    args[1].apply(null, [error]);\n                  }\n                });\n          }\n          return nativeMethod.apply(this, arguments);\n        };\n      });\n\n      methods = ['setLocalDescription', 'setRemoteDescription', 'addIceCandidate'];\n      methods.forEach((method) => {\n        const nativeMethod = RTCPeerConnection.prototype[method];\n        RTCPeerConnection.prototype[method] = function () {\n          const args = arguments;\n          if (typeof args[1] === 'function' ||\n\t\t\t\t\t\ttypeof args[2] === 'function') { // legacy\n            return nativeMethod.apply(this, arguments)\n                .then(() => {\n                  if (typeof args[1] === 'function') {\n                    args[1].apply(null);\n                  }\n                }, (error) => {\n                  if (typeof args[2] === 'function') {\n                    args[2].apply(null, [error]);\n                  }\n                });\n          }\n          return nativeMethod.apply(this, arguments);\n        };\n      });\n\n      // getStats is special. It doesn't have a spec legacy method yet we support\n      // getStats(something, cb) without error callbacks.\n      ['getStats'].forEach((method) => {\n        const nativeMethod = RTCPeerConnection.prototype[method];\n        RTCPeerConnection.prototype[method] = function () {\n          const args = arguments;\n          if (typeof args[1] === 'function') {\n            return nativeMethod.apply(this, arguments)\n                .then(() => {\n                  if (typeof args[1] === 'function') {\n                    args[1].apply(null);\n                  }\n                });\n          }\n          return nativeMethod.apply(this, arguments);\n        };\n      });\n\n      return RTCPeerConnection;\n    };\n  }, {sdp: 17}], 17: [function (require, module, exports) {\n\t /* eslint-env node */\n    'use strict';\n\n    // SDP helpers.\n    const SDPUtils = {};\n\n    // Generate an alphanumeric identifier for cname or mids.\n    // TODO: use UUIDs instead? https://gist.github.com/jed/982883\n    SDPUtils.generateIdentifier = function () {\n      return Math.random().toString(36).substr(2, 10);\n    };\n\n    // The RTCP CNAME used by all peerconnections from the same JS.\n    SDPUtils.localCName = SDPUtils.generateIdentifier();\n\n    // Splits SDP into lines, dealing with both CRLF and LF.\n    SDPUtils.splitLines = function (blob) {\n      return blob.trim().split('\\n').map((line) => line.trim());\n    };\n    // Splits SDP into sessionpart and mediasections. Ensures CRLF.\n    SDPUtils.splitSections = function (blob) {\n      const parts = blob.split('\\nm=');\n      return parts.map((part, index) => `${(index > 0 ? `m=${part}` : part).trim()}\\r\\n`);\n    };\n\n    // returns the session description.\n    SDPUtils.getDescription = function (blob) {\n      const sections = SDPUtils.splitSections(blob);\n      return sections && sections[0];\n    };\n\n    // returns the individual media sections.\n    SDPUtils.getMediaSections = function (blob) {\n      const sections = SDPUtils.splitSections(blob);\n      sections.shift();\n      return sections;\n    };\n\n    // Returns lines that start with a certain prefix.\n    SDPUtils.matchPrefix = function (blob, prefix) {\n      return SDPUtils.splitLines(blob).filter((line) => line.indexOf(prefix) === 0);\n    };\n\n    // Parses an ICE candidate line. Sample input:\n    // candidate:702786350 2 udp 41819902 8.8.8.8 60769 typ relay raddr 8.8.8.8\n    // rport 55996\"\n    SDPUtils.parseCandidate = function (line) {\n      let parts;\n      // Parse both variants.\n      if (line.indexOf('a=candidate:') === 0) {\n        parts = line.substring(12).split(' ');\n      } else {\n        parts = line.substring(10).split(' ');\n      }\n\n      const candidate = {\n        foundation: parts[0],\n        component: parseInt(parts[1], 10),\n        protocol: parts[2].toLowerCase(),\n        priority: parseInt(parts[3], 10),\n        ip: parts[4],\n        address: parts[4], // address is an alias for ip.\n        port: parseInt(parts[5], 10),\n        // skip parts[6] == 'typ'\n        type: parts[7],\n      };\n\n      for (let i = 8; i < parts.length; i += 2) {\n        switch (parts[i]) {\n          case 'raddr':\n            candidate.relatedAddress = parts[i + 1];\n            break;\n          case 'rport':\n            candidate.relatedPort = parseInt(parts[i + 1], 10);\n            break;\n          case 'tcptype':\n            candidate.tcpType = parts[i + 1];\n            break;\n          case 'ufrag':\n            candidate.ufrag = parts[i + 1]; // for backward compability.\n            candidate.usernameFragment = parts[i + 1];\n            break;\n          default: // extension handling, in particular ufrag\n            candidate[parts[i]] = parts[i + 1];\n            break;\n        }\n      }\n      return candidate;\n    };\n\n    // Translates a candidate object into SDP candidate attribute.\n    SDPUtils.writeCandidate = function (candidate) {\n      const sdp = [];\n      sdp.push(candidate.foundation);\n      sdp.push(candidate.component);\n      sdp.push(candidate.protocol.toUpperCase());\n      sdp.push(candidate.priority);\n      sdp.push(candidate.address || candidate.ip);\n      sdp.push(candidate.port);\n\n      const type = candidate.type;\n      sdp.push('typ');\n      sdp.push(type);\n      if (type !== 'host' && candidate.relatedAddress &&\n\t\t\t\tcandidate.relatedPort) {\n        sdp.push('raddr');\n        sdp.push(candidate.relatedAddress);\n        sdp.push('rport');\n        sdp.push(candidate.relatedPort);\n      }\n      if (candidate.tcpType && candidate.protocol.toLowerCase() === 'tcp') {\n        sdp.push('tcptype');\n        sdp.push(candidate.tcpType);\n      }\n      if (candidate.usernameFragment || candidate.ufrag) {\n        sdp.push('ufrag');\n        sdp.push(candidate.usernameFragment || candidate.ufrag);\n      }\n      return `candidate:${sdp.join(' ')}`;\n    };\n\n    // Parses an ice-options line, returns an array of option tags.\n    // a=ice-options:foo bar\n    SDPUtils.parseIceOptions = function (line) {\n      return line.substr(14).split(' ');\n    };\n\n    // Parses an rtpmap line, returns RTCRtpCoddecParameters. Sample input:\n    // a=rtpmap:111 opus/48000/2\n    SDPUtils.parseRtpMap = function (line) {\n      let parts = line.substr(9).split(' ');\n      const parsed = {\n        payloadType: parseInt(parts.shift(), 10), // was: id\n      };\n\n      parts = parts[0].split('/');\n\n      parsed.name = parts[0];\n      parsed.clockRate = parseInt(parts[1], 10); // was: clockrate\n      parsed.channels = parts.length === 3 ? parseInt(parts[2], 10) : 1;\n      // legacy alias, got renamed back to channels in ORTC.\n      parsed.numChannels = parsed.channels;\n      return parsed;\n    };\n\n    // Generate an a=rtpmap line from RTCRtpCodecCapability or\n    // RTCRtpCodecParameters.\n    SDPUtils.writeRtpMap = function (codec) {\n      let pt = codec.payloadType;\n      if (codec.preferredPayloadType !== undefined) {\n        pt = codec.preferredPayloadType;\n      }\n      const channels = codec.channels || codec.numChannels || 1;\n      return `a=rtpmap:${pt} ${codec.name}/${codec.clockRate\n      }${channels !== 1 ? `/${channels}` : ''}\\r\\n`;\n    };\n\n    // Parses an a=extmap line (headerextension from RFC 5285). Sample input:\n    // a=extmap:2 urn:ietf:params:rtp-hdrext:toffset\n    // a=extmap:2/sendonly urn:ietf:params:rtp-hdrext:toffset\n    SDPUtils.parseExtmap = function (line) {\n      const parts = line.substr(9).split(' ');\n      return {\n        id: parseInt(parts[0], 10),\n        direction: parts[0].indexOf('/') > 0 ? parts[0].split('/')[1] : 'sendrecv',\n        uri: parts[1],\n      };\n    };\n\n    // Generates a=extmap line from RTCRtpHeaderExtensionParameters or\n    // RTCRtpHeaderExtension.\n    SDPUtils.writeExtmap = function (headerExtension) {\n      return `a=extmap:${headerExtension.id || headerExtension.preferredId\n      }${headerExtension.direction && headerExtension.direction !== 'sendrecv'\n        ? `/${headerExtension.direction}`\n        : ''\n      } ${headerExtension.uri}\\r\\n`;\n    };\n\n    // Parses an ftmp line, returns dictionary. Sample input:\n    // a=fmtp:96 vbr=on;cng=on\n    // Also deals with vbr=on; cng=on\n    SDPUtils.parseFmtp = function (line) {\n      const parsed = {};\n      let kv;\n      const parts = line.substr(line.indexOf(' ') + 1).split(';');\n      for (let j = 0; j < parts.length; j++) {\n        kv = parts[j].trim().split('=');\n        parsed[kv[0].trim()] = kv[1];\n      }\n      return parsed;\n    };\n\n    // Generates an a=ftmp line from RTCRtpCodecCapability or RTCRtpCodecParameters.\n    SDPUtils.writeFmtp = function (codec) {\n      let line = '';\n      let pt = codec.payloadType;\n      if (codec.preferredPayloadType !== undefined) {\n        pt = codec.preferredPayloadType;\n      }\n      if (codec.parameters && Object.keys(codec.parameters).length) {\n        const params = [];\n        Object.keys(codec.parameters).forEach((param) => {\n          if (codec.parameters[param]) {\n            params.push(`${param}=${codec.parameters[param]}`);\n          } else {\n            params.push(param);\n          }\n        });\n        line += `a=fmtp:${pt} ${params.join(';')}\\r\\n`;\n      }\n      return line;\n    };\n\n    // Parses an rtcp-fb line, returns RTCPRtcpFeedback object. Sample input:\n    // a=rtcp-fb:98 nack rpsi\n    SDPUtils.parseRtcpFb = function (line) {\n      const parts = line.substr(line.indexOf(' ') + 1).split(' ');\n      return {\n        type: parts.shift(),\n        parameter: parts.join(' '),\n      };\n    };\n    // Generate a=rtcp-fb lines from RTCRtpCodecCapability or RTCRtpCodecParameters.\n    SDPUtils.writeRtcpFb = function (codec) {\n      let lines = '';\n      let pt = codec.payloadType;\n      if (codec.preferredPayloadType !== undefined) {\n        pt = codec.preferredPayloadType;\n      }\n      if (codec.rtcpFeedback && codec.rtcpFeedback.length) {\n      // FIXME: special handling for trr-int?\n        codec.rtcpFeedback.forEach((fb) => {\n          lines += `a=rtcp-fb:${pt} ${fb.type\n          }${fb.parameter && fb.parameter.length ? ` ${fb.parameter}` : ''\n          }\\r\\n`;\n        });\n      }\n      return lines;\n    };\n\n    // Parses an RFC 5576 ssrc media attribute. Sample input:\n    // a=ssrc:3735928559 cname:something\n    SDPUtils.parseSsrcMedia = function (line) {\n      const sp = line.indexOf(' ');\n      const parts = {\n        ssrc: parseInt(line.substr(7, sp - 7), 10),\n      };\n      const colon = line.indexOf(':', sp);\n      if (colon > -1) {\n        parts.attribute = line.substr(sp + 1, colon - sp - 1);\n        parts.value = line.substr(colon + 1);\n      } else {\n        parts.attribute = line.substr(sp + 1);\n      }\n      return parts;\n    };\n\n    SDPUtils.parseSsrcGroup = function (line) {\n      const parts = line.substr(13).split(' ');\n      return {\n        semantics: parts.shift(),\n        ssrcs: parts.map((ssrc) => parseInt(ssrc, 10)),\n      };\n    };\n\n    // Extracts the MID (RFC 5888) from a media section.\n    // returns the MID or undefined if no mid line was found.\n    SDPUtils.getMid = function (mediaSection) {\n      const mid = SDPUtils.matchPrefix(mediaSection, 'a=mid:')[0];\n      if (mid) {\n        return mid.substr(6);\n      }\n    };\n\n    SDPUtils.parseFingerprint = function (line) {\n      const parts = line.substr(14).split(' ');\n      return {\n        algorithm: parts[0].toLowerCase(), // algorithm is case-sensitive in Edge.\n        value: parts[1],\n      };\n    };\n\n    // Extracts DTLS parameters from SDP media section or sessionpart.\n    // FIXME: for consistency with other functions this should only\n    //   get the fingerprint line as input. See also getIceParameters.\n    SDPUtils.getDtlsParameters = function (mediaSection, sessionpart) {\n      const lines = SDPUtils.matchPrefix(mediaSection + sessionpart,\n          'a=fingerprint:');\n      // Note: a=setup line is ignored since we use the 'auto' role.\n      // Note2: 'algorithm' is not case sensitive except in Edge.\n      return {\n        role: 'auto',\n        fingerprints: lines.map(SDPUtils.parseFingerprint),\n      };\n    };\n\n    // Serializes DTLS parameters to SDP.\n    SDPUtils.writeDtlsParameters = function (params, setupType) {\n      let sdp = `a=setup:${setupType}\\r\\n`;\n      params.fingerprints.forEach((fp) => {\n        sdp += `a=fingerprint:${fp.algorithm} ${fp.value}\\r\\n`;\n      });\n      return sdp;\n    };\n    // Parses ICE information from SDP media section or sessionpart.\n    // FIXME: for consistency with other functions this should only\n    //   get the ice-ufrag and ice-pwd lines as input.\n    SDPUtils.getIceParameters = function (mediaSection, sessionpart) {\n      let lines = SDPUtils.splitLines(mediaSection);\n      // Search in session part, too.\n      lines = lines.concat(SDPUtils.splitLines(sessionpart));\n      const iceParameters = {\n        usernameFragment: lines.filter((line) => line.indexOf('a=ice-ufrag:') === 0)[0].substr(12),\n        password: lines.filter((line) => line.indexOf('a=ice-pwd:') === 0)[0].substr(10),\n      };\n      return iceParameters;\n    };\n\n    // Serializes ICE parameters to SDP.\n    SDPUtils.writeIceParameters = function (params) {\n      return `a=ice-ufrag:${params.usernameFragment}\\r\\n` +\n\t\t\t\t`a=ice-pwd:${params.password}\\r\\n`;\n    };\n\n    // Parses the SDP media section and returns RTCRtpParameters.\n    SDPUtils.parseRtpParameters = function (mediaSection) {\n      const description = {\n        codecs: [],\n        headerExtensions: [],\n        fecMechanisms: [],\n        rtcp: [],\n      };\n      const lines = SDPUtils.splitLines(mediaSection);\n      const mline = lines[0].split(' ');\n      for (let i = 3; i < mline.length; i++) { // find all codecs from mline[3..]\n        const pt = mline[i];\n        const rtpmapline = SDPUtils.matchPrefix(\n            mediaSection, `a=rtpmap:${pt} `)[0];\n        if (rtpmapline) {\n          const codec = SDPUtils.parseRtpMap(rtpmapline);\n          const fmtps = SDPUtils.matchPrefix(\n              mediaSection, `a=fmtp:${pt} `);\n          // Only the first a=fmtp:<pt> is considered.\n          codec.parameters = fmtps.length ? SDPUtils.parseFmtp(fmtps[0]) : {};\n          codec.rtcpFeedback = SDPUtils.matchPrefix(\n              mediaSection, `a=rtcp-fb:${pt} `)\n              .map(SDPUtils.parseRtcpFb);\n          description.codecs.push(codec);\n          // parse FEC mechanisms from rtpmap lines.\n          switch (codec.name.toUpperCase()) {\n            case 'RED':\n            case 'ULPFEC':\n              description.fecMechanisms.push(codec.name.toUpperCase());\n              break;\n            default: // only RED and ULPFEC are recognized as FEC mechanisms.\n              break;\n          }\n        }\n      }\n      SDPUtils.matchPrefix(mediaSection, 'a=extmap:').forEach((line) => {\n        description.headerExtensions.push(SDPUtils.parseExtmap(line));\n      });\n      // FIXME: parse rtcp.\n      return description;\n    };\n\n    // Generates parts of the SDP media section describing the capabilities /\n    // parameters.\n    SDPUtils.writeRtpDescription = function (kind, caps) {\n      let sdp = '';\n\n      // Build the mline.\n      sdp += `m=${kind} `;\n      sdp += caps.codecs.length > 0 ? '9' : '0'; // reject if no codecs.\n      sdp += ' UDP/TLS/RTP/SAVPF ';\n      sdp += `${caps.codecs.map((codec) => {\n        if (codec.preferredPayloadType !== undefined) {\n          return codec.preferredPayloadType;\n        }\n        return codec.payloadType;\n      }).join(' ')}\\r\\n`;\n\n      sdp += 'c=IN IP4 0.0.0.0\\r\\n';\n      sdp += 'a=rtcp:9 IN IP4 0.0.0.0\\r\\n';\n\n      // Add a=rtpmap lines for each codec. Also fmtp and rtcp-fb.\n      caps.codecs.forEach((codec) => {\n        sdp += SDPUtils.writeRtpMap(codec);\n        sdp += SDPUtils.writeFmtp(codec);\n        sdp += SDPUtils.writeRtcpFb(codec);\n      });\n      let maxptime = 0;\n      caps.codecs.forEach((codec) => {\n        if (codec.maxptime > maxptime) {\n          maxptime = codec.maxptime;\n        }\n      });\n      if (maxptime > 0) {\n        sdp += `a=maxptime:${maxptime}\\r\\n`;\n      }\n      sdp += 'a=rtcp-mux\\r\\n';\n\n      if (caps.headerExtensions) {\n        caps.headerExtensions.forEach((extension) => {\n          sdp += SDPUtils.writeExtmap(extension);\n        });\n      }\n      // FIXME: write fecMechanisms.\n      return sdp;\n    };\n\n    // Parses the SDP media section and returns an array of\n    // RTCRtpEncodingParameters.\n    SDPUtils.parseRtpEncodingParameters = function (mediaSection) {\n      const encodingParameters = [];\n      const description = SDPUtils.parseRtpParameters(mediaSection);\n      const hasRed = description.fecMechanisms.indexOf('RED') !== -1;\n      const hasUlpfec = description.fecMechanisms.indexOf('ULPFEC') !== -1;\n\n      // filter a=ssrc:... cname:, ignore PlanB-msid\n      const ssrcs = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n          .map((line) => SDPUtils.parseSsrcMedia(line))\n          .filter((parts) => parts.attribute === 'cname');\n      const primarySsrc = ssrcs.length > 0 && ssrcs[0].ssrc;\n      let secondarySsrc;\n\n      const flows = SDPUtils.matchPrefix(mediaSection, 'a=ssrc-group:FID')\n          .map((line) => {\n            const parts = line.substr(17).split(' ');\n            return parts.map((part) => parseInt(part, 10));\n          });\n      if (flows.length > 0 && flows[0].length > 1 && flows[0][0] === primarySsrc) {\n        secondarySsrc = flows[0][1];\n      }\n\n      description.codecs.forEach((codec) => {\n        if (codec.name.toUpperCase() === 'RTX' && codec.parameters.apt) {\n          let encParam = {\n            ssrc: primarySsrc,\n            codecPayloadType: parseInt(codec.parameters.apt, 10),\n          };\n          if (primarySsrc && secondarySsrc) {\n            encParam.rtx = {ssrc: secondarySsrc};\n          }\n          encodingParameters.push(encParam);\n          if (hasRed) {\n            encParam = JSON.parse(JSON.stringify(encParam));\n            encParam.fec = {\n              ssrc: primarySsrc,\n              mechanism: hasUlpfec ? 'red+ulpfec' : 'red',\n            };\n            encodingParameters.push(encParam);\n          }\n        }\n      });\n      if (encodingParameters.length === 0 && primarySsrc) {\n        encodingParameters.push({\n          ssrc: primarySsrc,\n        });\n      }\n\n      // we support both b=AS and b=TIAS but interpret AS as TIAS.\n      let bandwidth = SDPUtils.matchPrefix(mediaSection, 'b=');\n      if (bandwidth.length) {\n        if (bandwidth[0].indexOf('b=TIAS:') === 0) {\n          bandwidth = parseInt(bandwidth[0].substr(7), 10);\n        } else if (bandwidth[0].indexOf('b=AS:') === 0) {\n        // use formula from JSEP to convert b=AS to TIAS value.\n          bandwidth = parseInt(bandwidth[0].substr(5), 10) * 1000 * 0.95 -\n\t\t\t\t\t\t(50 * 40 * 8);\n        } else {\n          bandwidth = undefined;\n        }\n        encodingParameters.forEach((params) => {\n          params.maxBitrate = bandwidth;\n        });\n      }\n      return encodingParameters;\n    };\n\n    // parses http://draft.ortc.org/#rtcrtcpparameters*\n    SDPUtils.parseRtcpParameters = function (mediaSection) {\n      const rtcpParameters = {};\n\n      // Gets the first SSRC. Note tha with RTX there might be multiple\n      // SSRCs.\n      const remoteSsrc = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n          .map((line) => SDPUtils.parseSsrcMedia(line))\n          .filter((obj) => obj.attribute === 'cname')[0];\n      if (remoteSsrc) {\n        rtcpParameters.cname = remoteSsrc.value;\n        rtcpParameters.ssrc = remoteSsrc.ssrc;\n      }\n\n      // Edge uses the compound attribute instead of reducedSize\n      // compound is !reducedSize\n      const rsize = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-rsize');\n      rtcpParameters.reducedSize = rsize.length > 0;\n      rtcpParameters.compound = rsize.length === 0;\n\n      // parses the rtcp-mux attrіbute.\n      // Note that Edge does not support unmuxed RTCP.\n      const mux = SDPUtils.matchPrefix(mediaSection, 'a=rtcp-mux');\n      rtcpParameters.mux = mux.length > 0;\n\n      return rtcpParameters;\n    };\n\n    // parses either a=msid: or a=ssrc:... msid lines and returns\n    // the id of the MediaStream and MediaStreamTrack.\n    SDPUtils.parseMsid = function (mediaSection) {\n      let parts;\n      const spec = SDPUtils.matchPrefix(mediaSection, 'a=msid:');\n      if (spec.length === 1) {\n        parts = spec[0].substr(7).split(' ');\n        return {stream: parts[0], track: parts[1]};\n      }\n      const planB = SDPUtils.matchPrefix(mediaSection, 'a=ssrc:')\n          .map((line) => SDPUtils.parseSsrcMedia(line))\n          .filter((msidParts) => msidParts.attribute === 'msid');\n      if (planB.length > 0) {\n        parts = planB[0].value.split(' ');\n        return {stream: parts[0], track: parts[1]};\n      }\n    };\n\n    // Generate a session ID for SDP.\n    // https://tools.ietf.org/html/draft-ietf-rtcweb-jsep-20#section-5.2.1\n    // recommends using a cryptographically random +ve 64-bit value\n    // but right now this should be acceptable and within the right range\n    SDPUtils.generateSessionId = function () {\n      return Math.random().toString().substr(2, 21);\n    };\n\n    // Write boilder plate for start of SDP\n    // sessId argument is optional - if not supplied it will\n    // be generated randomly\n    // sessVersion is optional and defaults to 2\n    // sessUser is optional and defaults to 'thisisadapterortc'\n    SDPUtils.writeSessionBoilerplate = function (sessId, sessVer, sessUser) {\n      let sessionId;\n      const version = sessVer !== undefined ? sessVer : 2;\n      if (sessId) {\n        sessionId = sessId;\n      } else {\n        sessionId = SDPUtils.generateSessionId();\n      }\n      const user = sessUser || 'thisisadapterortc';\n      // FIXME: sess-id should be an NTP timestamp.\n      return `${'v=0\\r\\n' +\n\t\t\t\t'o='}${user} ${sessionId} ${version\n      } IN IP4 127.0.0.1\\r\\n` +\n\t\t\t\t's=-\\r\\n' +\n\t\t\t\t't=0 0\\r\\n';\n    };\n\n    SDPUtils.writeMediaSection = function (transceiver, caps, type, stream) {\n      let sdp = SDPUtils.writeRtpDescription(transceiver.kind, caps);\n\n      // Map ICE parameters (ufrag, pwd) to SDP.\n      sdp += SDPUtils.writeIceParameters(\n          transceiver.iceGatherer.getLocalParameters());\n\n      // Map DTLS parameters to SDP.\n      sdp += SDPUtils.writeDtlsParameters(\n          transceiver.dtlsTransport.getLocalParameters(),\n          type === 'offer' ? 'actpass' : 'active');\n\n      sdp += `a=mid:${transceiver.mid}\\r\\n`;\n\n      if (transceiver.direction) {\n        sdp += `a=${transceiver.direction}\\r\\n`;\n      } else if (transceiver.rtpSender && transceiver.rtpReceiver) {\n        sdp += 'a=sendrecv\\r\\n';\n      } else if (transceiver.rtpSender) {\n        sdp += 'a=sendonly\\r\\n';\n      } else if (transceiver.rtpReceiver) {\n        sdp += 'a=recvonly\\r\\n';\n      } else {\n        sdp += 'a=inactive\\r\\n';\n      }\n\n      if (transceiver.rtpSender) {\n      // spec.\n        const msid = `msid:${stream.id} ${\n          transceiver.rtpSender.track.id}\\r\\n`;\n        sdp += `a=${msid}`;\n\n        // for Chrome.\n        sdp += `a=ssrc:${transceiver.sendEncodingParameters[0].ssrc\n        } ${msid}`;\n        if (transceiver.sendEncodingParameters[0].rtx) {\n          sdp += `a=ssrc:${transceiver.sendEncodingParameters[0].rtx.ssrc\n          } ${msid}`;\n          sdp += `a=ssrc-group:FID ${\n            transceiver.sendEncodingParameters[0].ssrc} ${\n            transceiver.sendEncodingParameters[0].rtx.ssrc\n          }\\r\\n`;\n        }\n      }\n      // FIXME: this should be written by writeRtpDescription.\n      sdp += `a=ssrc:${transceiver.sendEncodingParameters[0].ssrc\n      } cname:${SDPUtils.localCName}\\r\\n`;\n      if (transceiver.rtpSender && transceiver.sendEncodingParameters[0].rtx) {\n        sdp += `a=ssrc:${transceiver.sendEncodingParameters[0].rtx.ssrc\n        } cname:${SDPUtils.localCName}\\r\\n`;\n      }\n      return sdp;\n    };\n\n    // Gets the direction from the mediaSection or the sessionpart.\n    SDPUtils.getDirection = function (mediaSection, sessionpart) {\n    // Look for sendrecv, sendonly, recvonly, inactive, default to sendrecv.\n      const lines = SDPUtils.splitLines(mediaSection);\n      for (let i = 0; i < lines.length; i++) {\n        switch (lines[i]) {\n          case 'a=sendrecv':\n          case 'a=sendonly':\n          case 'a=recvonly':\n          case 'a=inactive':\n            return lines[i].substr(2);\n          default:\n\t\t\t\t\t// FIXME: What should happen here?\n        }\n      }\n      if (sessionpart) {\n        return SDPUtils.getDirection(sessionpart);\n      }\n      return 'sendrecv';\n    };\n\n    SDPUtils.getKind = function (mediaSection) {\n      const lines = SDPUtils.splitLines(mediaSection);\n      const mline = lines[0].split(' ');\n      return mline[0].substr(2);\n    };\n\n    SDPUtils.isRejected = function (mediaSection) {\n      return mediaSection.split(' ', 2)[1] === '0';\n    };\n\n    SDPUtils.parseMLine = function (mediaSection) {\n      const lines = SDPUtils.splitLines(mediaSection);\n      const parts = lines[0].substr(2).split(' ');\n      return {\n        kind: parts[0],\n        port: parseInt(parts[1], 10),\n        protocol: parts[2],\n        fmt: parts.slice(3).join(' '),\n      };\n    };\n\n    SDPUtils.parseOLine = function (mediaSection) {\n      const line = SDPUtils.matchPrefix(mediaSection, 'o=')[0];\n      const parts = line.substr(2).split(' ');\n      return {\n        username: parts[0],\n        sessionId: parts[1],\n        sessionVersion: parseInt(parts[2], 10),\n        netType: parts[3],\n        addressType: parts[4],\n        address: parts[5],\n      };\n    };\n\n    // a very naive interpretation of a valid SDP.\n    SDPUtils.isValidSDP = function (blob) {\n      if (typeof blob !== 'string' || blob.length === 0) {\n        return false;\n      }\n      const lines = SDPUtils.splitLines(blob);\n      for (let i = 0; i < lines.length; i++) {\n        if (lines[i].length < 2 || lines[i].charAt(1) !== '=') {\n          return false;\n        }\n      // TODO: check the modifier a bit more.\n      }\n      return true;\n    };\n\n    // Expose public methods.\n    if (typeof module === 'object') {\n      module.exports = SDPUtils;\n    }\n  }, {}]}, {}, [1])(1);\n});\n","(function() {\n  if (!navigator.mediaDevices) navigator.mediaDevices = {};\n  if (!navigator.mediaDevices.getUserMedia) {\n    var getUserMedia =\n      navigator.webkitGetUserMedia ||\n      navigator.mozGetUserMedia ||\n      navigator.msGetUserMedia ||\n      navigator.getUserMedia;\n\n    if (getUserMedia) {\n      navigator.mediaDevices.getUserMedia = function(constraints) {\n        return new Promise(function(resolve, reject) {\n          getUserMedia(\n            constraints,\n            function(stream) {\n              resolve(stream);\n            },\n            function(error) {\n              reject(error);\n            }\n          );\n        });\n      };\n    } else {\n      navigator.mediaDevices.getUserMedia = function() {\n        // A missing `getUserMedia` seemingly can mean one of two things:\n        //\n        // 1) WebRTC is unsupported or disabled on this browser\n        // 2) This is an insecure connection\n        //   * This handling of insecure connections happens only on certain browsers.\n        //     It was observed in Chromium 80 and Firefox 75, but not Firefox 68. I suspect it's the new behavior.\n        //   * In other browsers, it handles insecure connections by throwing `NotAllowedError`.\n        //     We still handle this case in the calling function.\n        //   * See: https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n        //     As of this writing, this claims that the browser does *both* of these things for\n        //     insecure connections, which is of course impossible and thus confusing.\n        //\n        // We will attempt to distinguish these two cases by checking for various webrtc-related fields on\n        // `window` (inspired by github.com/muaz-khan/DetectRTC). If none of those fields exist, we assume\n        // that WebRTC is not supported on this browser.\n        return new Promise(function(resolve, reject) {\n          if (!(window.RTCPeerConnection || window.webkitRTCPeerConnection || window.mozRTCPeerConnection || window.RTCIceGatherer)) {\n            var e = new Error(\"getUserMedia is not supported in this browser.\");\n            // I'd use NotSupportedError but I'm afraid they'll change the spec on us again\n            e.name = 'CustomNotSupportedError';\n            reject(e);\n          } else {\n            var e = new Error(\"insecure connection\");\n            // I'd use NotAllowedError but I'm afraid they'll change the spec on us again\n            e.name = 'CustomSecureConnectionError';\n            reject(e);\n          }\n        });\n      };\n    }\n  }\n})();","(function(a){var r=a.fn.domManip,d=\"_tmplitem\",q=/^[^<]*(<[\\w\\W]+>)[^>]*$|\\{\\{\\! /,b={},f={},e,p={key:0,data:{}},h=0,c=0,l=[];function g(e,d,g,i){var c={data:i||(d?d.data:{}),_wrap:d?d._wrap:null,tmpl:null,parent:d||null,nodes:[],calls:u,nest:w,wrap:x,html:v,update:t};e&&a.extend(c,e,{nodes:[],parent:d});if(g){c.tmpl=g;c._ctnt=c._ctnt||c.tmpl(a,c);c.key=++h;(l.length?f:b)[h]=c}return c}a.each({appendTo:\"append\",prependTo:\"prepend\",insertBefore:\"before\",insertAfter:\"after\",replaceAll:\"replaceWith\"},function(f,d){a.fn[f]=function(n){var g=[],i=a(n),k,h,m,l,j=this.length===1&&this[0].parentNode;e=b||{};if(j&&j.nodeType===11&&j.childNodes.length===1&&i.length===1){i[d](this[0]);g=this}else{for(h=0,m=i.length;h<m;h++){c=h;k=(h>0?this.clone(true):this).get();a.fn[d].apply(a(i[h]),k);g=g.concat(k)}c=0;g=this.pushStack(g,f,i.selector)}l=e;e=null;a.tmpl.complete(l);return g}});a.fn.extend({tmpl:function(d,c,b){return a.tmpl(this[0],d,c,b)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(d,l,j){if(d[0]&&d[0].nodeType){var f=a.makeArray(arguments),g=d.length,i=0,h;while(i<g&&!(h=a.data(d[i++],\"tmplItem\")));if(g>1)f[0]=[a.makeArray(d)];if(h&&c)f[2]=function(b){a.tmpl.afterManip(this,b,j)};r.apply(this,f)}else r.apply(this,arguments);c=0;!e&&a.tmpl.complete(b);return this}});a.extend({tmpl:function(d,h,e,c){var j,k=!c;if(k){c=p;d=a.template[d]||a.template(null,d);f={}}else if(!d){d=c.tmpl;b[c.key]=c;c.nodes=[];c.wrapped&&n(c,c.wrapped);return a(i(c,null,c.tmpl(a,c)))}if(!d)return[];if(typeof h===\"function\")h=h.call(c||{});e&&e.wrapped&&n(e,e.wrapped);j=a.isArray(h)?a.map(h,function(a){return a?g(e,c,d,a):null}):[g(e,c,d,h)];return k?a(i(c,null,j)):j},tmplItem:function(b){var c;if(b instanceof a)b=b[0];while(b&&b.nodeType===1&&!(c=a.data(b,\"tmplItem\"))&&(b=b.parentNode));return c||p},template:function(c,b){if(b){if(typeof b===\"string\")b=o(b);else if(b instanceof a)b=b[0]||{};if(b.nodeType)b=a.data(b,\"tmpl\")||a.data(b,\"tmpl\",o(b.innerHTML));return typeof c===\"string\"?(a.template[c]=b):b}return c?typeof c!==\"string\"?a.template(null,c):a.template[c]||a.template(null,q.test(c)?c:a(c)):null},encode:function(a){return(\"\"+a).split(\"<\").join(\"&lt;\").split(\">\").join(\"&gt;\").split('\"').join(\"&#34;\").split(\"'\").join(\"&#39;\")}});a.extend(a.tmpl,{tag:{tmpl:{_default:{$2:\"null\"},open:\"if($notnull_1){_=_.concat($item.nest($1,$2));}\"},wrap:{_default:{$2:\"null\"},open:\"$item.calls(_,$1,$2);_=[];\",close:\"call=$item.calls();_=call._.concat($item.wrap(call,_));\"},each:{_default:{$2:\"$index, $value\"},open:\"if($notnull_1){$.each($1a,function($2){with(this){\",close:\"}});}\"},\"if\":{open:\"if(($notnull_1) && $1a){\",close:\"}\"},\"else\":{_default:{$1:\"true\"},open:\"}else if(($notnull_1) && $1a){\"},html:{open:\"if($notnull_1){_.push($1a);}\"},\"=\":{_default:{$1:\"$data\"},open:\"if($notnull_1){_.push($.encode($1a));}\"},\"!\":{open:\"\"}},complete:function(){b={}},afterManip:function(f,b,d){var e=b.nodeType===11?a.makeArray(b.childNodes):b.nodeType===1?[b]:[];d.call(f,b);m(e);c++}});function i(e,g,f){var b,c=f?a.map(f,function(a){return typeof a===\"string\"?e.key?a.replace(/(<\\w+)(?=[\\s>])(?![^>]*_tmplitem)([^>]*)/g,\"$1 \"+d+'=\"'+e.key+'\" $2'):a:i(a,e,a._ctnt)}):e;if(g)return c;c=c.join(\"\");c.replace(/^\\s*([^<\\s][^<]*)?(<[\\w\\W]+>)([^>]*[^>\\s])?\\s*$/,function(f,c,e,d){b=a(e).get();m(b);if(c)b=j(c).concat(b);if(d)b=b.concat(j(d))});return b?b:j(c)}function j(c){var b=document.createElement(\"div\");b.innerHTML=c;return a.makeArray(b.childNodes)}function o(b){return new Function(\"jQuery\",\"$item\",\"var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('\"+a.trim(b).replace(/([\\\\'])/g,\"\\\\$1\").replace(/[\\r\\t\\n]/g,\" \").replace(/\\$\\{([^\\}]*)\\}/g,\"{{= $1}}\").replace(/\\{\\{(\\/?)(\\w+|.)(?:\\(((?:[^\\}]|\\}(?!\\}))*?)?\\))?(?:\\s+(.*?)?)?(\\(((?:[^\\}]|\\}(?!\\}))*?)\\))?\\s*\\}\\}/g,function(m,l,j,d,b,c,e){var i=a.tmpl.tag[j],h,f,g;if(!i)throw\"Template command not found: \"+j;h=i._default||[];if(c&&!/\\w$/.test(b)){b+=c;c=\"\"}if(b){b=k(b);e=e?\",\"+k(e)+\")\":c?\")\":\"\";f=c?b.indexOf(\".\")>-1?b+c:\"(\"+b+\").call($item\"+e:b;g=c?f:\"(typeof(\"+b+\")==='function'?(\"+b+\").call($item):(\"+b+\"))\"}else g=f=h.$1||\"null\";d=k(d);return\"');\"+i[l?\"close\":\"open\"].split(\"$notnull_1\").join(b?\"typeof(\"+b+\")!=='undefined' && (\"+b+\")!=null\":\"true\").split(\"$1a\").join(g).split(\"$1\").join(f).split(\"$2\").join(d?d.replace(/\\s*([^\\(]+)\\s*(\\((.*?)\\))?/g,function(d,c,b,a){a=a?\",\"+a+\")\":b?\")\":\"\";return a?\"(\"+c+\").call($item\"+a:d}):h.$2||\"\")+\"_.push('\"})+\"');}return _;\")}function n(c,b){c._wrap=i(c,true,a.isArray(b)?b:[q.test(b)?b:a(b).html()]).join(\"\")}function k(a){return a?a.replace(/\\\\'/g,\"'\").replace(/\\\\\\\\/g,\"\\\\\"):null}function s(b){var a=document.createElement(\"div\");a.appendChild(b.cloneNode(true));return a.innerHTML}function m(o){var n=\"_\"+c,k,j,l={},e,p,i;for(e=0,p=o.length;e<p;e++){if((k=o[e]).nodeType!==1)continue;j=k.getElementsByTagName(\"*\");for(i=j.length-1;i>=0;i--)m(j[i]);m(k)}function m(j){var p,i=j,k,e,m;if(m=j.getAttribute(d)){while(i.parentNode&&(i=i.parentNode).nodeType===1&&!(p=i.getAttribute(d)));if(p!==m){i=i.parentNode?i.nodeType===11?0:i.getAttribute(d)||0:0;if(!(e=b[m])){e=f[m];e=g(e,b[i]||f[i],null,true);e.key=++h;b[h]=e}c&&o(m)}j.removeAttribute(d)}else if(c&&(e=a.data(j,\"tmplItem\"))){o(e.key);b[e.key]=e;i=a.data(j.parentNode,\"tmplItem\");i=i?i.key:0}if(e){k=e;while(k&&k.key!=i){k.nodes.push(j);k=k.parent}delete e._ctnt;delete e._wrap;a.data(j,\"tmplItem\",e)}function o(a){a=a+n;e=l[a]=l[a]||g(e,b[e.parent.key+n]||e.parent,null,true)}}}function u(a,d,c,b){if(!a)return l.pop();l.push({_:a,tmpl:d,item:this,data:c,options:b})}function w(d,c,b){return a.tmpl(a.template(d),c,b,this)}function x(b,d){var c=b.options||{};c.wrapped=d;return a.tmpl(a.template(b.tmpl),b.data,c,b.item)}function v(d,c){var b=this._wrap;return a.map(a(a.isArray(b)?b.join(\"\"):b).filter(d||\"*\"),function(a){return c?a.innerText||a.textContent:a.outerHTML||s(a)})}function t(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]);a(b).remove()}})(jQuery)","'use strict';\n\n// Last time updated: 2019-02-20 3:31:30 PM UTC\n\n// _______________\n// getStats v1.2.0\n\n// Open-Sourced: https://github.com/muaz-khan/getStats\n\n// --------------------------------------------------\n// Muaz Khan     - www.MuazKhan.com\n// MIT License   - www.WebRTC-Experiment.com/licence\n// --------------------------------------------------\n\n\"use strict\";var getStats=function(mediaStreamTrack,callback,interval){function getStatsLooper(){getStatsWrapper(function(results){if(results&&results.forEach){results.forEach(function(result){Object.keys(getStatsParser).forEach(function(key){if(\"function\"==typeof getStatsParser[key])try{getStatsParser[key](result)}catch(e){console.error(e.message,e.stack,e)}})});try{peer.iceConnectionState.search(/failed|closed|disconnected/gi)!==-1&&(nomore=!0)}catch(e){nomore=!0}nomore===!0&&(getStatsResult.datachannel&&(getStatsResult.datachannel.state=\"close\"),getStatsResult.ended=!0),getStatsResult.results=results,getStatsResult.audio&&getStatsResult.video&&(getStatsResult.bandwidth.speed=getStatsResult.audio.bytesSent-getStatsResult.bandwidth.helper.audioBytesSent+(getStatsResult.video.bytesSent-getStatsResult.bandwidth.helper.videoBytesSent),getStatsResult.bandwidth.helper.audioBytesSent=getStatsResult.audio.bytesSent,getStatsResult.bandwidth.helper.videoBytesSent=getStatsResult.video.bytesSent),callback(getStatsResult),nomore||void 0!=typeof interval&&interval&&setTimeout(getStatsLooper,interval||1e3)}})}function getStatsWrapper(cb){\"undefined\"!=typeof window.InstallTrigger||isSafari?peer.getStats(window.mediaStreamTrack||null).then(function(res){var items=[];res.forEach(function(r){items.push(r)}),cb(items)})[\"catch\"](cb):peer.getStats(function(res){var items=[];res.result().forEach(function(res){var item={};res.names().forEach(function(name){item[name]=res.stat(name)}),item.id=res.id,item.type=res.type,item.timestamp=res.timestamp,items.push(item)}),cb(items)})}var browserFakeUserAgent=\"Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45\";!function(that){that&&\"undefined\"==typeof window&&\"undefined\"!=typeof global&&(global.navigator={userAgent:browserFakeUserAgent,getUserMedia:function(){}},global.console||(global.console={}),\"undefined\"!=typeof global.console.log&&\"undefined\"!=typeof global.console.error||(global.console.error=global.console.log=global.console.log||function(){console.log(arguments)}),\"undefined\"==typeof document&&(that.document={documentElement:{appendChild:function(){return\"\"}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var obj={getContext:function(){return obj},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return\"\"}};return obj},that.HTMLVideoElement=function(){}),\"undefined\"==typeof location&&(that.location={protocol:\"file:\",href:\"\",hash:\"\"}),\"undefined\"==typeof screen&&(that.screen={width:0,height:0}),\"undefined\"==typeof URL&&(that.URL={createObjectURL:function(){return\"\"},revokeObjectURL:function(){return\"\"}}),\"undefined\"==typeof MediaStreamTrack&&(that.MediaStreamTrack=function(){}),\"undefined\"==typeof RTCPeerConnection&&(that.RTCPeerConnection=function(){}),that.window=global)}(\"undefined\"!=typeof global?global:null);var RTCPeerConnection=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;\"undefined\"==typeof MediaStreamTrack&&(MediaStreamTrack={});var systemNetworkType=((navigator.connection||{}).type||\"unknown\").toString().toLowerCase(),getStatsResult={encryption:\"sha-256\",audio:{send:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},recv:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},bytesSent:0,bytesReceived:0,latency:0,packetsLost:0},video:{send:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},recv:{tracks:[],codecs:[],availableBandwidth:0,streams:0,framerateMean:0,bitrateMean:0},bytesSent:0,bytesReceived:0,latency:0,packetsLost:0},bandwidth:{systemBandwidth:0,sentPerSecond:0,encodedPerSecond:0,helper:{audioBytesSent:0,videoBytestSent:0},speed:0},results:{},connectionType:{systemNetworkType:systemNetworkType,systemIpAddress:\"192.168.1.2\",local:{candidateType:[],transport:[],ipAddress:[],networkType:[]},remote:{candidateType:[],transport:[],ipAddress:[],networkType:[]}},resolutions:{send:{width:0,height:0},recv:{width:0,height:0}},internal:{audio:{send:{},recv:{}},video:{send:{},recv:{}},candidates:{}},nomore:function(){nomore=!0}},getStatsParser={checkIfOfferer:function(result){\"googLibjingleSession\"===result.type&&(getStatsResult.isOfferer=result.googInitiator)}},isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),peer=this;if(!(arguments[0]instanceof RTCPeerConnection))throw\"1st argument is not instance of RTCPeerConnection.\";peer=arguments[0],arguments[1]instanceof MediaStreamTrack&&(mediaStreamTrack=arguments[1],callback=arguments[2],interval=arguments[3]);var nomore=!1;getStatsParser.datachannel=function(result){\"datachannel\"===result.type&&(getStatsResult.datachannel={state:result.state})},getStatsParser.googCertificate=function(result){\"googCertificate\"==result.type&&(getStatsResult.encryption=result.googFingerprintAlgorithm),\"certificate\"==result.type&&(getStatsResult.encryption=result.fingerprintAlgorithm)},getStatsParser.checkAudioTracks=function(result){if(\"audio\"===result.mediaType){var sendrecvType=result.id.split(\"_\").pop();if(result.isRemote===!0&&(sendrecvType=\"recv\"),result.isRemote===!1&&(sendrecvType=\"send\"),sendrecvType){if(getStatsResult.audio[sendrecvType].codecs.indexOf(result.googCodecName||\"opus\")===-1&&getStatsResult.audio[sendrecvType].codecs.push(result.googCodecName||\"opus\"),result.bytesSent){var kilobytes=0;getStatsResult.internal.audio[sendrecvType].prevBytesSent||(getStatsResult.internal.audio[sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal.audio[sendrecvType].prevBytesSent;getStatsResult.internal.audio[sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult.audio[sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult.audio.bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal.audio[sendrecvType].prevBytesReceived||(getStatsResult.internal.audio[sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal.audio[sendrecvType].prevBytesReceived;getStatsResult.internal.audio[sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult.audio.bytesReceived=kilobytes.toFixed(1)}if(result.googTrackId&&getStatsResult.audio[sendrecvType].tracks.indexOf(result.googTrackId)===-1&&getStatsResult.audio[sendrecvType].tracks.push(result.googTrackId),result.googCurrentDelayMs){var kilobytes=0;getStatsResult.internal.audio.prevGoogCurrentDelayMs||(getStatsResult.internal.audio.prevGoogCurrentDelayMs=result.googCurrentDelayMs);var bytes=result.googCurrentDelayMs-getStatsResult.internal.audio.prevGoogCurrentDelayMs;getStatsResult.internal.audio.prevGoogCurrentDelayMs=result.googCurrentDelayMs,getStatsResult.audio.latency=bytes.toFixed(1),getStatsResult.audio.latency<0&&(getStatsResult.audio.latency=0)}if(result.packetsLost){var kilobytes=0;getStatsResult.internal.audio.prevPacketsLost||(getStatsResult.internal.audio.prevPacketsLost=result.packetsLost);var bytes=result.packetsLost-getStatsResult.internal.audio.prevPacketsLost;getStatsResult.internal.audio.prevPacketsLost=result.packetsLost,getStatsResult.audio.packetsLost=bytes.toFixed(1),getStatsResult.audio.packetsLost<0&&(getStatsResult.audio.packetsLost=0)}}}},getStatsParser.checkVideoTracks=function(result){if(\"video\"===result.mediaType){var sendrecvType=result.id.split(\"_\").pop();if(result.isRemote===!0&&(sendrecvType=\"recv\"),result.isRemote===!1&&(sendrecvType=\"send\"),sendrecvType){if(getStatsResult.video[sendrecvType].codecs.indexOf(result.googCodecName||\"VP8\")===-1&&getStatsResult.video[sendrecvType].codecs.push(result.googCodecName||\"VP8\"),result.bytesSent){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBytesSent||(getStatsResult.internal.video[sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal.video[sendrecvType].prevBytesSent;getStatsResult.internal.video[sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult.video[sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult.video.bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBytesReceived||(getStatsResult.internal.video[sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal.video[sendrecvType].prevBytesReceived;getStatsResult.internal.video[sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult.video.bytesReceived=kilobytes.toFixed(1)}if(result.googFrameHeightReceived&&result.googFrameWidthReceived&&(getStatsResult.resolutions[sendrecvType].width=result.googFrameWidthReceived,getStatsResult.resolutions[sendrecvType].height=result.googFrameHeightReceived),result.googFrameHeightSent&&result.googFrameWidthSent&&(getStatsResult.resolutions[sendrecvType].width=result.googFrameWidthSent,getStatsResult.resolutions[sendrecvType].height=result.googFrameHeightSent),result.googTrackId&&getStatsResult.video[sendrecvType].tracks.indexOf(result.googTrackId)===-1&&getStatsResult.video[sendrecvType].tracks.push(result.googTrackId),result.framerateMean){getStatsResult.bandwidth.framerateMean=result.framerateMean;var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevFramerateMean||(getStatsResult.internal.video[sendrecvType].prevFramerateMean=result.bitrateMean);var bytes=result.bytesSent-getStatsResult.internal.video[sendrecvType].prevFramerateMean;getStatsResult.internal.video[sendrecvType].prevFramerateMean=result.framerateMean,kilobytes=bytes/1024,getStatsResult.video[sendrecvType].framerateMean=bytes.toFixed(1)}if(result.bitrateMean){getStatsResult.bandwidth.bitrateMean=result.bitrateMean;var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBitrateMean||(getStatsResult.internal.video[sendrecvType].prevBitrateMean=result.bitrateMean);var bytes=result.bytesSent-getStatsResult.internal.video[sendrecvType].prevBitrateMean;getStatsResult.internal.video[sendrecvType].prevBitrateMean=result.bitrateMean,kilobytes=bytes/1024,getStatsResult.video[sendrecvType].bitrateMean=bytes.toFixed(1)}if(result.googCurrentDelayMs){var kilobytes=0;getStatsResult.internal.video.prevGoogCurrentDelayMs||(getStatsResult.internal.video.prevGoogCurrentDelayMs=result.googCurrentDelayMs);var bytes=result.googCurrentDelayMs-getStatsResult.internal.video.prevGoogCurrentDelayMs;getStatsResult.internal.video.prevGoogCurrentDelayMs=result.googCurrentDelayMs,getStatsResult.video.latency=bytes.toFixed(1),getStatsResult.video.latency<0&&(getStatsResult.video.latency=0)}if(result.packetsLost){var kilobytes=0;getStatsResult.internal.video.prevPacketsLost||(getStatsResult.internal.video.prevPacketsLost=result.packetsLost);var bytes=result.packetsLost-getStatsResult.internal.video.prevPacketsLost;getStatsResult.internal.video.prevPacketsLost=result.packetsLost,getStatsResult.video.packetsLost=bytes.toFixed(1),getStatsResult.video.packetsLost<0&&(getStatsResult.video.packetsLost=0)}}}},getStatsParser.bweforvideo=function(result){\"VideoBwe\"===result.type&&(getStatsResult.bandwidth.availableSendBandwidth=result.googAvailableSendBandwidth,getStatsResult.bandwidth.googActualEncBitrate=result.googActualEncBitrate,getStatsResult.bandwidth.googAvailableSendBandwidth=result.googAvailableSendBandwidth,getStatsResult.bandwidth.googAvailableReceiveBandwidth=result.googAvailableReceiveBandwidth,getStatsResult.bandwidth.googRetransmitBitrate=result.googRetransmitBitrate,getStatsResult.bandwidth.googTargetEncBitrate=result.googTargetEncBitrate,getStatsResult.bandwidth.googBucketDelay=result.googBucketDelay,getStatsResult.bandwidth.googTransmitBitrate=result.googTransmitBitrate)},getStatsParser.candidatePair=function(result){if(\"googCandidatePair\"===result.type||\"candidate-pair\"===result.type||\"local-candidate\"===result.type||\"remote-candidate\"===result.type){if(\"true\"==result.googActiveConnection){Object.keys(getStatsResult.internal.candidates).forEach(function(cid){var candidate=getStatsResult.internal.candidates[cid];candidate.ipAddress.indexOf(result.googLocalAddress)!==-1&&(getStatsResult.connectionType.local.candidateType=candidate.candidateType,getStatsResult.connectionType.local.ipAddress=candidate.ipAddress,getStatsResult.connectionType.local.networkType=candidate.networkType,getStatsResult.connectionType.local.transport=candidate.transport),candidate.ipAddress.indexOf(result.googRemoteAddress)!==-1&&(getStatsResult.connectionType.remote.candidateType=candidate.candidateType,getStatsResult.connectionType.remote.ipAddress=candidate.ipAddress,getStatsResult.connectionType.remote.networkType=candidate.networkType,getStatsResult.connectionType.remote.transport=candidate.transport)}),getStatsResult.connectionType.transport=result.googTransportType;var localCandidate=getStatsResult.internal.candidates[result.localCandidateId];localCandidate&&localCandidate.ipAddress&&(getStatsResult.connectionType.systemIpAddress=localCandidate.ipAddress);var remoteCandidate=getStatsResult.internal.candidates[result.remoteCandidateId];remoteCandidate&&remoteCandidate.ipAddress&&(getStatsResult.connectionType.systemIpAddress=remoteCandidate.ipAddress)}if(\"candidate-pair\"===result.type&&result.selected===!0&&result.nominated===!0&&\"succeeded\"===result.state)var localCandidate=getStatsResult.internal.candidates[result.remoteCandidateId],remoteCandidate=getStatsResult.internal.candidates[result.remoteCandidateId];if(\"local-candidate\"===result.type&&(getStatsResult.connectionType.local.candidateType=result.candidateType,getStatsResult.connectionType.local.ipAddress=result.ipAddress,getStatsResult.connectionType.local.networkType=result.networkType,getStatsResult.connectionType.local.transport=result.mozLocalTransport||result.transport),\"remote-candidate\"===result.type&&(getStatsResult.connectionType.remote.candidateType=result.candidateType,getStatsResult.connectionType.remote.ipAddress=result.ipAddress,getStatsResult.connectionType.remote.networkType=result.networkType,getStatsResult.connectionType.remote.transport=result.mozRemoteTransport||result.transport),isSafari){var sendrecvType=result.localCandidateId?\"send\":\"recv\";if(!sendrecvType)return;if(result.bytesSent){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBytesSent||(getStatsResult.internal.video[sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal.video[sendrecvType].prevBytesSent;getStatsResult.internal.video[sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult.video[sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult.video.bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevBytesReceived||(getStatsResult.internal.video[sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal.video[sendrecvType].prevBytesReceived;getStatsResult.internal.video[sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult.video.bytesReceived=kilobytes.toFixed(1)}if(result.availableOutgoingBitrate){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevAvailableOutgoingBitrate||(getStatsResult.internal.video[sendrecvType].prevAvailableOutgoingBitrate=result.availableOutgoingBitrate);var bytes=result.availableOutgoingBitrate-getStatsResult.internal.video[sendrecvType].prevAvailableOutgoingBitrate;getStatsResult.internal.video[sendrecvType].prevAvailableOutgoingBitrate=result.availableOutgoingBitrate,kilobytes=bytes/1024,getStatsResult.video.availableOutgoingBitrate=kilobytes.toFixed(1)}if(result.availableIncomingBitrate){var kilobytes=0;getStatsResult.internal.video[sendrecvType].prevAvailableIncomingBitrate||(getStatsResult.internal.video[sendrecvType].prevAvailableIncomingBitrate=result.availableIncomingBitrate);var bytes=result.availableIncomingBitrate-getStatsResult.internal.video[sendrecvType].prevAvailableIncomingBitrate;getStatsResult.internal.video[sendrecvType].prevAvailableIncomingBitrate=result.availableIncomingBitrate,kilobytes=bytes/1024,getStatsResult.video.availableIncomingBitrate=kilobytes.toFixed(1)}}}};var LOCAL_candidateType={},LOCAL_transport={},LOCAL_ipAddress={},LOCAL_networkType={};getStatsParser.localcandidate=function(result){\"localcandidate\"!==result.type&&\"local-candidate\"!==result.type||result.id&&(LOCAL_candidateType[result.id]||(LOCAL_candidateType[result.id]=[]),LOCAL_transport[result.id]||(LOCAL_transport[result.id]=[]),LOCAL_ipAddress[result.id]||(LOCAL_ipAddress[result.id]=[]),LOCAL_networkType[result.id]||(LOCAL_networkType[result.id]=[]),result.candidateType&&LOCAL_candidateType[result.id].indexOf(result.candidateType)===-1&&LOCAL_candidateType[result.id].push(result.candidateType),result.transport&&LOCAL_transport[result.id].indexOf(result.transport)===-1&&LOCAL_transport[result.id].push(result.transport),result.ipAddress&&LOCAL_ipAddress[result.id].indexOf(result.ipAddress+\":\"+result.portNumber)===-1&&LOCAL_ipAddress[result.id].push(result.ipAddress+\":\"+result.portNumber),result.networkType&&LOCAL_networkType[result.id].indexOf(result.networkType)===-1&&LOCAL_networkType[result.id].push(result.networkType),getStatsResult.internal.candidates[result.id]={candidateType:LOCAL_candidateType[result.id],ipAddress:LOCAL_ipAddress[result.id],portNumber:result.portNumber,networkType:LOCAL_networkType[result.id],priority:result.priority,transport:LOCAL_transport[result.id],timestamp:result.timestamp,id:result.id,type:result.type},getStatsResult.connectionType.local.candidateType=LOCAL_candidateType[result.id],getStatsResult.connectionType.local.ipAddress=LOCAL_ipAddress[result.id],getStatsResult.connectionType.local.networkType=LOCAL_networkType[result.id],getStatsResult.connectionType.local.transport=LOCAL_transport[result.id])};var REMOTE_candidateType={},REMOTE_transport={},REMOTE_ipAddress={},REMOTE_networkType={};getStatsParser.remotecandidate=function(result){\"remotecandidate\"!==result.type&&\"remote-candidate\"!==result.type||result.id&&(REMOTE_candidateType[result.id]||(REMOTE_candidateType[result.id]=[]),REMOTE_transport[result.id]||(REMOTE_transport[result.id]=[]),REMOTE_ipAddress[result.id]||(REMOTE_ipAddress[result.id]=[]),REMOTE_networkType[result.id]||(REMOTE_networkType[result.id]=[]),result.candidateType&&REMOTE_candidateType[result.id].indexOf(result.candidateType)===-1&&REMOTE_candidateType[result.id].push(result.candidateType),result.transport&&REMOTE_transport[result.id].indexOf(result.transport)===-1&&REMOTE_transport[result.id].push(result.transport),result.ipAddress&&REMOTE_ipAddress[result.id].indexOf(result.ipAddress+\":\"+result.portNumber)===-1&&REMOTE_ipAddress[result.id].push(result.ipAddress+\":\"+result.portNumber),result.networkType&&REMOTE_networkType[result.id].indexOf(result.networkType)===-1&&REMOTE_networkType[result.id].push(result.networkType),getStatsResult.internal.candidates[result.id]={candidateType:REMOTE_candidateType[result.id],ipAddress:REMOTE_ipAddress[result.id],portNumber:result.portNumber,networkType:REMOTE_networkType[result.id],priority:result.priority,transport:REMOTE_transport[result.id],timestamp:result.timestamp,id:result.id,type:result.type},getStatsResult.connectionType.remote.candidateType=REMOTE_candidateType[result.id],getStatsResult.connectionType.remote.ipAddress=REMOTE_ipAddress[result.id],getStatsResult.connectionType.remote.networkType=REMOTE_networkType[result.id],getStatsResult.connectionType.remote.transport=REMOTE_transport[result.id])},getStatsParser.dataSentReceived=function(result){!result.googCodecName||\"video\"!==result.mediaType&&\"audio\"!==result.mediaType||(result.bytesSent&&(getStatsResult[result.mediaType].bytesSent=parseInt(result.bytesSent)),result.bytesReceived&&(getStatsResult[result.mediaType].bytesReceived=parseInt(result.bytesReceived)))},getStatsParser.inboundrtp=function(result){if(isSafari&&\"inbound-rtp\"===result.type){var mediaType=result.mediaType||\"audio\",sendrecvType=result.isRemote?\"recv\":\"send\";if(sendrecvType){if(result.bytesSent){var kilobytes=0;getStatsResult.internal[mediaType][sendrecvType].prevBytesSent||(getStatsResult.internal[mediaType][sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal[mediaType][sendrecvType].prevBytesSent;getStatsResult.internal[mediaType][sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult[mediaType][sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult[mediaType].bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived||(getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived;getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult[mediaType].bytesReceived=kilobytes.toFixed(1)}}}},getStatsParser.outboundrtp=function(result){if(isSafari&&\"outbound-rtp\"===result.type){var mediaType=result.mediaType||\"audio\",sendrecvType=result.isRemote?\"recv\":\"send\";if(sendrecvType){if(result.bytesSent){var kilobytes=0;getStatsResult.internal[mediaType][sendrecvType].prevBytesSent||(getStatsResult.internal[mediaType][sendrecvType].prevBytesSent=result.bytesSent);var bytes=result.bytesSent-getStatsResult.internal[mediaType][sendrecvType].prevBytesSent;getStatsResult.internal[mediaType][sendrecvType].prevBytesSent=result.bytesSent,kilobytes=bytes/1024,getStatsResult[mediaType][sendrecvType].availableBandwidth=kilobytes.toFixed(1),getStatsResult[mediaType].bytesSent=kilobytes.toFixed(1)}if(result.bytesReceived){var kilobytes=0;getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived||(getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived=result.bytesReceived);var bytes=result.bytesReceived-getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived;getStatsResult.internal[mediaType][sendrecvType].prevBytesReceived=result.bytesReceived,kilobytes=bytes/1024,getStatsResult[mediaType].bytesReceived=kilobytes.toFixed(1)}}}},getStatsParser.track=function(result){if(isSafari&&\"track\"===result.type){var sendrecvType=result.remoteSource===!0?\"send\":\"recv\";result.frameWidth&&result.frameHeight&&(getStatsResult.resolutions[sendrecvType].width=result.frameWidth,getStatsResult.resolutions[sendrecvType].height=result.frameHeight)}};var SSRC={audio:{send:[],recv:[]},video:{send:[],recv:[]}};getStatsParser.ssrc=function(result){if(result.googCodecName&&(\"video\"===result.mediaType||\"audio\"===result.mediaType)&&\"ssrc\"===result.type){var sendrecvType=result.id.split(\"_\").pop();SSRC[result.mediaType][sendrecvType].indexOf(result.ssrc)===-1&&SSRC[result.mediaType][sendrecvType].push(result.ssrc),getStatsResult[result.mediaType][sendrecvType].streams=SSRC[result.mediaType][sendrecvType].length}},getStatsLooper()};\"undefined\"!=typeof module&&(module.exports=getStats),\"function\"==typeof define&&define.amd&&define(\"getStats\",[],function(){return getStats});","'use strict';\n\nconst Helper = (() => {\n  const avatarUrl = '../static/plugins/ep_profile_modal/static/img/user.png';\n  const hElements = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', '.h1', '.h2', '.h3', '.h4', '.h5', '.h6'];\n  let ace = null;\n\n  const init = (context) => ace = context.ace;\n\n  const getAvatarUrl = (userId) => {\n    if (!userId) return avatarUrl;\n    return `/static/getUserProfileImage/${userId}/${window.pad.getPadId()}?t=${new Date().getTime()}`;\n  };\n\n  const getValidUrl = function () {\n    const url = arguments.length <= 0 || arguments[0] === undefined ? '' : arguments[0];\n\n    if (url === '') return '';\n    let newUrl = window.decodeURIComponent(url);\n    newUrl = newUrl.trim().replace(/\\s/g, '');\n\n    if (/^(:\\/\\/)/.test(newUrl)) {\n      return `http${newUrl}`;\n    }\n    if (!/^(f|ht)tps?:\\/\\//i.test(newUrl)) {\n      return `http://${newUrl}`;\n    }\n\n    return newUrl;\n  };\n\n  const getUserId = () => clientVars.userId || window.pad.getUserId();\n\n  const stopStreaming = (callback) => {\n    const stream = wrtcStore.localstream;\n    if (stream) {\n      stream.getTracks().forEach((track) => {\n        track.stop();\n        stream.removeTrack(track);\n      });\n      wrtcStore.localstream = null;\n      if (callback) callback();\n    }\n  };\n\n  const scrollDownToLastChatText = (selector) => {\n    const $element = $(selector);\n    if ($element.length <= 0 || !$element[0]) return true;\n    $element.animate({scrollTop: $element[0].scrollHeight}, {duration: 400, queue: false});\n  };\n\n  const getUserFromId = (userId) => {\n    const anonymousUser = {name: 'anonymous', userId, colorId: '#FFF'};\n    if (!window.pad || !window.pad.collabClient) return anonymousUser;\n    const result = window.pad.collabClient.getConnectedUsers().filter((user) => user.userId === userId);\n    const user = result.length > 0 ? result[0] : anonymousUser;\n    return user;\n  };\n\n  const slugify = (text) => text.toString().toLowerCase().trim().replace(/\\s+/g, '-') // Replace spaces with -\n      .replace(/&/g, '-and-') // Replace & with 'and'\n      .replace(/[^\\w\\-]+/g, '') // Remove all non-word chars\n      .replace(/\\--+/g, '-') // Replace multiple - with single -\n      .replace(/^-+/, '') // Trim - from start of text\n      .replace(/-+$/, '') // Trim - from end of text\n  ;\n\n  const $body_ace_outer = () => $(document).find('iframe[name=\"ace_outer\"]').contents();\n\n  const createShareLink = (headerId, headerText = 'headerText') => `${window.location.origin + window.location.pathname}?header=${slugify(headerText)}&id=${headerId}&target=video&join=true`;\n\n  const addTextChatMessage = (msg) => {\n    const authorClass = `author-${msg.userId.replace(/[^a-y0-9]/g, (c) => {\n      if (c === '.') return '-';\n      return `z${c.charCodeAt(0)}z`;\n    })}`;\n\n    // create the time string\n    let minutes = `${new Date(msg.time).getMinutes()}`;\n    let hours = `${new Date(msg.time).getHours()}`;\n    if (minutes.length === 1) minutes = `0${minutes}`;\n    if (hours.length === 1) hours = `0${hours}`;\n    const timeStr = `${hours}:${minutes}`;\n\n    const html = `<p id=\"wrtcNotifMessage\" data-target='${msg.target}' data-id='${msg.headerId}' data-authorId='${msg.userId}' class='wrtc_text ${msg.headId} ${authorClass}'><span class='time ${authorClass}'>${timeStr}</span> ${msg.text}</p>`;\n\n    $(document).find('#chatbox #chattext').append(html);\n    scrollDownToLastChatText('#chatbox #chattext');\n  };\n\n  const notifyNewUserJoined = (target, msg, action) => {\n    const videoIcon = '<span class=\"videoIcon\"><svg aria-hidden=\"true\" focusable=\"false\" data-prefix=\"fas\" data-icon=\"video\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\" class=\"svg-inline--fa fa-video fa-w-18 fa-2x\"><path fill=\"currentColor\" d=\"M336.2 64H47.8C21.4 64 0 85.4 0 111.8v288.4C0 426.6 21.4 448 47.8 448h288.4c26.4 0 47.8-21.4 47.8-47.8V111.8c0-26.4-21.4-47.8-47.8-47.8zm189.4 37.7L416 177.3v157.4l109.6 75.5c21.2 14.6 50.4-.3 50.4-25.8V127.5c0-25.4-29.1-40.4-50.4-25.8z\" class=\"\"></path></svg></span>';\n    const textIcon = '<span class=\"textIcon\"><svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 576 512\"><path fill=\"currentColor\" d=\"M416 224V64c0-35.3-28.7-64-64-64H64C28.7 0 0 28.7 0 64v160c0 35.3 28.7 64 64 64v54.2c0 8 9.1 12.6 15.5 7.8l82.8-62.1H352c35.3.1 64-28.6 64-63.9zm96-64h-64v64c0 52.9-43.1 96-96 96H192v64c0 35.3 28.7 64 64 64h125.7l82.8 62.1c6.4 4.8 15.5.2 15.5-7.8V448h32c35.3 0 64-28.7 64-64V224c0-35.3-28.7-64-64-64z\"></path></svg></span>';\n    const btnJoin = `<span class='wrtc_roomLink btn_roomHandler' href=\"${createShareLink(msg.headerId)}\" data-join='PLUS' data-action='JOINBYQUERY' data-id='${msg.headerId}' title='Join'>${msg.headerTitle}</span>`;\n\n    const text = ''; // action === 'JOIN' ? 'joins' : 'leaves';\n    const userName = `<b>${msg.userName}</b>`;\n\n    if (target === 'PLUS' && action === 'JOIN') {\n      if (msg.userCount === 1) {\n        msg.text = `${userName} wants to talk about ${videoIcon}${btnJoin}`;\n      } else {\n        const roomSize = +msg.userCount === 0 ? '(JOIN)' : `(${msg.userCount}/${msg.VIDEOCHATLIMIT})`;\n        const roomCounter = `<span class='userCount'>${roomSize}</span>`;\n        msg.text = `${userName} joins ${videoIcon}${btnJoin}${roomCounter}`;\n      }\n    } else if (target === 'TEXT') {\n      msg.text = `<span>${text}</span>${textIcon}${btnJoin}${userName}`;\n    }\n\n    if (!msg.text) return false;\n\n    msg.target = target;\n\n    addTextChatMessage(msg);\n  };\n\n  const appendUserList = (roomInfo, selector) => {\n    if (!roomInfo.list) return true;\n    const $element = typeof selector === 'string' ? $(document).find(selector) : selector;\n    $element.empty();\n    roomInfo.list.forEach((el) => {\n      const userInList = getUserFromId(el.userId) || {colorId: '', name: 'anonymous', userId: '0000000'};\n      const userName = userInList.name || 'anonymous';\n      $element.append(`<li data-id=${el.userId} style='border-color: ${userInList.colorId}'><div class='avatar'><div title='${userName}' style=\"background: url('${getAvatarUrl(el.userId)}') no-repeat 50% 50% ; background-size : cover;\"></div></div>${userName}</li>`);\n    });\n  };\n\n  // socketState: 'CLOSED', 'OPEND', 'DISCONNECTED'\n  // enable: plugin active/deactivate\n  const wrtcStore = {\n    enable: true,\n    userInRoom: false,\n    currentOpenRoom: null,\n    socketState: 'CLOSED',\n    localstream: null,\n    components: {\n      text: {init: false, open: false},\n      video: {init: false, open: false},\n      room: {init: false, open: false},\n      wrtc: {init: false, open: false},\n    },\n    rooms: new Map(),\n  };\n\n  const wrtcPubsub = {\n    events: {},\n    on: function on(eventName, fn) {\n      this.events[eventName] = this.events[eventName] || [];\n      this.events[eventName].push(fn);\n    },\n    off: function off(eventName, fn) {\n      if (this.events[eventName]) {\n        for (let i = 0; i < this.events[eventName].length; i++) {\n          if (this.events[eventName][i] === fn) {\n            this.events[eventName].splice(i, 1);\n            break;\n          }\n        }\n      }\n    },\n    emit: function emit(eventName) {\n      for (var _len = arguments.length, data = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n        data[_key - 1] = arguments[_key];\n      }\n\n      if (this.events[eventName]) {\n        this.events[eventName].forEach((fn) => {\n          fn.apply(undefined, data);\n        });\n      }\n    },\n  };\n\n  // search the inlineAvatar in all over\n\n  /**\n\t * @property ROOM\n\t * @property TEXT\n\t * @property VIDEO\n\t * @property update\n\t */\n  const inlineAvatar = {\n    ROOM: (headerId, room) => {\n      if (!clientVars.webrtc.displayInlineAvatar) return;\n\n      const inlineAvatarLimit = clientVars.webrtc.inlineAvatarLimit || 4;\n      let $element = $body_ace_outer().find(`#wbrtc_avatarCol .${headerId}.wrtcIconLine .wrtc_inlineAvatars`);\n\n      const offsetTop = findAceHeaderElement(headerId).offset.top() - 16;\n\n      if (!$element.length) {\n        const avatarBox = $('#wrtcLinesIcons').tmpl({headerId, offsetTop});\n        $element = $body_ace_outer().find('#wbrtc_avatarCol').append(avatarBox);\n        $element = $element.find(`.${headerId}.wrtcIconLine .wrtc_inlineAvatars`);\n      }\n\n      const $videoInlineAvatarIcons = $body_ace_outer().find('#wbrtc_avatarCol .wrtc_inlineAvatars');\n\n      $element.find('.avatar').remove();\n      Object.keys(room).forEach((key, index) => {\n        const userInList = getUserFromId(room[key].userId) || {colorId: '', name: 'anonymous'};\n        if (userInList.userId) {\n          // if user avatar find in other room remove it\n          $videoInlineAvatarIcons.find(`.avatar[data-id=\"${userInList.userId}\"]`).remove();\n\n          if (index < inlineAvatarLimit) {\n            const userName = userInList.name || 'anonymous';\n            $element.find('.avatarMore').hide();\n            $element.append(`<div class=\"avatar btn_roomHandler\" data-join=\"null\" data-action=\"USERPROFILEMODAL\" data-id=\"${userInList.userId}\"><div title='${userName}' style=\"background: url('${getAvatarUrl(userInList.userId)}') no-repeat 50% 50% ; background-size : cover;\"></div></div>`);\n          } else {\n            $element.find('.avatarMore').show().text(`+${index + 1 - inlineAvatarLimit}`);\n          }\n        }\n      });\n    },\n    TEXT(headerId, room) {\n      const $element = $(document).find('#wrtc_textChatWrapper .wrtc_inlineAvatars');\n      if (!clientVars.webrtc.displayInlineAvatar) {\n        $element.hide();\n        return;\n      }\n      $element.show();\n      $element.find('.avatar').remove();\n      this._append(room.list, $element);\n    },\n    VIDEO(headerId, room) {\n      const $element = $(document).find('#werc_toolbar .wrtc_inlineAvatars');\n      if (!clientVars.webrtc.displayInlineAvatar) {\n        $element.hide();\n        return;\n      }\n      $element.show();\n      $element.find('.avatar').remove();\n      this._append(room.list, $element);\n    },\n    _append(list, $element) {\n      const inlineAvatarLimit = clientVars.webrtc.inlineAvatarLimit || 4;\n      list.forEach((el, index) => {\n        const userInList = getUserFromId(el.userId) || {colorId: '', name: 'anonymous'};\n        if (userInList.userId) {\n          if (index < inlineAvatarLimit) {\n            const userName = userInList.name || 'anonymous';\n            $element.find('.avatarMore').hide();\n            $element.append(`<div class=\"avatar btn_roomHandler\" data-join=\"null\" data-action=\"USERPROFILEMODAL\" data-id=\"${userInList.userId}\"><div title='${userName}' style=\"background: url('${getAvatarUrl(userInList.userId)}') no-repeat 50% 50% ; background-size : cover;\"></div></div>`);\n          } else {\n            $element.find('.avatarMore').show().text(`+${index + 1 - inlineAvatarLimit}`);\n          }\n        }\n      });\n    },\n    update(userId, data) {\n      if (!clientVars.webrtc.displayInlineAvatar) return;\n\n      const $roomBox = $body_ace_outer().find('#wrtcVideoIcons .wrtcIconLine .wrtc_inlineAvatars');\n      const $textBox = $(document).find('#wrtc_textChatWrapper .wrtc_inlineAvatars');\n      const $videoBox = $(document).find('#werc_toolbar .wrtc_inlineAvatars');\n\n      if ($roomBox) {\n        $roomBox.find(`.avatar[data-id=\"${userId}\"] img`).attr({\n          src: data.imageUrl,\n          title: data.userName,\n        });\n      }\n\n      if ($videoBox) {\n        $videoBox.find('.avatar img').attr({\n          src: data.imageUrl,\n          title: data.userName,\n        });\n      }\n\n      if ($textBox) {\n        $textBox.find('.avatar img').attr({\n          src: data.imageUrl,\n          title: data.userName,\n        });\n      }\n    },\n  };\n\n\n  /**\n\t * @param {boolean} state\n\t */\n  wrtcPubsub.on('plugin enable', (state) => {\n    $body_ace_outer().find('iframe').contents()\n        .find('#innerdocbody').find('.videoHeader wrt-inline-icon').each((i, el) => {\n          el.shadowRoot.querySelector('.btn_roomHandler').style.display = state ? 'flex' : 'none';\n        });\n\n    Helper.$body_ace_outer().find('#outerdocbody')\n        .find('#wbrtc_avatarCol')[0].style.display = state ? 'flex' : 'none';\n\n    // deactive\n    if (!state) {\n      videoChat.userLeave(window.headerId, wrtcPubsub.currentOpenRoom, 'PLUS');\n      wrtcPubsub.currentOpenRoom = null;\n    }\n    wrtcStore.enable = state;\n  });\n\n  wrtcPubsub.on('update network information', () => {});\n\n  /**\n\t * state (DISCONNECTED|OPEND)\n\t */\n  wrtcPubsub.on('socket state', (state) => {\n    wrtcStore.socketState = state;\n    console.info('[wrtc]: socket state has been change, new state:', state, wrtcStore.userInRoom, window.headerId);\n    if (state === 'OPEND' && wrtcStore.userInRoom) {\n      console.info('Try reconnecting...');\n      WRTC.attemptToReconnect();\n    }\n  });\n\n  /**\n\t * @param {string}\tname \t\t@enum\t(text|video|room|wrtc)\n\t * @param {string}\tflow \t\t@enum\t(init|open)\n\t * @param {boolean}\tstatus \t@enum (true|false)\n\t */\n  wrtcPubsub.on('componentsFlow', (name, flow, status) => {\n    wrtcStore.components[name][flow] = status;\n  });\n\n  wrtcPubsub.on('update inlineAvater info', (userId, data) => {\n    if (clientVars.webrtc.displayInlineAvatar) inlineAvatar.update(userId, data);\n  });\n\n  wrtcPubsub.on('update store', (requestUser, headerId, action, target, roomInfo, callback) => {\n    if (!requestUser || !headerId || !action || !roomInfo || !target) return false;\n\n    if (!wrtcStore.rooms.has(headerId)) { wrtcStore.rooms.set(headerId, {VIDEO: {list: []}, TEXT: {list: []}, USERS: {}, headerCount: 0}); }\n\n    const room = wrtcStore.rooms.get(headerId);\n    let users = room.USERS;\n\n    room[target] = roomInfo;\n\n    // remove all users\n    users = {};\n\n    if (room.TEXT.list) {\n      room.TEXT.list.forEach((el) => {\n        if (!users[el.userId]) users[el.userId] = {};\n        users[el.userId] = el;\n      });\n    }\n\n    if (room.VIDEO.list) {\n      room.VIDEO.list.forEach((el) => {\n        if (!users[el.userId]) users[el.userId] = {};\n        users[el.userId] = el;\n      });\n    }\n\n    inlineAvatar[target](headerId, room[target]);\n    inlineAvatar.ROOM(headerId, users);\n\n    wrtcStore.rooms.set(headerId, room);\n\n    if (callback) callback(room);\n  });\n\n  wrtcPubsub.on('disable room buttons', (headerId, actions, target) => {\n    let btn = $(\"#header_videochat_icon\")[0];\n    if (!btn) return;\n    btn.classList.add('activeLoader');\n    btn.setAttribute('disabled', true);\n  });\n\n  wrtcPubsub.on('enable room buttons', (headerId, action, target) => {\n    let btn = $(\"#header_videochat_icon\")[0];\n    if (!btn) return;\n    const newAction = action === 'JOIN' ? 'LEAVE' : 'JOIN';\n    btn.removeAttribute('disabled');\n    btn.setAttribute('data-action', newAction);\n    btn.classList.remove('activeLoader');\n  });\n\n  wrtcPubsub.on('updateWrtcToolbarModal', (headerId, roomInfo) => {\n    // find toolbar attribute and update all of thems.\n    // update toolbar title\n    // update inlineAvatar\n\n    const headerTile = findAceHeaderElement(headerId).text;\n\n    $('#wrtc_modal #werc_toolbar .nd_title .title').html(headerTile);\n    $(document).find('#wrtc_textChatWrapper .textChatToolbar b').text(headerTile);\n\n    $(document).find('#wrtc_textChatWrapper  [data-id], #wrtc_modal [data-id]')\n        .each(function () {\n          $(this).attr({'data-id': headerId});\n        });\n  });\n\n  wrtcPubsub.on('updateWrtcToolbarTitleModal', (headerTile, headerId) => {\n    if (headerId === window.headerId) {\n      $(`#wrtc_modal #werc_toolbar .nd_title .titleb[data-id='${headerId}'`).html(headerTile);\n      $(document).find(`#wrtc_textChatWrapper .textChatToolbar b[data-id='${headerId}']`).text(headerTile);\n      $(document).find(`.wrtc_roomLink[data-id='${headerId}']`).text(headerTile);\n    }\n  });\n\n  const getHeaderRoomY = ($element) => {\n    if (!$element.length) return;\n    const height = $element.outerHeight();\n    const paddingTop = Helper.$body_ace_outer().find('iframe[name=\"ace_inner\"]').css('padding-top');\n    const aceOuterPadding = parseInt(paddingTop, 10);\n    const offsetTop = Math.ceil($element.offset().top + aceOuterPadding);\n    return offsetTop + height / 2;\n  };\n\n  const getHeaderRoomX = ($element) => {\n    if (!$element.length) return;\n    const width = $element.outerWidth();\n    const paddingLeft = Helper.$body_ace_outer().find('iframe[name=\"ace_inner\"]').css('padding-left');\n    const aceOuterPadding = parseInt(paddingLeft, 10);\n    const offsetLeft = Math.ceil(Helper.$body_ace_outer().find('iframe[name=\"ace_inner\"]').offset().left - aceOuterPadding);\n    return offsetLeft - width - 6;\n  };\n\n  const findAceHeaderElement = (headerId) => {\n    const $el = $body_ace_outer().find('iframe').contents()\n        .find('#innerdocbody').find(`.heading.${headerId}`);\n    return {\n      exist: $el.length,\n      $el,\n      text: $el.text(),\n      tag: $el.attr('data-htag'),\n      offset: {\n        top: () => getHeaderRoomY($el),\n        left: () => getHeaderRoomX($el),\n      },\n      $inlineIcon: () => $el.find('wrt-inline-icon').length ? $el.find('wrt-inline-icon')[0].shadowRoot : null,\n    };\n  };\n\n  return {\n    init,\n    hElements,\n    scrollDownToLastChatText,\n    getUserFromId,\n    slugify,\n    $body_ace_outer,\n    createShareLink,\n    notifyNewUserJoined,\n    appendUserList,\n    wrtcStore,\n    wrtcPubsub,\n    getUserId,\n    stopStreaming,\n    getValidUrl,\n    findAceHeaderElement,\n    inlineAvatar,\n    getHeaderRoomY,\n\n  };\n})();\n","// inspired by ep_comments_page plugin, used and modified copyPasteEvents.js\n\n'use strict';\nconst _ = require('underscore');\nconst randomString = require('ep_etherpad-lite/static/js/pad_utils').randomString;\n\nconst events = (function () {\n  let padInner = null;\n\n  const getFirstColumnOfSelection = function getFirstColumnOfSelection(line, rep, firstLineOfSelection) {\n    return line !== firstLineOfSelection ? 0 : rep.selStart[1];\n  };\n\n  const getLength = function getLength(line, rep) {\n    const nextLine = line + 1;\n    const startLineOffset = rep.lines.offsetOfIndex(line);\n    const endLineOffset = rep.lines.offsetOfIndex(nextLine);\n\n    // lineLength without \\n\n    const lineLength = endLineOffset - startLineOffset - 1;\n\n    return lineLength;\n  };\n\n  const getLastColumnOfSelection = function getLastColumnOfSelection(line, rep, lastLineOfSelection) {\n    let lastColumnOfSelection;\n    if (line !== lastLineOfSelection) {\n      lastColumnOfSelection = getLength(line, rep); // length of line\n    } else {\n      lastColumnOfSelection = rep.selEnd[1] - 1; // position of last character selected\n    }\n    return lastColumnOfSelection;\n  };\n\n  const hasHeaderOnLine = function hasHeaderOnLine(lineNumber, firstColumn, lastColumn, attributeManager) {\n    let foundHeadOnLine = false;\n    let headId = null;\n    for (let column = firstColumn; column <= lastColumn && !foundHeadOnLine; column++) {\n      headId = _.object(attributeManager.getAttributesOnLine(lineNumber)).headingTagId;\n\n      if (headId) {\n        foundHeadOnLine = true;\n      }\n    }\n    return {foundHeadOnLine, headId};\n  };\n\n  const hasHeaderOnMultipleLineSelection = function hasHeaderOnMultipleLineSelection(firstLineOfSelection, lastLineOfSelection, rep, attributeManager) {\n    let foundLineWithHeader = false;\n    for (let line = firstLineOfSelection; line <= lastLineOfSelection && !foundLineWithHeader; line++) {\n      const firstColumn = getFirstColumnOfSelection(line, rep, firstLineOfSelection);\n      const lastColumn = getLastColumnOfSelection(line, rep, lastLineOfSelection);\n      const hasHeader = hasHeaderOnLine(line, firstColumn, lastColumn, attributeManager);\n      if (hasHeader.foundHeadOnLine) {\n        foundLineWithHeader = true;\n      }\n    }\n    return {foundHeadOnLine: foundLineWithHeader};\n  };\n\n  const hasMultipleLineSelected = function hasMultipleLineSelected(firstLineOfSelection, lastLineOfSelection) {\n    return firstLineOfSelection !== lastLineOfSelection;\n  };\n\n  const hasHeaderOnSelection = function hasHeaderOnSelection() {\n    let hasVideoHeader;\n    const attributeManager = this.documentAttributeManager;\n    const rep = this.rep;\n    const firstLineOfSelection = rep.selStart[0];\n    const firstColumn = rep.selStart[1];\n    const lastColumn = rep.selEnd[1];\n    const lastLineOfSelection = rep.selEnd[0];\n    const selectionOfMultipleLine = hasMultipleLineSelected(firstLineOfSelection, lastLineOfSelection);\n    if (selectionOfMultipleLine) {\n      hasVideoHeader = hasHeaderOnMultipleLineSelection(firstLineOfSelection, lastLineOfSelection, rep, attributeManager);\n    } else {\n      hasVideoHeader = hasHeaderOnLine(firstLineOfSelection, firstColumn, lastColumn, attributeManager);\n    }\n    return {\n      hasVideoHeader: hasVideoHeader.foundHeadOnLine,\n      headId: hasVideoHeader.headId,\n      hasMultipleLine: selectionOfMultipleLine,\n    };\n  };\n\n  function getSelectionHtml() {\n    let html = '';\n    if (typeof window.getSelection !== 'undefined') {\n      const sel = padInner.contents()[0].getSelection();\n      if (sel.rangeCount) {\n        const container = document.createElement('div');\n        for (let i = 0, len = sel.rangeCount; i < len; ++i) {\n          container.appendChild(sel.getRangeAt(i).cloneContents());\n        }\n        html = container.innerHTML;\n      }\n    } else if (typeof document.selection !== 'undefined') {\n      if (document.selection.type === 'Text') {\n        html = document.selection.createRange().htmlText;\n      }\n    }\n    return html;\n  }\n\n  function selectionMultipleLine() {\n    let rawHtml = getSelectionHtml();\n    rawHtml = $('<div></div>').append(rawHtml);\n    rawHtml.find(':header nd-video').each(function () {\n      $(this).attr({class: `nd-video ${randomString(16)}`});\n    });\n    return rawHtml.html();\n  }\n\n  function selectionOneLine(headerId) {\n    const hTag = padInner.contents()\n        .find(`.videoHeader.${headerId}`)\n        .attr('data-htag');\n\n    const content = padInner.contents()\n        .find(`.videoHeader.${headerId}`)\n        .html();\n\n    if (!hTag && !content) return false;\n    const rawHtml = $('<div></div>').append(`<${hTag}><nd-video class=\"videoHeader ${randomString(16)}\">${content}</nd-video></${hTag}>`);\n    return rawHtml.html();\n  }\n\n  const addTextOnClipboard = function addTextOnClipboard(e, aces, inner, removeSelection) {\n    padInner = inner;\n\n    let selection;\n    aces.callWithAce((ace) => {\n      selection = ace.ace_hasHeaderOnSelection();\n    });\n\n    if (selection.hasVideoHeader || selection.hasMultipleLine) {\n      let rawHtml;\n      if (selection.hasMultipleLine) {\n        const htmlSelection = getSelectionHtml();\n        rawHtml = selectionMultipleLine(htmlSelection);\n      } else {\n        if (!selection.headId) return false;\n        rawHtml = selectionOneLine(selection.headId);\n      }\n\n      if (rawHtml && selection.hasVideoHeader) {\n        e.originalEvent.clipboardData.setData('text/wrtc', JSON.stringify({type: 'wrtcHeading', raw: rawHtml, multiLine: selection.hasMultipleLine}));\n        e.preventDefault();\n        return false;\n      }\n\n      // if it is a cut event we have to remove the selection\n      if (removeSelection) {\n        padInner.contents()[0].execCommand('delete');\n      }\n    }\n  };\n\n\n  const pastOnSelection = (event, padInner) => {\n    const hasWrtcObject = event.originalEvent.clipboardData.getData('text/wrtc');\n    const objectMediaData = event.originalEvent.clipboardData.getData('text/objectMediaData');\n\n    if (hasWrtcObject && !objectMediaData) {\n      let rawHtml = JSON.parse(hasWrtcObject);\n      if (rawHtml.type !== 'wrtcHeading' && !rawHtml.raw) return false;\n\n      rawHtml = $('<div></div>').append(rawHtml.raw);\n      rawHtml.find('nd-video').each(function () {\n        $(this).attr({class: `nd-video ${randomString(16)}`});\n      });\n\n      const selection = padInner.contents()[0].getSelection();\n      if (!selection.rangeCount) return false;\n\n      const range = selection.getRangeAt(0);\n      range.insertNode(rawHtml[0]);\n      range.collapse(false);\n      selection.removeAllRanges();\n      selection.addRange(range);\n\n      event.preventDefault();\n    }\n  };\n\n  return {\n    hasHeaderOnSelection,\n    addTextOnClipboard,\n    pastOnSelection,\n  };\n})();\n","// CodecsHandler.js\n'use strict';\n\nvar CodecsHandler = (function () {\n  function preferCodec(sdp, codecName) {\n    const info = splitLines(sdp);\n\n    codecName = codecName.toLowerCase();\n\n    if (!info.videoCodecNumbers) {\n      return sdp;\n    }\n\n    if (codecName === 'vp8' && info.vp8LineNumber === info.videoCodecNumbers[0]) {\n      return sdp;\n    }\n\n    if (codecName === 'vp9' && info.vp9LineNumber === info.videoCodecNumbers[0]) {\n      return sdp;\n    }\n\n    if (codecName === 'h264' && info.h264LineNumber === info.videoCodecNumbers[0]) {\n      return sdp;\n    }\n\n    sdp = preferCodecHelper(sdp, codecName, info);\n\n    return sdp;\n  }\n\n  function preferCodecHelper(sdp, codec, info, ignore) {\n    let preferCodecNumber = '';\n\n    if (codec === 'vp8') {\n      if (!info.vp8LineNumber) {\n        return sdp;\n      }\n      preferCodecNumber = info.vp8LineNumber;\n    }\n\n    if (codec === 'vp9') {\n      if (!info.vp9LineNumber) {\n        return sdp;\n      }\n      preferCodecNumber = info.vp9LineNumber;\n    }\n\n    if (codec === 'h264') {\n      if (!info.h264LineNumber) {\n        return sdp;\n      }\n\n      preferCodecNumber = info.h264LineNumber;\n    }\n\n    let newLine = `${info.videoCodecNumbersOriginal.split('SAVPF')[0]}SAVPF `;\n\n    let newOrder = [preferCodecNumber];\n\n    if (ignore) {\n      newOrder = [];\n    }\n\n    info.videoCodecNumbers.forEach((codecNumber) => {\n      if (codecNumber === preferCodecNumber) return;\n      newOrder.push(codecNumber);\n    });\n\n    newLine += newOrder.join(' ');\n\n    sdp = sdp.replace(info.videoCodecNumbersOriginal, newLine);\n    return sdp;\n  }\n\n  function splitLines(sdp) {\n    const info = {};\n    sdp.split('\\n').forEach((line) => {\n      if (line.indexOf('m=video') === 0) {\n        info.videoCodecNumbers = [];\n        line.split('SAVPF')[1].split(' ').forEach((codecNumber) => {\n          codecNumber = codecNumber.trim();\n          if (!codecNumber || !codecNumber.length) return;\n          info.videoCodecNumbers.push(codecNumber);\n          info.videoCodecNumbersOriginal = line;\n        });\n      }\n\n      if (line.indexOf('VP8/90000') !== -1 && !info.vp8LineNumber) {\n        info.vp8LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\n      }\n\n      if (line.indexOf('VP9/90000') !== -1 && !info.vp9LineNumber) {\n        info.vp9LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\n      }\n\n      if (line.indexOf('H264/90000') !== -1 && !info.h264LineNumber) {\n        info.h264LineNumber = line.replace('a=rtpmap:', '').split(' ')[0];\n      }\n    });\n\n    return info;\n  }\n\n  function removeVPX(sdp) {\n    const info = splitLines(sdp);\n\n    // last parameter below means: ignore these codecs\n    sdp = preferCodecHelper(sdp, 'vp9', info, true);\n    sdp = preferCodecHelper(sdp, 'vp8', info, true);\n\n    return sdp;\n  }\n\n  function disableNACK(sdp) {\n    if (!sdp || typeof sdp !== 'string') {\n      throw 'Invalid arguments.';\n    }\n\n    sdp = sdp.replace('a=rtcp-fb:126 nack\\r\\n', '');\n    sdp = sdp.replace('a=rtcp-fb:126 nack pli\\r\\n', 'a=rtcp-fb:126 pli\\r\\n');\n    sdp = sdp.replace('a=rtcp-fb:97 nack\\r\\n', '');\n    sdp = sdp.replace('a=rtcp-fb:97 nack pli\\r\\n', 'a=rtcp-fb:97 pli\\r\\n');\n\n    return sdp;\n  }\n\n  function prioritize(codecMimeType, peer) {\n    if (!peer || !peer.getSenders || !peer.getSenders().length) {\n      return;\n    }\n\n    if (!codecMimeType || typeof codecMimeType !== 'string') {\n      throw 'Invalid arguments.';\n    }\n\n    peer.getSenders().forEach((sender) => {\n      const params = sender.getParameters();\n      for (let i = 0; i < params.codecs.length; i++) {\n        if (params.codecs[i].mimeType === codecMimeType) {\n          params.codecs.unshift(params.codecs.splice(i, 1));\n          break;\n        }\n      }\n      sender.setParameters(params);\n    });\n  }\n\n  function removeNonG722(sdp) {\n    return sdp.replace(/m=audio ([0-9]+) RTP\\/SAVPF ([0-9 ]*)/g, 'm=audio $1 RTP/SAVPF 9');\n  }\n\n  function setBAS(sdp, bandwidth, isScreen) {\n    if (!!navigator.mozGetUserMedia || !bandwidth) {\n      return sdp;\n    }\n\n    if (isScreen) {\n      if (!bandwidth.screen) {\n        console.warn('It seems that you are not using bandwidth for screen. Screen sharing is expected to fail.');\n      } else if (bandwidth.screen < 300) {\n        console.warn('It seems that you are using wrong bandwidth value for screen. Screen sharing is expected to fail.');\n      }\n    }\n\n    // if screen; must use at least 300kbs\n    if (bandwidth.screen && isScreen) {\n      sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\n      sdp = sdp.replace(/a=mid:video\\r\\n/g, `a=mid:video\\r\\nb=AS:${bandwidth.screen}\\r\\n`);\n    }\n\n    // remove existing bandwidth lines\n    if (bandwidth.audio || bandwidth.video || bandwidth.data) {\n      sdp = sdp.replace(/b=AS([^\\r\\n]+\\r\\n)/g, '');\n    }\n\n    if (bandwidth.audio) {\n      sdp = sdp.replace(/a=mid:audio\\r\\n/g, `a=mid:audio\\r\\nb=AS:${bandwidth.audio}\\r\\n`);\n    }\n\n    if (bandwidth.video) {\n      sdp = sdp.replace(/a=mid:video\\r\\n/g, `a=mid:video\\r\\nb=AS:${isScreen ? bandwidth.screen : bandwidth.video}\\r\\n`);\n    }\n\n    return sdp;\n  }\n\n  // Find the line in sdpLines that starts with |prefix|, and, if specified,\n  // contains |substr| (case-insensitive search).\n  function findLine(sdpLines, prefix, substr) {\n    return findLineInRange(sdpLines, 0, -1, prefix, substr);\n  }\n\n  // Find the line in sdpLines[startLine...endLine - 1] that starts with |prefix|\n  // and, if specified, contains |substr| (case-insensitive search).\n  function findLineInRange(sdpLines, startLine, endLine, prefix, substr) {\n    const realEndLine = endLine !== -1 ? endLine : sdpLines.length;\n    for (let i = startLine; i < realEndLine; ++i) {\n      if (sdpLines[i].indexOf(prefix) === 0) {\n        if (!substr || sdpLines[i].toLowerCase().indexOf(substr.toLowerCase()) !== -1) {\n          return i;\n        }\n      }\n    }\n    return null;\n  }\n\n  // Gets the codec payload type from an a=rtpmap:X line.\n  function getCodecPayloadType(sdpLine) {\n    const pattern = new RegExp('a=rtpmap:(\\\\d+) \\\\w+\\\\/\\\\d+');\n    const result = sdpLine.match(pattern);\n    return result && result.length === 2 ? result[1] : null;\n  }\n\n  function _setVideoBitrates(sdp, params) {\n    params = params || {};\n    const xgoogle_min_bitrate = params.min;\n    const xgoogle_max_bitrate = params.max;\n    const videoCodec = params.codec.toUpperCase() || 'VP8';\n\n    const sdpLines = sdp.split('\\r\\n');\n\n    // VP8\n    const vp8Index = findLine(sdpLines, 'a=rtpmap', `${videoCodec}/90000`);\n    let vp8Payload;\n    if (vp8Index) {\n      vp8Payload = getCodecPayloadType(sdpLines[vp8Index]);\n    }\n\n    if (!vp8Payload) {\n      return sdp;\n    }\n\n    const rtxIndex = findLine(sdpLines, 'a=rtpmap', 'rtx/90000');\n    let rtxPayload;\n    if (rtxIndex) {\n      rtxPayload = getCodecPayloadType(sdpLines[rtxIndex]);\n    }\n\n    if (!rtxIndex) {\n      return sdp;\n    }\n\n    const rtxFmtpLineIndex = findLine(sdpLines, `a=fmtp:${rtxPayload.toString()}`);\n    if (rtxFmtpLineIndex !== null) {\n      let appendrtxNext = '\\r\\n';\n      appendrtxNext += `a=fmtp:${vp8Payload} x-google-min-bitrate=${xgoogle_min_bitrate || '228'}; x-google-max-bitrate=${xgoogle_max_bitrate || '228'}`;\n      sdpLines[rtxFmtpLineIndex] = sdpLines[rtxFmtpLineIndex].concat(appendrtxNext);\n      sdp = sdpLines.join('\\r\\n');\n    }\n\n    return sdp;\n  }\n\n  function _setOpusAttributes(sdp, params) {\n    params = params || {};\n\n    const sdpLines = sdp.split('\\r\\n');\n\n    // Opus\n    const opusIndex = findLine(sdpLines, 'a=rtpmap', 'opus/48000');\n    let opusPayload;\n    if (opusIndex) {\n      opusPayload = getCodecPayloadType(sdpLines[opusIndex]);\n    }\n\n    if (!opusPayload) {\n      return sdp;\n    }\n\n    const opusFmtpLineIndex = findLine(sdpLines, `a=fmtp:${opusPayload.toString()}`);\n    if (opusFmtpLineIndex == null) {\n      return sdp;\n    }\n\n    let appendOpusNext = '';\n    appendOpusNext += `; stereo=${typeof params.stereo !== 'undefined' ? params.stereo : '1'}`;\n    appendOpusNext += `; sprop-stereo=${typeof params['sprop-stereo'] !== 'undefined' ? params['sprop-stereo'] : '1'}`;\n\n    if (typeof params.maxaveragebitrate !== 'undefined') {\n      appendOpusNext += `; maxaveragebitrate=${params.maxaveragebitrate || 128 * 1024 * 8}`;\n    }\n\n    if (typeof params.maxplaybackrate !== 'undefined') {\n      appendOpusNext += `; maxplaybackrate=${params.maxplaybackrate || 128 * 1024 * 8}`;\n    }\n\n    if (typeof params.cbr !== 'undefined') {\n      appendOpusNext += `; cbr=${typeof params.cbr !== 'undefined' ? params.cbr : '1'}`;\n    }\n\n    if (typeof params.useinbandfec !== 'undefined') {\n      appendOpusNext += `; useinbandfec=${params.useinbandfec}`;\n    }\n\n    if (typeof params.usedtx !== 'undefined') {\n      appendOpusNext += `; usedtx=${params.usedtx}`;\n    }\n\n    if (typeof params.maxptime !== 'undefined') {\n      appendOpusNext += `\\r\\na=maxptime:${params.maxptime}`;\n    }\n\n    sdpLines[opusFmtpLineIndex] = sdpLines[opusFmtpLineIndex].concat(appendOpusNext);\n\n    sdp = sdpLines.join('\\r\\n');\n    return sdp;\n  }\n\n  // forceStereoAudio => via webrtcexample.com\n  // requires getUserMedia => echoCancellation:false\n  function forceStereoAudio(sdp) {\n    const sdpLines = sdp.split('\\r\\n');\n    let fmtpLineIndex = null;\n    for (var i = 0; i < sdpLines.length; i++) {\n      if (sdpLines[i].search('opus/48000') !== -1) {\n        var opusPayload = extractSdp(sdpLines[i], /:(\\d+) opus\\/48000/i);\n        break;\n      }\n    }\n    for (var i = 0; i < sdpLines.length; i++) {\n      if (sdpLines[i].search('a=fmtp') !== -1) {\n        const payload = extractSdp(sdpLines[i], /a=fmtp:(\\d+)/);\n        if (payload === opusPayload) {\n          fmtpLineIndex = i;\n          break;\n        }\n      }\n    }\n    if (fmtpLineIndex == null) return sdp;\n    sdpLines[fmtpLineIndex] = sdpLines[fmtpLineIndex].concat('; stereo=1; sprop-stereo=1');\n    sdp = sdpLines.join('\\r\\n');\n    return sdp;\n  }\n\n  return {\n    removeVPX,\n    disableNACK,\n    prioritize,\n    removeNonG722,\n    setApplicationSpecificBandwidth: function setApplicationSpecificBandwidth(sdp, bandwidth, isScreen) {\n      return setBAS(sdp, bandwidth, isScreen);\n    },\n    setVideoBitrates: function setVideoBitrates(sdp, params) {\n      return _setVideoBitrates(sdp, params);\n    },\n    setOpusAttributes: function setOpusAttributes(sdp, params) {\n      return _setOpusAttributes(sdp, params);\n    },\n    preferVP9: function preferVP9(sdp) {\n      return preferCodec(sdp, 'vp9');\n    },\n    preferCodec,\n    forceStereoAudio,\n  };\n})();\n","'use strict';\nconst padutils = require('ep_etherpad-lite/static/js/pad_utils').padutils;\n\nconst textChat = (() => {\n  let socket = null;\n  let padId = null;\n  let currentRoom = {};\n  let $joinBtn = null;\n\n  function createAndAppendMessage(msg) {\n    if (!msg || !currentRoom.userId) return true;\n\n    // correct the time\n    // msg.time += window.clientTimeOffset;\n\n    let minutes = `${new Date(msg.time).getMinutes()}`;\n    let hours = `${new Date(msg.time).getHours()}`;\n    if (minutes.length === 1) minutes = `0${minutes}`;\n    if (hours.length === 1) hours = `0${hours}`;\n    const timeStr = `${hours}:${minutes}`;\n\n    const userName = $('<b>').text(`${msg.userName}: `);\n    const tim = $('<span>').attr({class: 'time'}).text(timeStr);\n\n    const text = padutils.escapeHtmlWithClickableLinks(msg.text, '_blank');\n\n    const message = $('<p>').attr({\n      'data-authorid': msg.author,\n    }).append(userName).append(tim).append(text);\n\n    $('#wrtc_textChat').append(message);\n    Helper.scrollDownToLastChatText('#wrtc_textChat');\n  }\n\n  function eventTextChatInput() {\n    const keycode = event.keyCode || event.which;\n    // when press Enter key\n    if (keycode === 13) {\n      const textMessage = $(this).val();\n      if (!textMessage) return true;\n      $(this).val('');\n      const user = Helper.getUserFromId(clientVars.userId);\n      if (!user) return true;\n      const userName = user.name || 'anonymous';\n      const msg = {text: textMessage, userName, author: user.userId, time: new Date().getTime()};\n      socket.emit('sendTextMessage', padId, currentRoom.headerId, msg, (incomMsg) => {\n        createAndAppendMessage(incomMsg);\n      });\n    }\n  }\n\n  function eventListers() {\n    $(document).on('keypress', '#wrtc_textChatInputBox input', eventTextChatInput);\n\n    $(document).on('click', '#wrtc_textChatWrapper .btn_toggle_modal', function click() {\n      const action = $(this).attr('data-action');\n      const chatBox = $('#wrtc_textChat').innerHeight() + $('#wrtc_textChatInputBox').innerHeight() + 1;\n\n      $(this).find('.fa_arrow-from-top').toggle();\n      $(this).find('.fa_arrow-to-top').toggle();\n\n      if (action === 'collapse') {\n        $(this).attr({'data-action': 'expand'});\n        $('#wrtc_textChatWrapper').css({\n          transform: `translate(-50%, ${chatBox}px)`,\n        });\n      } else {\n        $(this).attr({'data-action': 'collapse'});\n        $('#wrtc_textChatWrapper').css({\n          transform: 'translate(-50%, 0)',\n        });\n      }\n    });\n  }\n\n  function deactivateModal(headerId, roomInfo) {\n    const $TextChatWrapper = $(document).find('#wrtc_textChatWrapper');\n\n    $TextChatWrapper.removeClass('active').removeAttr('style');\n    $TextChatWrapper.find('#wrtc_textChat p').remove();\n    // socket.removeListener('receiveTextMessage:' + headerId);\n\n    const $btn = $(document).find('#wrtc_textChatWrapper .btn_toggle_modal');\n    $btn.attr({'data-action': 'collapse'});\n    $btn.find('.fa_arrow-from-top').toggle();\n    $btn.find('.fa_arrow-to-top').toggle();\n  }\n\n  function activateModal(headerId, headTitle, userCount, roomInfo) {\n    if (!headerId) return false;\n    const existTextChat = $(document).find('#wrtc_textChatWrapper');\n    if (!existTextChat.length) {\n\n    } else {\n      // TODO: change this to template\n      // existTextChat.attr({'data-id': headerId}).find('.textChatToolbar b, .btn_leave').attr({'data-id': headerId});\n      // existTextChat.find('.nd_title b').text(headTitle);\n    }\n\n    // for animation pop up\n    setTimeout(() => {\n      $(document).find('#wrtc_textChatWrapper').addClass('active');\n    }, 250);\n\n    socket.on(`receiveTextMessage:${headerId}`, (headingId, msg) => {\n      if (headingId === headerId) {\n        createAndAppendMessage(msg);\n      }\n    });\n\n    socket.emit('getTextMessages', padId, headerId, {}, (data) => {\n      data.forEach((el) => {\n        createAndAppendMessage(el);\n      });\n    });\n\n    Helper.appendUserList(roomInfo, '#wrtc_textChatWrapper  #textChatUserModal ul');\n  }\n\n  function addUserToRoom(data, roomInfo) {\n    if (!data || !data.userId) return true;\n    const headerId = data.headerId;\n    const $headingRoom = Helper.$body_ace_outer().find(`#${headerId}`);\n    const headTitle = $headingRoom.find('.wrtc_header b.titleRoom').text();\n    const userCount = roomInfo.present;\n    $headingRoom.find('.textChatCount').text(userCount);\n\n    const user = Helper.getUserFromId(data.userId);\n    // some user may session does exist but the user info does not available in all over the current pad\n    if (!user) return true;\n\n    // TODO: this is not good idea, use global state\n    // if incoming user has already in the room don't persuade the request\n    const IsUserInRooms = $headingRoom.find(`.wrtc_content.textChat ul li[data-id='${user.userId}']`).text();\n    if (IsUserInRooms) return false;\n\n    // Helper.appendUserList(roomInfo, $headingRoom.find('.wrtc_content.textChat ul'));\n    // Helper.appendUserList(roomInfo, '#wrtc_textChatWrapper  #textChatUserModal ul');\n\n    if (data.userId === clientVars.userId) {\n      currentRoom = data;\n      $headingRoom.attr({'data-text': true});\n      activateModal(headerId, headTitle, userCount, roomInfo);\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'JOIN', $joinBtn);\n      Helper.wrtcPubsub.emit('componentsFlow', 'text', 'open', true);\n    }\n\n    Helper.wrtcPubsub.emit('update store', data, headerId, 'JOIN', 'TEXT', roomInfo, () => {});\n  }\n\n  function removeUserFromRoom(data, roomInfo, target, cb) {\n    if (!data || !data.userId) return true;\n    const headerId = data.headerId;\n    const $headingRoom = Helper.$body_ace_outer().find(`#${headerId}`);\n\n    const userCount = roomInfo.present;\n    $headingRoom.find('.textChatCount').text(userCount);\n\n    const $textChatUserList = $headingRoom.find('.wrtc_content.textChat ul');\n\n    Helper.appendUserList(roomInfo, $textChatUserList);\n    Helper.appendUserList(roomInfo, '#wrtc_textChatWrapper #textChatUserModal ul');\n\n    if (userCount === 0) {\n      $textChatUserList.append(`<li class=\"empty\">Be the first to join the <button class=\"btn_joinChat_text\" data-action=\"JOIN\" data-id=\"${headerId}\" data-join=\"TEXT\"><b>text-chat</b></button></li>`);\n    }\n\n    if (data.userId === clientVars.userId) {\n      $headingRoom.removeAttr('data-text');\n      currentRoom = {};\n      deactivateModal(data.headerId, roomInfo);\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n      Helper.wrtcPubsub.emit('componentsFlow', 'text', 'open', false);\n    }\n\n    Helper.wrtcPubsub.emit('update store', data, headerId, 'LEAVE', 'TEXT', roomInfo, () => {});\n\n    if (cb && typeof cb === 'function') cb();\n  }\n\n  function userJoin(headerId, userData, $joinButton) {\n    if (!userData || !userData.userId) {\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n      return false;\n    }\n\n    // check if user already in that room\n    if (currentRoom && currentRoom.headerId === headerId) {\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n      return false;\n    }\n\n    $joinBtn = $joinButton;\n\n    const padparticipators = window.pad.collabClient.getConnectedUsers().map((x) => x.userId);\n\n    if (!currentRoom.userId) {\n      socket.emit('userJoin', padId, padparticipators, userData, 'text', addUserToRoom);\n    } else {\n      socket.emit('userLeave', padId, currentRoom, 'text', (data, roomInfo, target) => {\n        removeUserFromRoom(data, roomInfo, 'text', () => {\n          socket.emit('userJoin', padId, padparticipators, userData, 'text', addUserToRoom);\n        });\n      });\n    }\n  }\n\n  function userLeave(headerId, userData, $joinButton) {\n    $joinBtn = $joinButton;\n    socket.emit('userLeave', padId, userData, 'text', removeUserFromRoom);\n  }\n\n  function postAceInit(hook, context, webSocket, docId) {\n    socket = webSocket;\n    padId = docId;\n    Helper.wrtcPubsub.emit('componentsFlow', 'text', 'init', true);\n    eventListers();\n  }\n\n  function appendTextChatModalToBody() {\n    const textChatModal = $('#wrtcTextChatModal').tmpl({});\n    $('body').append(textChatModal);\n  }\n\n  return {\n    postAceInit,\n    activateModal,\n    deactivateModal,\n    userJoin,\n    userLeave,\n    removeUserFromRoom,\n    addUserToRoom,\n    appendTextChatModalToBody,\n\n  };\n})();\n","'use strict';\n\nconst videoChat = (() => {\n  let socket = null;\n  let padId = null;\n  let currentRoom = {};\n  let VIDEOCHATLIMIT = 0;\n  let $joinBtn = null;\n  let networkInterval = null;\n  const pingos = {\n    startTime: 0,\n    latency: 0,\n    LMin: 0,\n    LMax: 0,\n    avg: 0,\n    LineAvg: [],\n    colors: {\n      normal: '#fff',\n      warning: '#ffcc00',\n      danger: '#cc3300',\n    },\n    interavCheck: 1000,\n  };\n\n  const startWatchNetwork = function startWatchNetwork() {\n    networkInterval = setInterval(() => {\n      pingos.startTime = Date.now();\n      socket.emit('pingil', padId, window.headerId, Helper.getUserId(), pingos.avg);\n    }, pingos.interavCheck);\n  };\n\n  const stopWatchNetwork = () => clearInterval(networkInterval);\n\n  function mediaDevices() {\n    navigator.mediaDevices.enumerateDevices().then((data) => {\n      let videoSettings = localStorage.getItem('videoSettings') || {microphone: null, speaker: null, camera: null};\n\n      if (typeof videoSettings === 'string') {\n        videoSettings = JSON.parse(videoSettings);\n      }\n\n      const audioInputSection = document.querySelector('#wrtc_settings .select.audioSource');\n      const audioOutputSection = document.querySelector('#wrtc_settings .select.audioOutputSec');\n      const videoSection = document.querySelector('#wrtc_settings .select.videoSource');\n\n      const audioInputElement = document.createElement('select');\n      const audioOutputElement = document.createElement('select');\n      const videoElement = document.createElement('select');\n\n      for (let i = 0; i !== data.length; ++i) {\n        const deviceInfo = data[i];\n        const option = document.createElement('option');\n        option.value = deviceInfo.deviceId;\n        if (deviceInfo.kind === 'audioinput') {\n          option.text = deviceInfo.label || `microphone ${audioInputSection ? audioInputSection.length + 1 : '1'}`;\n          if (videoSettings.microphone === deviceInfo.deviceId) option.selected = true;\n          audioInputElement.appendChild(option);\n        } else if (deviceInfo.kind === 'audiooutput') {\n          option.text = deviceInfo.label || `speaker ${audioOutputSection ? audioOutputSection.length + 1 : '1'}`;\n          if (videoSettings.speaker === deviceInfo.deviceId) option.selected = true;\n          audioOutputElement.appendChild(option);\n        } else if (deviceInfo.kind === 'videoinput') {\n          option.text = deviceInfo.label || `camera ${videoSection ? videoSection.length + 1 : '1'}`;\n          if (videoSettings.camera === deviceInfo.deviceId) option.selected = true;\n          videoElement.appendChild(option);\n        }\n      }\n\n      audioInputSection.appendChild(audioInputElement);\n      audioOutputSection.appendChild(audioOutputElement);\n      videoSection.appendChild(videoElement);\n    });\n  }\n\n  const isUserMediaAvailable = () => window.navigator.mediaDevices.getUserMedia({audio: true, video: true});\n\n  function removeUserFromRoom(data, roomInfo, cb) {\n    if (!data || !roomInfo || !data.userId) return false;\n    const headerId = data.headerId;\n    const headerTitle = Helper.findAceHeaderElement(headerId).text;\n\n    const userCount = roomInfo.present;\n    $(`.header_videochat_icon[data-id='${headerId}'] .icon .userCount`).text(userCount);\n\n    if (userCount === 0) $(`.header_videochat_icon[data-id='${headerId}'] .icon .userCount`).text('');\n\n    const user = Helper.getUserFromId(data.userId);\n\n    if (user && data.action !== 'JOIN' && data.action !== 'RELOAD') {\n      // notify, a user join the video-chat room\n      const msg = {\n        time: new Date(),\n        userId: data.userId || user.userId,\n        userName: data.name || user.name || 'anonymous',\n        headerId: data.headerId,\n        userCount,\n        headerTitle,\n        VIDEOCHATLIMIT,\n      };\n      $(`.header_videochat_icon[data-id='${headerId}'] .icon`).removeClass('active');\n      Helper.notifyNewUserJoined('PLUS', msg, 'LEAVE');\n    }\n\n    if (data.userId === clientVars.userId) {\n      Helper.$body_ace_outer().find(`#wrtcVideoIcons #${headerId}`).removeClass('active');\n      WRTC.deactivate(data.userId, data.headerId);\n      stopWatchNetwork();\n      window.headerId = null;\n\n      const videoBtn = Helper.findAceHeaderElement(headerId).$inlineIcon();\n      if (videoBtn) videoBtn.querySelector('.btn_roomHandler').classList.remove('active');\n\n      currentRoom = {};\n\n      $('#wrtc_modal').css({\n        transform: 'translate(-50%, -100%)',\n        opacity: 0,\n      }).attr({'data-active': false});\n\n      WRTC.deactivate(data.userId, data.headerId);\n\n      Helper.wrtcPubsub.emit('componentsFlow', 'video', 'open', false);\n\n      Helper.stopStreaming();\n      socket.removeListener(`receiveTextMessage:${data.headerId}`);\n    }\n\n    if (cb && typeof cb === 'function') cb();\n\n    Helper.wrtcPubsub.emit('update store', data, headerId, 'LEAVE', 'VIDEO', roomInfo, () => {});\n\n    Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n\n    WRTC.userLeave(data.userId);\n  }\n\n  function addUserToRoom(data, roomInfo) {\n    if (!data || !data.userId) return false;\n    const headerId = data.headerId;\n    const headerTitle = Helper.findAceHeaderElement(headerId).text;\n\n    const user = Helper.getUserFromId(data.userId);\n    // some user may session does exist but the user info does not available in all over the current pad\n    if (!user) return true;\n\n    // TODO: this is not good idea, use global state\n    // if incoming user has already in the room don't persuade the request\n    // if (IsUserInRooms) return false;\n    const userCount = roomInfo.present;\n\n    $(`.header_videochat_icon[data-id='${headerId}'] .icon .userCount`).text(userCount);\n    if (userCount === 0) $(`.header_videochat_icon[data-id='${headerId}'] .icon .userCount`).text('');\n\n    if (data.action === 'JOIN') {\n      // notify, a user join the video-chat room\n      const msg = {\n        time: new Date(),\n        userId: data.userId,\n        userName: user.name || data.name || 'anonymous',\n        headerId,\n        userCount,\n        headerTitle,\n        VIDEOCHATLIMIT,\n      };\n\n      Helper.notifyNewUserJoined('PLUS', msg, 'JOIN');\n    }\n\n    $(`.header_videochat_icon[data-id='${headerId}'] .icon`).addClass('active');\n\n    if (data.userId === clientVars.userId) {\n      window.headerId = data.headerId;\n\n      startWatchNetwork();\n\n      const videoBtn = Helper.findAceHeaderElement(headerId).$inlineIcon();\n      if (videoBtn) videoBtn.querySelector('.btn_roomHandler').classList.add('active');\n\n\n      WRTC.activate(data.headerId, user.userId);\n\n      $('#wrtc_modal').css({\n        transform: 'translate(-50%, 0)',\n        opacity: 1,\n      }).attr({'data-active': true});\n\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'JOIN', $joinBtn);\n      Helper.wrtcPubsub.emit('componentsFlow', 'video', 'open', true);\n\n      // this request send once! and must be fire when the room is empty\n      if (!currentRoom.userId && roomInfo.present === 1) {\n        socket.emit('acceptNewCall', padId, window.headerId);\n      }\n\n      currentRoom = data;\n\n      // update modal title, attributes and inline avatart\n      Helper.wrtcPubsub.emit('updateWrtcToolbarModal', headerId, roomInfo);\n\n      // if videochat active and new message send to chat! open header textchat modal\n      socket.on(`receiveTextMessage:${headerId}`, (headingId, msg) => {\n        const active = $(document).find('#wrtc_textChatWrapper').hasClass('active');\n        if (headingId === headerId && !active) {\n          textChat.userJoin(headerId, data, 'TEXT');\n        }\n      });\n    }\n\n    Helper.wrtcPubsub.emit('update store', data, headerId, 'JOIN', 'VIDEO', roomInfo, () => {});\n  }\n\n  function createSession(headerId, userInfo, $joinButton) {\n    Helper.$body_ace_outer().find('button.btn_joinChat_chatRoom').removeClass('active');\n    $joinBtn = $joinButton;\n    isUserMediaAvailable().then((stream) => {\n      // stop last stream\n      Helper.stopStreaming(() => {\n        Helper.wrtcStore.localstream = stream;\n      });\n\n      const padparticipators = window.pad.collabClient.getConnectedUsers().map((x) => x.userId);\n\n      if (!currentRoom.userId) {\n        return socket.emit('userJoin', padId, padparticipators, userInfo, 'video', gateway_userJoin);\n      }\n      // If the user has already joined the video chat, make suer leave that room then join to the new chat room\n      socket.emit('userLeave', padId, currentRoom, 'video', (_userData, roomInfo) => {\n        gateway_userLeave(_userData, roomInfo, () => {\n          socket.emit('userJoin', padId, padparticipators, userInfo, 'video', gateway_userJoin);\n        });\n      });\n    }).catch((err) => {\n      console.error(err);\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n      Helper.wrtcPubsub.emit('componentsFlow', 'video', 'open', false);\n      Helper.stopStreaming();\n      socket.emit('userLeave', padId, currentRoom, 'video', (_userData, roomInfo) => {\n        gateway_userLeave(_userData, roomInfo);\n      });\n      WRTC.showUserMediaError(err, Helper.getUserId(), headerId);\n    });\n  }\n\n  function userJoin(headerId, userInfo, $joinButton) {\n    if (!userInfo || !userInfo.userId) {\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n      return false;\n    }\n\n    // check if has user already in the room\n    if (currentRoom && currentRoom.headerId === headerId) {\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n      return false;\n    }\n\n    createSession(headerId, userInfo, $joinButton);\n  }\n  // depricate\n  function reloadCurrentSession(headerId, userInfo, $joinButton) {\n    if (!userInfo || !userInfo.userId) {\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n      return false;\n    }\n\n    createSession(headerId, userInfo, $joinButton, 'RELOAD');\n  }\n\n  function reloadSession(headerId, userInfo, $joinButton) {\n    if (!userInfo || !userInfo.userId) {\n      Helper.wrtcPubsub.emit('enable room buttons', headerId, 'LEAVE', $joinBtn);\n      return false;\n    }\n    socket.emit('reloadVideoSession', padId, headerId);\n  }\n\n  function userLeave(headerId, data, $joinButton) {\n    $joinBtn = $joinButton;\n    socket.emit('userLeave', padId, data, 'video', gateway_userLeave);\n  }\n\n  function reachedVideoRoomSize(roomInfo, showAlert, isBulkUpdate) {\n    if (roomInfo && roomInfo.present <= VIDEOCHATLIMIT) return true;\n\n    showAlert = showAlert || true;\n    if (showAlert && !isBulkUpdate) {\n      $.gritter.add({\n        title: 'Video chat Limitation',\n        text: `The video chat room has reached its limit. \\r\\n The size of this video chat room is ${VIDEOCHATLIMIT}.\n\t\t\t\t(If this seems wrong, please share the problem with the support team.)\n\t\t\t\t`,\n        sticky: false,\n        class_name: 'error',\n        time: '5000',\n      });\n    }\n\n    return false;\n  }\n\n  /**\n  *\n  * @param {Object} data @requires\n  * @param {String} data.padId @requires\n  * @param {String} data.userId @requires\n  * @param {String} data.userName @requires\n  * @param {String} data.headerId\n  *\n  * @param {Object} roomInfo\n  * @param {Boolean} showAlert\n  * @param {Boolean} bulkUpdate\n *\n *\t@returns\n  */\n  function gateway_userJoin(data, roomInfo, showAlert = true, bulkUpdate = false) {\n    console.info('[wrtc]: gateway user joining,', data, roomInfo, showAlert);\n    // If user data does not exist reutrn false\n    if (!data) return reachedVideoRoomSize(null, false, false);\n\n    // if user data exist then check room size\n    if (data && reachedVideoRoomSize(roomInfo, showAlert, bulkUpdate)) {\n      return addUserToRoom(data, roomInfo);\n    } else if (bulkUpdate) {\n      return addUserToRoom(data, roomInfo);\n    }\n    Helper.stopStreaming();\n    return false;\n  }\n\n  function gateway_userLeave(data, roomInfo, cb) {\n    removeUserFromRoom(data, roomInfo, cb);\n  }\n\n  function postAceInit(hook, context, webSocket, docId) {\n    socket = webSocket;\n    padId = docId;\n    VIDEOCHATLIMIT = 2000; // clientVars.webrtc.videoChatLimit;\n    Helper.wrtcPubsub.emit('componentsFlow', 'video', 'init', true);\n    // mediaDevices();\n\n    socket.on('userLatancy', (data) => {\n      if (Helper.getUserId() !== data.userId) {\n        const videoId = `interface_video_${data.userId.replace(/\\./g, '_')}`;\n\n        let color = pingos.colors.normal;\n        if (data.latency > 200 && data.latency < 300) color = pingos.colors.warning;\n        if (data.latency > 300) color = pingos.colors.danger;\n\n        $(document)\n            .find(`#${videoId} .latency`)\n            .css({color})\n            .text(`${Math.ceil(data.latency)}ms`);\n      }\n    });\n    socket.on('pongol', (data) => {\n      pingos.latency = Date.now() - pingos.startTime;\n\n      if (pingos.LMin <= pingos.latency && pingos.latency >= pingos.LMax) pingos.LMax = pingos.latency; else pingos.LMin = pingos.latency;\n\n      // console.log( 'Websocket RTT: ' + pingos.latency + ' ms', \"min:\", pingos.LMin, \"max\", pingos.LMax, \"avg:\", pingos.avg );\n\n      if (pingos.LineAvg.length < 4) { pingos.LineAvg.push((pingos.LMax + pingos.LMin) / 2); } else {\n        pingos.avg = pingos.LineAvg.reduce((a, b) => a + b) / pingos.LineAvg.length;\n        // console.log(pingos.LineAvg)\n        pingos.LineAvg = [];\n        pingos.LMax = 0;\n      }\n\n      let color = pingos.colors.normal;\n      if (pingos.avg > 200 && pingos.avg < 300) color = pingos.colors.warning;\n      if (pingos.avg > 300) color = pingos.colors.danger;\n\n      $(document)\n          .find('.video-container.local-user .latency')\n          .css({color})\n          .text(`${Math.ceil(pingos.avg)}ms`);\n\n      // $(document).find('#networkStatus').html(`RTT: ${pingos.latency}ms, min: ${pingos.LMin}ms, max: ${pingos.LMax}ms, avg:${pingos.avg}ms`);\n\n      // Helper.wrtcPubsub.emit('update network information', pingos);\n    });\n    socket.on('reloadVideoSession', (headerId) => {\n      if (currentRoom.headerId !== headerId) return false;\n      const target = 'PLUS';\n      const userInfo = {\n        padId: clientVars.padId || window.pad.getPadId(),\n        userId: clientVars.userId || window.pad.getUserId(),\n        userName: clientVars.userName || 'anonymous',\n        headerId,\n        target,\n        action: 'JOIN',\n      };\n      Helper.wrtcPubsub.emit('disable room buttons', headerId, 'JOIN', target);\n      createSession(headerId, userInfo, target);\n    });\n  }\n\n  return {\n    postAceInit,\n    userJoin,\n    userLeave,\n    gateway_userJoin,\n    gateway_userLeave,\n    reloadSession,\n    reloadCurrentSession,\n    mediaDevices,\n\n  };\n})();\n","'use strict';\n\nconst WrtcRoom = (() => {\n  let socket = null;\n  let padId = null;\n  let VIDEOCHATLIMIT = 0;\n  let tryToJoinByQueryString = 0;\n\n\n  /** --------- Helper --------- */\n\n  function scroll2Header(headerId) {\n    const padContainer = Helper.$body_ace_outer().find('iframe').contents().find('#innerdocbody');\n    padContainer.find(`.videoHeader.${headerId}`).each(function scrolling() {\n      this.scrollIntoView({\n        behavior: 'smooth',\n      });\n    });\n  }\n\n  const closeTextChat = () => $('#wrtc_textChatWrapper .btn_leave').trigger('click');\n\n  function joinChatRoom(headerId, userInfo, target) {\n    // textChat.userJoin(headerId, userInfo, 'TEXTPLUS');\n    videoChat.userJoin(headerId, userInfo, 'PLUS');\n    closeTextChat();\n  }\n\n  function leaveChatRoom(headerId, userInfo, target) {\n    // textChat.userLeave(headerId, userInfo, 'TEXTPLUS');\n    videoChat.userLeave(headerId, userInfo, 'PLUS');\n    closeTextChat();\n  }\n\n  /**\n\t *\n\t * @param {string} actions @enum (JOIN|LEAVE|RELOAD|SHARELINK|USERPROFILEMODAL|JOINBYQUERY)\n\t * @param {string} headerId\n\t * @param {string} target @enum (chatRoom|video|text)\n\t */\n  function roomBtnHandler(actions, headerId, target) {\n    if (typeof actions !== 'string') {\n      actions.preventDefault();\n      // no idea! but in somecases! this function fire twice!\n      // the first one has selector, but the second one has not any selector\n      if (!actions.handleObj.selector) return false;\n    }\n\n    headerId = $(this).attr('data-id') || headerId;\n    actions = $(this).attr('data-action') || actions;\n    target = $(this).attr('data-join') || target;\n\n    if (!headerId || !target) return true;\n\n    // If the plugin is disabled\n    if (!Helper.wrtcStore.enable) {\n      console.info('[wrtc]: Plugin disabled');\n      return;\n    }\n\n    const hasHref = $(this).attr('href');\n    // if the link belong to the other pad.\n    // navigate to the new pad\n    // TODO: URL should be sanitize and then decided to navigate\n    if (hasHref) {\n      const url = new URL(hasHref);\n      if (url.pathname !== location.pathname) window.location = hasHref;\n    }\n\n    const userInfo = {\n      padId: clientVars.padId || window.pad.getPadId(),\n      userId: clientVars.userId || window.pad.getUserId(),\n      userName: clientVars.userName || 'anonymous',\n      headerId,\n      target,\n      action: actions,\n\n    };\n    // Before handel request, check socket state\n    if (Helper.wrtcStore.socketState !== 'OPEND') {\n      // show the alert that user must reload the page\n      $.gritter.add({\n        title: 'Video chat no longer responds',\n        text: 'The socket is disconnected and we can no longer make a stable call, please go to stable internet and then reload the page.',\n        sticky: false,\n        class_name: 'error',\n        time: '15000',\n      });\n      return false;\n    }\n\n    if (actions === 'JOIN') {\n      Helper.wrtcPubsub.currentOpenRoom = userInfo;\n      switch (target) {\n        case 'PLUS':\n          Helper.wrtcPubsub.emit('disable room buttons', headerId, actions, target);\n          joinChatRoom(headerId, userInfo, target);\n          break;\n        case 'VIDEO':\n          Helper.wrtcPubsub.emit('disable room buttons', headerId, actions, target);\n          videoChat.userJoin(headerId, userInfo, target);\n          break;\n        case 'TEXT':\n          textChat.userJoin(headerId, userInfo, target);\n          break;\n        default:\n          return false;\n      }\n    } else if (actions === 'LEAVE') {\n      Helper.wrtcPubsub.currentOpenRoom = null;\n      switch (target) {\n        case 'PLUS':\n          leaveChatRoom(headerId, userInfo, target);\n          break;\n        case 'VIDEO':\n          videoChat.userLeave(headerId, userInfo, target);\n          break;\n        case 'TEXT':\n          textChat.userLeave(headerId, userInfo, target);\n          break;\n        default:\n          return false;\n      }\n    } else if (actions === 'RELOAD') {\n      videoChat.reloadSession(headerId, userInfo, target, actions);\n    } else if (actions === 'SHARELINK') {\n      shareRoomsLink(headerId, target);\n    } else if (actions === 'USERPROFILEMODAL') {\n      showUserProfileModal(headerId);\n    } else if (actions === 'JOINBYQUERY') {\n      const href = $(this).attr('href');\n      joinByQueryString(href);\n    }\n  }\n\n  function joinByQueryString(url) {\n    url = url || window.location.href;\n    const urlParams = new URLSearchParams(url);\n    const headerId = urlParams.get('id');\n    let target = urlParams.get('target');\n    const join = urlParams.get('join');\n\n    if (!headerId) return true;\n\n    const inComeURL = new URL(url);\n    const inComePadName = inComeURL.pathname.split('/').pop();\n    const currentPadName = location.pathname.split('/').pop();\n\n    // check if header id belong to this pad\n    // then if it's not check padName\n\n    if (!Helper.wrtcStore.rooms.get(headerId)) {\n      if (inComePadName !== currentPadName) return window.location.href = url;\n      $.gritter.add({\n        title: 'Error',\n        text: 'The header seems not to exist anymore!',\n        time: 3000,\n        sticky: false,\n        class_name: 'error',\n      });\n      return false;\n    }\n\n    if (headerId) scroll2Header(headerId);\n\n    if (join === 'true' && target) {\n      target = target.toUpperCase();\n\n      if(Helper.wrtcStore.socketState === 'CLOSED' && tryToJoinByQueryString <= 4) {\n        setTimeout(() => {\n          console.warn(`[wrtc]: socket state is ${Helper.wrtcStore.socketState}, try to join again!`);\n          tryToJoinByQueryString++;\n          joinByQueryString();\n        }, 1500);\n      } else if(Helper.wrtcStore.socketState === 'OPEND') {\n        setTimeout(() => roomBtnHandler('JOIN', headerId, target), 1000);\n      } else {\n        console.error(`[wrtc]: We try to join ${tryToJoinByQueryString}th,Joining by query string has problem!`, Helper.wrtcStore.socketState, tryToJoinByQueryString)\n      }\n\n    }\n  }\n\n  // if history state has change fire joinQueryString\n  document.addEventListener('onPushState', (event) => {\n    const {state} =  event.detail\n    if(state.type === \"hyperLink\"){\n      const href= state.href\n      joinByQueryString(href)\n    }\n  });\n\n  function shareRoomsLink(headId, target) {\n    headId = $(this).attr('data-id') || headId;\n    target = $(this).attr('data-join') || target;\n    target = target.toLowerCase();\n\n    const title = Helper.$body_ace_outer().find('iframe').contents()\n      .find('#innerdocbody').find(`.heading.${headerId}`).text();\n\n    const origin = window.location.origin;\n    const pathName = window.location.pathname;\n    const link = `${origin + pathName}?header=${Helper.slugify(title)}&id=${headId}&target=${target}&join=true`;\n\n    const $temp = $('<input>');\n    $('body').append($temp);\n    $temp.val(link).select();\n    document.execCommand('copy');\n    $temp.remove();\n\n    $.gritter.add({\n      title: 'Copied',\n      text: 'Join link copied to clip board',\n      sticky: false,\n      class_name: 'copyLinkToClipboard',\n      time: '3000',\n    });\n  }\n\n  function getHeaderRoomY($element) {\n    const height = $element.outerHeight();\n    const paddingTop = Helper.$body_ace_outer().find('iframe[name=\"ace_inner\"]').css('padding-top');\n    const aceOuterPadding = parseInt(paddingTop, 10);\n    const offsetTop = Math.ceil($element.offset().top + aceOuterPadding);\n    return offsetTop + height / 2 - 22;\n  }\n\n  function showUserProfileModal(headerId) {\n    const userId = $(this).attr('data-id') || headerId;\n    const user = window.clientVars.ep_profile_list[userId];\n    if (!user) return false;\n    const imageUrl = user.imageUrl || `/static/getUserProfileImage/${userId}/${padId}?t=${new Date().getTime()}`;\n    $('#ep_profile_users_profile_name').text(user.userName);\n    $('#ep_profile_users_profile_desc').text(user.about);\n    $('#ep_profile_users_profile_homepage').attr({\n      href: Helper.getValidUrl(user.homepage),\n      target: '_blank',\n    });\n\n    $('#ep_profile_users_profile').addClass('ep_profile_formModal_show');\n    $('#ep_profile_general_overlay').addClass('ep_profile_formModal_overlay_show');\n    $('#ep_profile_general_overlay').css({display: 'block'});\n\n    $('#ep_profile_users_profile_userImage').css({\n      'background-position': '50% 50%',\n      'background-image': `url(${imageUrl})`,\n      'background-repeat': 'no-repeat',\n      'background-size': '69px',\n      'background-color': '#485365',\n    });\n  }\n\n  function activeEventListener() {\n    const $AceOuter = Helper.$body_ace_outer();\n\n    $AceOuter.on('click', '.btn_roomHandler', roomBtnHandler);\n\n    // $AceOuter.find('iframe').contents().find('#innerdocbody').on('click', 'wrt-inline-icon', function () {\n    //   const $btn = this.shadowRoot.querySelector('.btn_roomHandler');\n    //   const headerId = $btn.getAttribute('data-id');\n    //   const action = $btn.getAttribute('data-action');\n    //   const target = $btn.getAttribute('data-join');\n    //   roomBtnHandler(action, headerId, target);\n    // });\n\n    $AceOuter.find('iframe').contents().find('#innerdocbody')\n      .on('click', 'chat-inline-icon', function () {\n        const headerId = $(this).attr('data-headerid');\n        $(document)\n          .find(`#tocItems .itemRow.tocItem[sectionid='${headerId}']`)\n          .trigger(\"click\");\n      });\n\n\n\n\n    // integration with ep_rocketChat\n    $(document).on('click', '#toc .itemRow.tocItem', function () {\n      const headerId = $(this).attr('sectionid');\n      const room = Helper.wrtcStore.rooms.get(headerId);\n\n      // clear the button\n      $('.header_videochat_icon').attr('data-id', headerId);\n      $('.header_videochat_icon .icon').removeClass('active');\n      $('.header_videochat_icon .icon .userCount').text('');\n\n      // check wrtc store\n      const userPresent = room.VIDEO.present === 0 ? \"\" : room.VIDEO.present;\n      $('.header_videochat_icon .icon .userCount').text(userPresent);\n      // does the current user present in this room\n      const currentUserPresent = room.VIDEO.list.find((x) => x.userId === clientVars.userId);\n\n      if (currentUserPresent) $('.header_videochat_icon .icon').addClass('active');\n    });\n\n    $(document).on('click', '.btn_roomHandler, .wrtc_roomLink', roomBtnHandler);\n\n    $(document).on('mouseenter', '.video-container.local-user', () => {\n      $(document).find('#wrtc_modal #networkStatus').addClass('active');\n    }).on('mouseleave', '.video-container.local-user', () => {\n      $(document).find('#wrtc_modal #networkStatus').removeClass('active');\n    });\n\n    $(document).on('click', '#werc_toolbar p, .textChatToolbar b', function click() {\n      const headerId = $(this).attr('data-id');\n      scroll2Header(headerId);\n    });\n\n    $(document).on('click', '#werc_toolbar .btn_enlarge', function click() {\n      if (!$(this).attr('active')) return true;\n\n      $(this).toggleClass('large');\n\n      $('#wrtc_modal .video-container .enlarge-btn').each(function trigger() {\n        $(this).trigger('click');\n      });\n    });\n\n    // video interface settings\n    $(document).on('click', '#werc_toolbar .btn_videoSetting', function click() {\n      const offset = $(this).position();\n      const $box = $(document).find('#wrtc_settings');\n      const width = $box.outerWidth();\n      $box.css({left: `${offset.left - width}px`, top: `${offset.top + 4}px`}).toggleClass('active');\n    });\n  }\n\n  var self = {\n    joinByQueryString,\n    roomBtnHandler,\n    aceSetAuthorStyle: function aceSetAuthorStyle(context) {\n      if (context.author) {\n        const user = Helper.getUserFromId(context.author);\n        if (user) {\n          // sync user info\n          const userName = user.name || 'anonymous';\n          Helper.$body_ace_outer().find(`.wrtc_content.textChat ul li[data-id='${user.userId}']`).css({'border-color': user.colorId}).text(userName);\n          Helper.$body_ace_outer().find(`.wrtc_content.videoChat ul li[data-id='${user.userId}']`).css({'border-color': user.colorId}).text(userName);\n        }\n      }\n    },\n    userLeave: function userLeave(context, callback) {\n      // Deprecated, we use socket disconnect\n    },\n    postAceInit: function postAceInit(hook, context, webSocket, docId) {\n      socket = webSocket;\n      padId = docId;\n      VIDEOCHATLIMIT = clientVars.webrtc.videoChatLimit;\n      Helper.wrtcPubsub.emit('componentsFlow', 'room', 'init', true);\n\n      socket.on('userJoin', (data, roomInfo, target) => {\n        if (target === 'video') {\n          videoChat.gateway_userJoin(data, roomInfo, false);\n        } else {\n          textChat.addUserToRoom(data, roomInfo, target);\n        }\n      });\n\n      socket.on('userLeave', (data, roomInfo, target) => {\n        if (target === 'video') {\n          videoChat.gateway_userLeave(data, roomInfo, target);\n        } else {\n          textChat.removeUserFromRoom(data, roomInfo, target);\n        }\n      });\n\n      activeEventListener();\n\n      // check if there is a join request in URI queryString\n      setTimeout(() => {\n        joinByQueryString();\n      }, 500);\n    },\n    adoptHeaderYRoom: function adoptHeaderYRoom() {\n      // Set all video_heading to be inline with their target REP\n      const $padOuter = Helper.$body_ace_outer();\n      if (!$padOuter) return;\n\n      // TODO: performance issue\n      $padOuter.find('#wbrtc_avatarCol .wrtcIconLine').each(function adjustHeaderIconPosition() {\n        const $el = $(this);\n        const $headerId = $el.attr('id');\n        const $headingEl = Helper.findAceHeaderElement($headerId).$el;\n\n        // if the H tags does not find, remove chatBox\n        // TODO: and kick out the user form the chatBox\n        if ($headingEl.length <= 0) {\n          $el.remove();\n          return false;\n        }\n\n        $el.css({top: `${Helper.getHeaderRoomY($headingEl) - 16}px`});\n      });\n    },\n    appendVideoIcon: function appendVideoIcon(headerId, options = {createAgain: false}) {\n      if (!headerId) return false;\n\n      const roomExist = Helper.wrtcStore.rooms.has(headerId);\n      if (!options.createAgain && roomExist) return false;\n\n      const $elRoomExist = Helper.findAceHeaderElement(headerId);\n\n      if (!roomExist && $elRoomExist.exist) {\n        const $el = Helper.$body_ace_outer().find('iframe')\n            .contents()\n            .find('#innerdocbody')\n            .children('div')\n            .find(`.videoHeader.${headerId}`);\n\n        const aceInnerOffset = Helper.$body_ace_outer().find('iframe[name=\"ace_inner\"]').offset();\n        const target = Helper.$body_ace_outer().find('#outerdocbody');\n        const newY = getHeaderRoomY($el);\n        const newX = Math.ceil(aceInnerOffset.left);\n        const lineNumber = $el.parent().parent().prevAll().length;\n\n        const data = {\n          headingTagId: headerId,\n          positionTop: newY,\n          positionLeft: newX,\n          headTitle: $el.text(),\n          lineNumber,\n          videoChatLimit: VIDEOCHATLIMIT,\n        };\n\n        Helper.wrtcStore.rooms.set(headerId, {VIDEO: {list: []}, TEXT: {list: []}, USERS: {}, headerCount: 0});\n\n        const box = $('#wrtcLinesIcons').tmpl(data);\n        target.find('#wrtcVideoIcons').append(box);\n        // check the room that has user in there\n        // padId, headerId\n        socket.emit('getVideoRoomInfo', padId, headerId, (result) => {\n          if (result) Helper.inlineAvatar.ROOM(headerId, result);\n        });\n      }\n\n      self.adoptHeaderYRoom();\n    },\n    syncVideoAvatart: (headerId) => {\n      socket.emit('getVideoRoomInfo', padId, headerId, (result) => {\n        if (result) Helper.inlineAvatar.ROOM(headerId, result);\n      });\n    },\n  };\n\n  return self;\n})();\n","/**\n * Copyright 2013 j <j@mailb.org>\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n'use strict';\n\nconst WRTC = (() => {\n  const attemptRonnect = 60;\n  let reconnected = 0;\n  const videoSizes = {large: '260px', small: '160px'};\n  const pcConfig = {};\n  let audioInputSelect = null;\n  let videoSelect = null;\n  let audioOutputSelect = null;\n  const pcConstraints = {\n    optional: [{\n      DtlsSrtpKeyAgreement: true,\n    }],\n  };\n  const sdpConstraints = {\n    mandatory: {\n      OfferToReceiveAudio: true,\n      OfferToReceiveVideo: true,\n    },\n  };\n\n  const remoteStream = {};\n  const pc = {};\n  const callQueue = [];\n  const enlargedVideos = new Set();\n  let localVideoElement = null;\n  let padId = null;\n  let socket = null;\n\n  var self = {\n    // API HOOKS\n    postAceInit: function postAceInit(hook, context, webSocket, docId) {\n      padId = docId;\n      socket = webSocket;\n\n      if (!clientVars.webrtc) throw new Error('[wrtc]: webrtc settings not found');\n\n      pcConfig.iceServers = clientVars.webrtc.iceServers;\n\n      if (clientVars.webrtc.video.sizes.large) {\n        videoSizes.large = `${clientVars.webrtc.video.sizes.large}px`;\n      }\n      if (clientVars.webrtc.video.sizes.small) {\n        videoSizes.small = `${clientVars.webrtc.video.sizes.small}px`;\n      }\n\n      self._pad = context.pad || window.pad;\n\n      $(document).on('change', 'select#audioSource', self.audioVideoInputChange);\n      $(document).on('change', 'select#videoSource', self.audioVideoInputChange);\n      $(document).on('change', 'select#audioOutput', self.changeAudioDestination);\n\n      $(window).on('unload', () => {\n        console.info('[wrtc]: windos unloaded, now hangupAll');\n        self.hangupAll();\n      });\n      socket.on('RTC_MESSAGE', (context) => {\n        // filter RTC_message just for how is in headerId room\n        const payload = context.data.payload;\n        if (payload.to !== Helper.getUserId()) return;\n        if (payload.data.headerId === window.headerId) self.receiveMessage(context.data.payload);\n      });\n    },\n    appendVideoModalToBody: function appendVideoModalToBody() {\n      const $wrtcVideoModal = $('#wrtcVideoModal').tmpl({\n        videoChatLimit: clientVars.webrtc.videoChatLimit,\n        headerId: '',\n      });\n\n      $('body').prepend($wrtcVideoModal);\n\n      $(document).on('click', '#wrtc_modal .btn_toggle_modal', function () {\n        const $parent = $(this).parent().parent();\n        const action = $(this).attr('data-action');\n        const videoBox = $('#wrtc_modal .videoWrapper').innerHeight();\n\n        $(this).find('.fa_arrow-from-top').toggle();\n        $(this).find('.fa_arrow-to-top').toggle();\n\n        if (action === 'collapse') {\n          $(this).attr({'data-action': 'expand'});\n          $parent.find('.btn_enlarge').removeAttr('active');\n          $('#wrtc_modal').css({\n            transform: `translate(-50%, -${videoBox}px)`,\n          });\n        } else {\n          $(this).attr({'data-action': 'collapse'});\n          $parent.find('.btn_enlarge').attr({active: true});\n          $('#wrtc_modal').css({\n            transform: 'translate(-50%, 0)',\n          });\n        }\n      });\n\n      $(document).on('click', '#wrtc_settings .btn_info', function click() {\n        const userID = Object.keys(pc);\n        const $this = $(this);\n        const isActive = $this.attr('data-active');\n        const $modal = $(document).find('#wrtc_settings .wrtc_info');\n\n        if (isActive) {\n          $modal.hide();\n          if (pc[userID[0]]) {\n            getStats(pc[userID[0]], (result) => {\n              result.nomore();\n            });\n          }\n          $this.removeAttr('data-active');\n          return true;\n        } else {\n          $this.attr({'data-active': true});\n          $modal.show();\n        }\n\n        if (pc[userID[0]] && !isActive) {\n          (function () {\n            const bytesToSize = function bytesToSize(bytes) {\n              const k = 1000;\n              const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB'];\n              if (bytes <= 0) {\n                return '0 Bytes';\n              }\n              const i = parseInt(Math.floor(Math.log(bytes) / Math.log(k)), 10);\n\n              if (!sizes[i]) {\n                return '0 Bytes';\n              }\n\n              return `${(bytes / k ** i).toPrecision(3)} ${sizes[i]}`;\n            };\n\n            getStats(pc[userID[0]], (result) => {\n              const statistic = {\n                speed: bytesToSize(result.bandwidth.speed),\n                systemNetworkType: result.connectionType.systemNetworkType,\n                availableSendBandwidth: bytesToSize(result.bandwidth.availableSendBandwidth),\n                video: {\n                  'send.codecs': result.video.send.codecs.join(', '),\n                  'resolutions': `width ${result.resolutions.send.width}, height ${result.resolutions.send.height}`,\n                  'resolutions': `width ${result.resolutions.recv.width}, height ${result.resolutions.recv.height}`,\n                  'bytesSent': bytesToSize(result.video.bytesSent),\n                  'bytesReceived': bytesToSize(result.video.bytesReceived),\n                },\n                audio: {\n                  'send.codecs': result.audio.send.codecs.join(', '),\n                  // \"recv.codecs\": result.audio.recv.codecs.join(\", \"),\n                  'bytesSent': bytesToSize(result.audio.bytesSent),\n                  'bytesReceived': bytesToSize(result.audio.bytesReceived),\n                },\n              };\n              $(document).find('#wrtc_settings .wrtc_info').html(`<pre>${JSON.stringify(statistic, undefined, 2)}</pre>`);\n            }, 1000);\n          })();\n        }\n      });\n\n      $(document).on('click', '#wrtc_settings .btn_close', () => {\n        $('#wrtc_settings').toggleClass('active');\n        const $btnInfo = $('#wrtc_settings .btn_info');\n        if ($btnInfo.attr('data-active')) $btnInfo.trigger('click');\n      });\n    },\n    aceSetAuthorStyle: function aceSetAuthorStyle(context) {\n      if (context.author) {\n        const user = Helper.getUserFromId(context.author);\n        if (user) {\n          const userName = user.name || 'anonymous';\n          $(`#video_${user.userId.replace(/\\./g, '_')}`).css({\n            'border-color': user.colorId,\n          }).siblings('.user-name').text(userName);\n        }\n      }\n    },\n    userLeave: function userLeave(userId, context, callback) {\n      userId = userId || context.userInfo.userId;\n      if (userId && pc[userId]) {\n        gState = 'LEAVING';\n        self.hide(userId);\n        self.hangup(userId, true);\n      }\n      Helper.wrtcStore.userInRoom = false;\n      if (callback) callback();\n    },\n    // deprecated function\n    handleClientMessage_RTC_MESSAGE: function handleClientMessage_RTC_MESSAGE(hook, context) {\n      if (context.payload.data.headerId === window.headerId) self.receiveMessage(context.payload);\n    },\n    // END OF API HOOKS\n    show: function show() {\n      $('#pad_title').addClass('f_wrtcActive');\n      videoChat.mediaDevices();\n    },\n    showUserMediaError: function showUserMediaError(err, userId, headerId) {\n      // show an error returned from getUserMedia\n      let reason;\n      // For reference on standard errors returned by getUserMedia:\n      // https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n      // However keep in mind that we add our own errors in getUserMediaPolyfill\n      console.error(`[wrtc]: mediaError, ${err}`);\n      switch (err.name) {\n        case 'CustomNotSupportedError':\n          reason = 'Sorry, your browser does not support WebRTC. (or you have it disabled in your settings).<br><br>' + 'To participate in this audio/video chat you have to user a browser with WebRTC support like Chrome, Firefox or Opera.' + '<a href=\"http://www.webrtc.org/\" target=\"_new\">Find out more</a>';\n          self.sendErrorStat('NotSupported');\n          break;\n        case 'CustomSecureConnectionError':\n          reason = 'Sorry, you need to install SSL certificates for your Etherpad instance to use WebRTC';\n          self.sendErrorStat('SecureConnection');\n          break;\n        case 'NotAllowedError':\n          // For certain (I suspect older) browsers, `NotAllowedError` indicates either an insecure connection or the user rejecting camera permissions.\n          // The error for both cases appears to be identical, so our best guess at telling them apart is to guess whether we are in a secure context.\n          // (webrtc is considered secure for https connections or on localhost)\n          if (location.protocol === 'https:' || location.hostname === 'localhost' || location.hostname === '127.0.0.1') {\n            reason = 'Sorry, you need to give us permission to use your camera and microphone';\n            self.sendErrorStat('Permission');\n          } else {\n            reason = 'Sorry, you need to install SSL certificates for your Etherpad instance to use WebRTC';\n            self.sendErrorStat('SecureConnection');\n          }\n          break;\n        case 'NotFoundError':\n          reason = \"Sorry, we couldn't find a suitable camera on your device. If you have a camera, make sure it set up correctly and refresh this website to retry.\";\n          self.sendErrorStat('NotFound');\n          break;\n        case 'NotReadableError':\n          // `err.message` might give useful info to the user (not necessarily useful for other error messages)\n          reason = `Sorry, a hardware error occurred that prevented access to your camera and/or microphone:<br><br>${err.message}`;\n          self.sendErrorStat('Hardware');\n          break;\n        case 'AbortError':\n          // `err.message` might give useful info to the user (not necessarily useful for other error messages)\n          reason = `Sorry, an error occurred (probably not hardware related) that prevented access to your camera and/or microphone:<br><br>${err.message}`;\n          self.sendErrorStat('Abort');\n          break;\n        default:\n          // `err` as a string might give useful info to the user (not necessarily useful for other error messages)\n          reason = `Sorry, there was an unknown Error:<br><br>${err}`;\n          self.sendErrorStat('Unknown');\n      }\n      $.gritter.add({\n        title: 'Error',\n        text: `${reason}; try again!`,\n        time: 4000,\n        sticky: false,\n        class_name: 'error',\n      });\n      userId = userId || clientVars.userId;\n      headerId = headerId || window.headerId;\n      videoChat.userLeave(\n          headerId,\n          {\n            headerId,\n            padId,\n            userId,\n          }\n      );\n    },\n    hide: function hide(userId) {\n      if (!userId) return false;\n      userId = userId.split('.')[1];\n      $('#rtcbox').find(`#video_a_${userId}`).parent().remove();\n    },\n    activate: function activate(headerId) {\n      self.show();\n      self.hangupAll();\n      self.getUserMedia(headerId);\n      Helper.wrtcStore.userInRoom = true;\n    },\n    deactivate: function deactivate(userId, headerId) {\n      if (!userId) return false;\n      self.hide(userId);\n      self.hangupAll(headerId);\n      self.hangup(userId, true, headerId);\n      if (Helper.wrtcStore.localstream) Helper.stopStreaming();\n      Helper.wrtcStore.userInRoom = false;\n    },\n    toggleMuted: function toggleMuted() {\n      const audioTrack = Helper.wrtcStore.localstream.getAudioTracks()[0];\n      if (audioTrack) {\n        audioTrack.enabled = !audioTrack.enabled;\n        return !audioTrack.enabled; // returning \"Muted\" state, which is !enabled\n      }\n      return true; // if there's no audio track, it's muted\n    },\n    toggleVideo: function toggleVideo() {\n      const videoTrack = Helper.wrtcStore.localstream.getVideoTracks()[0];\n      if (videoTrack) {\n        videoTrack.enabled = !videoTrack.enabled;\n        return !videoTrack.enabled;\n      }\n    },\n    setStream: function setStream(userId, stream) {\n      if (!userId) return false;\n      const isLocal = userId === Helper.getUserId();\n      const videoId = `video_${userId.replace(/\\./g, '_')}`;\n      let video = $(`#${videoId}`)[0];\n\n      const user = Helper.getUserFromId(userId);\n\n      if (!video && stream) {\n        const videoContainer = $(\"<div class='video-container'>\").css({\n          'width': videoSizes.small,\n          'max-height': videoSizes.small,\n        }).appendTo($('#wrtc_modal .videoWrapper'));\n        const userName = user.name || 'anonymous';\n        videoContainer.append($('<div class=\"user-name\">').text(userName));\n\n        video = $('<video playsinline>').attr('id', videoId).css({\n          'border-color': user.colorId,\n          'width': videoSizes.small,\n          'max-height': videoSizes.small,\n        }).on({\n          loadedmetadata: function loadedmetadata() {\n            self.addInterface(userId);\n          },\n        }).appendTo(videoContainer)[0];\n\n        video.autoplay = true;\n        if (isLocal) {\n          videoContainer.addClass('local-user');\n          video.muted = true;\n        }\n        self.addInterface(userId);\n      }\n      if (stream) {\n        attachMediaStream(video, stream);\n      } else if (video) {\n        $(video).parent().remove();\n      }\n    },\n    addInterface: function addInterface(userId) {\n      if (!userId) return false;\n      const isLocal = userId === Helper.getUserId();\n      const videoId = `video_${userId.replace(/\\./g, '_')}`;\n      const $video = $(`#${videoId}`);\n\n      var $mute = $(\"<span class='interface-btn audio-btn buttonicon'>\").attr('title', 'Mute').on({\n        click: function click() {\n          let muted;\n          if (isLocal) {\n            muted = self.toggleMuted();\n          } else {\n            $video[0].muted = !$video[0].muted;\n            muted = $video[0].muted;\n          }\n          $mute.attr('title', muted ? 'Unmute' : 'Mute').toggleClass('muted', muted);\n        },\n      });\n      let videoEnabled = true;\n      var $disableVideo = isLocal ? $(\"<span class='interface-btn video-btn buttonicon'>\").attr('title', 'Disable video').on({\n        click: function click() {\n          self.toggleVideo();\n          videoEnabled = !videoEnabled;\n          $disableVideo.attr('title', videoEnabled ? 'Disable video' : 'Enable video').toggleClass('off', !videoEnabled);\n        },\n      }) : null;\n\n      let videoEnlarged = false;\n      var $largeVideo = $(\"<span class='interface-btn enlarge-btn buttonicon'>\").attr('title', 'Make video larger').on({\n        click: function click() {\n          videoEnlarged = !videoEnlarged;\n\n          if (videoEnlarged) {\n            enlargedVideos.add(userId);\n          } else {\n            enlargedVideos.delete(userId);\n          }\n\n          $largeVideo.attr('title', videoEnlarged ? 'Make video smaller' : 'Make video larger').toggleClass('large', videoEnlarged);\n\n          const videoSize = $(document).find('#wrtc_modal .ndbtn.btn_enlarge').hasClass('large') ? videoSizes.large : videoSizes.small;\n          $video.parent().css({'width': videoSize, 'max-height': videoSize});\n          $video.css({'width': videoSize, 'max-height': videoSize});\n        },\n      });\n\n      if ($(document).find('#wrtc_modal .ndbtn.btn_enlarge').hasClass('large')) {\n        $video.parent().css({'width': videoSizes.large, 'max-height': videoSizes.large});\n        $video.css({'width': videoSizes.large, 'max-height': videoSizes.large});\n      }\n\n      if (isLocal) localVideoElement = $video;\n\n      const $networkLatancy = $(\"<div class='latency'></div>\");\n\n      $(`#interface_${videoId}`).remove();\n      $(\"<div class='interface-container'>\").attr('id', `interface_${videoId}`).append($mute).append($disableVideo).append($largeVideo).append($networkLatancy).insertAfter($video);\n      self.changeAudioDestination();\n    },\n    // Sends a stat to the back end. `statName` must be in the\n    // approved list on the server side.\n    sendErrorStat: function sendErrorStat(statName) {\n      const msg = {component: 'pad', type: 'STATS', data: {statName, type: 'RTC_MESSAGE'}};\n      socket.emit('acceptNewCall', padId, window.headerId);\n      socket.emit('message', msg);\n    },\n    sendMessage: function sendMessage(to, data, socketIdTo) {\n      socket.emit('RTC_MESSAGE', {\n        type: 'RTC_MESSAGE',\n        payload: {data, to, padId, from: Helper.getUserId(), socket: {from: socket.id, to: socketIdTo}},\n      }, (data) => {\n        // console.log('coming data', data);\n      });\n      // deprecated function\n      // self._pad.collabClient.sendMessage({\n      // \ttype: 'RTC_MESSAGE',\n      //   payload: {data, to},\n      // });\n    },\n    receiveMessage: function receiveMessage(msg) {\n      const peer = msg.from; // userId\n      const data = msg.data;\n      const type = data.type;\n      if (peer === Helper.getUserId()) {\n        // console.info('ignore own messages');\n        return;\n      }\n      /*\n      if (type != 'icecandidate')\n        console.info('receivedMessage', 'peer', peer, 'type', type, 'data', data);\n      */\n      if (type === 'hangup') {\n        self.hangup(peer, true);\n      } else if (type === 'offer') {\n        if (pc[peer]) {\n          self.hangup(peer, true);\n          self.createPeerConnection(peer, data.headerId);\n        } else {\n          self.createPeerConnection(peer, data.headerId);\n        }\n        if (Helper.wrtcStore.localstream) {\n          if (pc[peer].getLocalStreams) {\n            if (!pc[peer].getLocalStreams().length) {\n              Helper.wrtcStore.localstream.getTracks().forEach((track) => {\n                pc[peer].addTrack(track, Helper.wrtcStore.localstream);\n              });\n\n              // pc[peer].addStream(localStream);\n            }\n          } else if (pc[peer].localStreams) {\n            if (!pc[peer].localStreams.length) {\n              Helper.wrtcStore.localstream.getTracks().forEach((track) => {\n                pc[peer].addTrack(track, Helper.wrtcStore.localstream);\n              });\n              // pc[peer].addStream(localStream);\n            }\n          }\n        }\n        const offer = new RTCSessionDescription(data.offer);\n        pc[peer].setRemoteDescription(offer, () => {\n          pc[peer].createAnswer((desc) => {\n            desc.sdp = cleanupSdp(desc.sdp);\n            pc[peer].setLocalDescription(desc, () => {\n              self.sendMessage(peer, {type: 'answer', answer: desc, headerId: data.headerId});\n            }, logError);\n          }, logError, sdpConstraints);\n        }, logError);\n      } else if (type === 'answer') {\n        if (pc[peer]) {\n          const answer = new RTCSessionDescription(data.answer);\n          pc[peer].setRemoteDescription(answer, () => {\n            // console.log(\"call setRemoteDescription\", new Date().getSeconds())\n          }, logError);\n        }\n      } else if (type === 'icecandidate') {\n        if (pc[peer]) {\n          const candidate = new RTCIceCandidate(data.candidate);\n          const p = pc[peer].addIceCandidate(candidate);\n          if (p) {\n            p.then(() => {\n              // Do stuff when the candidate is successfully passed to the ICE agent\n            }).catch(() => {\n              console.error('[wrtc]: Failure during addIceCandidate()', data);\n            });\n          }\n        }\n      } else {\n        console.error('[wrtc]: unknown message', data);\n      }\n    },\n    hangupAll: function hangupAll(_headerId) {\n      Object.keys(pc).forEach((userId) => {\n        self.hangup(userId, true, _headerId);\n      });\n    },\n    hangup: function hangup(userId, notify, headerId) {\n      notify = arguments.length === 1 ? true : notify;\n      if (pc[userId] && userId !== Helper.getUserId()) {\n        self.setStream(userId, '');\n        pc[userId].close();\n        delete pc[userId];\n        if (notify) self.sendMessage(userId, {type: 'hangup', headerId});\n      }\n    },\n    call: function call(userId, headerId) {\n      // if (!localStream) {\n      //   callQueue.push(userId);\n      //   return;\n      // }\n      let constraints = {optional: [], mandatory: {}};\n      // temporary measure to remove Moz* constraints in Chrome\n      if (webrtcDetectedBrowser === 'chrome') {\n        for (const prop in constraints.mandatory) {\n          if (prop.indexOf('Moz') !== -1) {\n            delete constraints.mandatory[prop];\n          }\n        }\n      }\n      constraints = mergeConstraints(constraints, sdpConstraints);\n\n      if (!pc[userId]) self.createPeerConnection(userId, headerId);\n\n\n      // pc[userId].addStream(localStream);\n\n      Helper.wrtcStore.localstream.getTracks().forEach((track) => {\n        pc[userId].addTrack(track, Helper.wrtcStore.localstream);\n      });\n\n      pc[userId].createOffer((desc) => {\n        desc.sdp = cleanupSdp(desc.sdp);\n        pc[userId].setLocalDescription(desc, () => {\n          self.sendMessage(userId, {type: 'offer', offer: desc, headerId});\n        }, logError);\n      }, logError, constraints);\n    },\n    createPeerConnection: function createPeerConnection(userId, headerId) {\n      if (pc[userId]) {\n        console.warn('WARNING creating PC connection even though one exists', userId);\n      }\n      pc[userId] = new RTCPeerConnection(pcConfig, pcConstraints);\n      pc[userId].onicecandidate = function (event) {\n        if (event.candidate) {\n          self.sendMessage(userId, {\n            type: 'icecandidate',\n            headerId,\n            candidate: event.candidate,\n          });\n        } else {\n          reconnected = 0;\n          socket.emit('acceptNewCall', padId, window.headerId);\n        }\n      };\n      pc[userId].oniceconnectionstatechange = function () {\n        console.info('[wrtc]: ICE state: ', pc[userId], pc[userId].iceConnectionState);\n\t\t \t};\n      pc[userId].ontrack = function (event) {\n        console.log(event, 'ontrack');\n        remoteStream[userId] = event.streams[0];\n        self.setStream(userId, event.streams[0]);\n      };\n      pc[userId].onremovestream = function () {\n        self.setStream(userId, '');\n      };\n    },\n    audioVideoInputChange: function audioVideoInputChange() {\n      Helper.stopStreaming(() => {\n        self.getUserMedia(window.headerId);\n      });\n    },\n    attachSinkId: function attachSinkId(element, sinkId) {\n      // Attach audio output device to video element using device/sink ID.\n      if (element && element[0] && typeof element[0].sinkId !== 'undefined') {\n        element[0].setSinkId(sinkId).then(() => {\n          // console.info(`Success, audio output device attached: ${sinkId}`);\n        }).catch((error) => {\n          let errorMessage = error;\n          if (error.name === 'SecurityError') {\n            errorMessage = `You need to use HTTPS for selecting audio output device: ${error}`;\n          }\n          console.error(errorMessage);\n          // Jump back to first output device in the list as it's the default.\n          audioOutputSelect.selectedIndex = 0;\n        });\n      } else {\n        console.warn('Browser does not support output device selection.');\n        $(document).find('#wrtc_settings .select.audioOutputSec').hide();\n      }\n    },\n    changeAudioDestination: function changeAudioDestination() {\n      const audioOutputSelect = document.querySelector('#wrtc_settings .select.audioOutputSec');\n      const audioDestination = audioOutputSelect.value;\n      const videoElement = localVideoElement;\n      self.attachSinkId(videoElement, audioDestination);\n    },\n    getUserMedia: function getUserMedia(headerId) {\n      audioInputSelect = document.querySelector('#wrtc_settings .select.audioSource');\n      audioOutputSelect = document.querySelector('#wrtc_settings .select.audioOutputSec');\n      videoSelect = document.querySelector('#wrtc_settings .select.videoSourc');\n\n      const audioSource = audioInputSelect ? audioInputSelect.value : undefined;\n      const videoSource = videoSelect ? videoSelect.value : undefined;\n      const audioOutput = audioOutputSelect ? audioOutputSelect.value : undefined;\n\n      const mediaConstraints = {\n        audio: true,\n        video: {\n          width: 320,\n          height: 240,\n          frameRate: {ideal: 15, max: 30},\n          facingMode: 'user',\n        },\n      };\n\n      if (audioSource) {\n        mediaConstraints.audio.deviceId = {exact: audioSource};\n      }\n      if (videoSource) {\n        mediaConstraints.video.deviceId = {exact: videoSource};\n      }\n\n      localStorage.setItem('videoSettings', JSON.stringify({microphone: audioSource, speaker: audioOutput, camera: videoSource}));\n      $('#wrtc_modal #networkError').removeClass('active').hide();\n\n      window.navigator.mediaDevices\n          .getUserMedia(mediaConstraints)\n          .then((stream) => {\n            Helper.wrtcStore.localstream = stream;\n            self.setStream(Helper.getUserId(), stream);\n            self._pad.collabClient.getConnectedUsers().forEach((user) => {\n              if (user.userId !== Helper.getUserId()) {\n                if (pc[user.userId]) {\n                  self.hangup(user.userId, false, headerId);\n                }\n                self.call(user.userId, headerId);\n              }\n            });\n          }).catch((err) => {\n            self.showUserMediaError(err, Helper.getUserId(), headerId);\n          });\n    },\n    attemptToReconnect: function attemptToReconnect() {\n      reconnected++;\n      console.log('[wrtc]: Try reconnecting', reconnected, attemptRonnect);\n      if (attemptRonnect <= reconnected) {\n        socket.emit('acceptNewCall', padId, window.headerId);\n        throw new Error('[wrtc]: please reload the video chat and try again to connect!');\n      }\n      setTimeout(() => {\n        console.log('[wrtc]: reconnecting...');\n        self.getUserMedia(window.headerId);\n      }, randomIntFromInterval(200, 1000));\n    },\n  };\n\n  // Normalize RTC implementation between browsers\n  // var getUserMedia = window.navigator.mediaDevices.getUserMedia\n  var attachMediaStream = function attachMediaStream(element, stream) {\n    if (typeof element.srcObject !== 'undefined') {\n      element.srcObject = stream;\n    } else if (typeof element.mozSrcObject !== 'undefined') {\n      element.mozSrcObject = stream;\n    } else if (typeof element.src !== 'undefined') {\n      element.src = URL.createObjectURL(stream);\n    } else {\n      console.error('Error attaching stream to element.', element);\n    }\n  };\n  var webrtcDetectedBrowser = 'chrome';\n\n  function cleanupSdp(sdp) {\n    const bandwidth = {\n      screen: 300, // 300kbits minimum\n      audio: 256, // 64kbits  minimum\n      video: 500,\n      minVideo: 128, // 125kbits  min\n      maxVideo: 2048, // 125kbits  max\n      videoCodec: clientVars.webrtc.video.codec,\n    };\n\n    const isScreenSharing = false;\n\n    sdp = CodecsHandler.setApplicationSpecificBandwidth(sdp, bandwidth, isScreenSharing);\n    sdp = CodecsHandler.setVideoBitrates(sdp, {\n      min: bandwidth.minVideo,\n      max: bandwidth.maxVideo,\n      codec: bandwidth.videoCodec,\n    });\n    sdp = CodecsHandler.setOpusAttributes(sdp);\n    sdp = CodecsHandler.preferCodec(sdp, bandwidth.videoCodec);\n\n    return sdp;\n  }\n\n  function mergeConstraints(cons1, cons2) {\n    const merged = cons1;\n    for (const name in cons2.mandatory) {\n      merged.mandatory[name] = cons2.mandatory[name];\n    }\n    merged.optional.concat(cons2.optional);\n    return merged;\n  }\n\n  function randomIntFromInterval(min, max) {\n    return Math.floor(Math.random() * (max - min + 1) + min);\n  }\n\n  function logError(error) {\n    // if (error && error.message.includes(\"Failed to set remote answer sdp\")) {\n    self.attemptToReconnect();\n    // } else {\n    // socket.emit('acceptNewCall', padId, window.headerId);\n    // }\n    console.error('[wrtc]: LogError:', error);\n    $('#wrtc_modal #networkError').show().addClass('active').text(`[wrtc]: Error: ${error} ,Reload the session.`);\n  }\n\n  self.pc = pc;\n  return self;\n})();\n"]}